I"D½<h1 id="httpé¢è¯•æ€»ç»“">HTTPé¢è¯•æ€»ç»“</h1>

<p><em>å‚è€ƒé“¾æ¥:</em></p>

<ul>
  <li><a href="https://zhuanlan.zhihu.com/p/434629143">goè¯­è¨€å¸¸è§é¢è¯•é¢˜</a></li>
  <li><a href="https://www.zhihu.com/column/c_1212699838745346048">golang å¿«é€Ÿå…¥é—¨</a></li>
  <li><a href="https://geektutu.com/post/qa-golang.html">Go è¯­è¨€ç¬”è¯•é¢è¯•é¢˜æ±‡æ€»</a></li>
  <li><a href="https://golang.design/go-questions/">GO ç¨‹åºå‘˜é¢è¯•ç¬”è¯•å®å…¸</a></li>
  <li><a href="https://interview.apachecn.org/">Interviewé¢è¯•æŒ‡å—</a></li>
  <li><a href="https://github.com/lifei6671/interview-go">goé¢è¯•é¢˜é›†åˆ</a></li>
  <li><a href="https://github.com/shomali11/go-interview">goé¢è¯•é¢˜</a></li>
  <li><a href="https://github.com/yqchilde/Golang-Interview">goé¢è¯•é¢˜æ”¶é›†</a></li>
  <li><a href="https://github.com/go-share-team/go_interview">goé¢ç»</a></li>
  <li><a href="https://www.nowcoder.com/search/all?query=go%20%E9%9D%A2%E7%BB%8F&amp;type=all&amp;searchType=%E9%A1%B6%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F">ç‰›å®¢goé¢ç»</a></li>
  <li><a href="https://codetop.cc/home">å¸¸è§ç®—æ³•é¢˜æ€»ç»“</a></li>
  <li><a href="https://learn.lianglianglee.com/">æŠ€æœ¯æ‘˜æŠ„</a></li>
  <li><a href="https://books.studygolang.com/GoExpertProgramming/">goä¸“å®¶ç¼–ç¨‹</a></li>
  <li><a href="https://github.com/Tencent/secguide/blob/main/Go%E5%AE%89%E5%85%A8%E6%8C%87%E5%8D%97.md">Goå®‰å…¨æŒ‡å—</a></li>
  <li><a href="https://cloud.tencent.com/developer/article/1911268">Go ç¼–ç è§„èŒƒå»ºè®®</a></li>
  <li><a href="https://geektutu.com/post/hpg-escape-analysis.html">Goè¯­è¨€é«˜æ€§èƒ½ç¼–ç¨‹</a></li>
</ul>

<h2 id="åŸºç¡€è¯­æ³•">åŸºç¡€è¯­æ³•</h2>

<h3 id="go-çš„åŸºç¡€å˜é‡ç±»å‹æœ‰å“ªäº›">go çš„åŸºç¡€å˜é‡ç±»å‹æœ‰å“ªäº›</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">ç±»å‹åˆ†ç±»</th>
      <th style="text-align: center">ç±»å‹</th>
      <th style="text-align: center">é»˜è®¤å€¼</th>
      <th style="text-align: center">æè¿°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">å¸ƒå°”å‹</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">bool</code></td>
      <td style="text-align: center">false</td>
      <td style="text-align: center">åŸºç¡€boolç±»å‹(ä¸€ä¸ªå­—èŠ‚)</td>
    </tr>
    <tr>
      <td style="text-align: center">æ•´æ•°ç±»å‹</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uint8</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æ— ç¬¦å·8ä½æ•´å‹(0~255)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uint16</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æ— ç¬¦å·16ä½æ•´å‹(0~65535)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uint32</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æ— ç¬¦å·32ä½æ•´å‹(0~4294967295)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uint64</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æ— ç¬¦å·64ä½æ•´å‹(0~18446744073709551615)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int8</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æœ‰ç¬¦å·8ä½æ•´å‹(-128~127)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int16</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æœ‰ç¬¦å·16ä½æ•´å‹(-32768~32767)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int32</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æœ‰ç¬¦å·32ä½æ•´å‹ (-2147483648~2147483647)</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int64</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æœ‰ç¬¦å·32ä½æ•´å‹(-9223372036854775808~9223372036854775807)</td>
    </tr>
    <tr>
      <td style="text-align: center">æµ®ç‚¹ç±»å‹</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">float32</code></td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">IEEE-754 32ä½æµ®ç‚¹å‹æ•°</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">float64</code></td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">IEEE-754 64ä½æµ®ç‚¹å‹æ•°</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">complex64</code></td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">32ä½å®æ•°å’Œè™šæ•°</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">complex128</code></td>
      <td style="text-align: center">0.0</td>
      <td style="text-align: center">64 ä½å®æ•°å’Œè™šæ•°</td>
    </tr>
    <tr>
      <td style="text-align: center">å…¶å®ƒæ•°å­—ç±»å‹</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">byte</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">ä¸uint8ä¸€è‡´ï¼Œä¸€ä¸ªå­—èŠ‚8ä½</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">rune</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">charé»˜è®¤ç±»å‹ï¼Œä¸int32ç±»ä¼¼</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">int</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æœ‰ç¬¦å·32/64æ•´å‹ï¼Œå­—èŠ‚é•¿åº¦ä¸æ“ä½œç³»ç»Ÿç±»å‹ä¸€è‡´</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uint</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">æ— ç¬¦å·32/64æ•´å‹ï¼Œå­—èŠ‚é•¿åº¦ä¸æ“ä½œç³»ç»Ÿç±»å‹ä¸€è‡´</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">uintptr</code></td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">ä¸uintä¸€è‡´ï¼Œç”¨äºå­˜æ”¾æŒ‡é’ˆåœ°å€</td>
    </tr>
    <tr>
      <td style="text-align: center">æ´¾ç”Ÿç±»å‹</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">pointer</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">æŒ‡é’ˆç±»å‹ï¼Œç”¨äºæŒ‡å‘å¯¹åº”çš„å†…å­˜åœ°å€</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">[]T</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">æ•°ç»„ç±»å‹ï¼Œç”¨äºè¿›è¡Œæ•°ç»„å­˜å‚¨</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">slice</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">åˆ‡ç‰‡ç±»å‹ï¼Œç”¨äºè¿›è¡Œgoåˆ‡ç‰‡ç®¡ç†</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">Channel</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">ç®¡é“ï¼Œç»Ÿä¸€çš„æ¶ˆæ¯ç®¡ç†</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">func</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">å‡½æ•°ï¼Œç±»ä¼¼äºcè¯­è¨€çš„å‡½æ•°æŒ‡é’ˆ</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">interface/any</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">æ¥å£ç±»å‹ï¼Œç±»ä¼¼äºC++ä¸­çš„è™šå‡½æ•°æŒ‡é’ˆ</td>
    </tr>
    <tr>
      <td style="text-align: center">^^</td>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">map</code></td>
      <td style="text-align: center">nil</td>
      <td style="text-align: center">mapç±»å‹ï¼Œhash mapåŸºç¡€ç±»å‹</td>
    </tr>
  </tbody>
</table>

<hr />

<ul>
  <li>å‚è€ƒ:<a href="https://www.runoob.com/go/go-data-types.html">goè¯­è¨€åŸºç¡€ç±»å‹</a>;<a href="https://fasionchan.com/golang/tour/basic-types/">goè¯­è¨€åŸºæœ¬ç±»å‹</a>;<a href="https://blog.csdn.net/FromTheWind/article/details/105862844">Golangä¸­uintã€int, int8, int16, int32, int64åŒºåˆ«</a></li>
</ul>

<h3 id="01--å’Œ--çš„åŒºåˆ«">01 = å’Œ := çš„åŒºåˆ«ï¼Ÿ</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">=</code>:
    <ul>
      <li>è¯­ä¹‰ä¸åŒï¼šä»…ä»…è¿›è¡Œèµ‹å€¼ï¼Œè¦æ±‚å·¦ä¾§å¯¹è±¡å¿…é¡»å·²ç»å£°æ˜</li>
      <li>ä½¿ç”¨è¯­æ³•ï¼šéœ€è¦ä¸<code class="language-plaintext highlighter-rouge">var</code>è¿›è¡Œé…åˆä½¿ç”¨</li>
      <li>ä½¿ç”¨ä½ç½®ï¼šå¯ä»¥ç”¨äºå‡½æ•°ä¸­å’Œå‡½æ•°å¤–</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">:=</code>:
    <ul>
      <li>è¯­ä¹‰ï¼šå£°æ˜+èµ‹å€¼ï¼Œå£°æ˜å˜é‡çš„åŒæ—¶è¿›è¡Œè‡ªåŠ¨èµ‹å€¼ï¼Œä¸­é—´æ¶‰åŠåˆ°è‡ªåŠ¨æ¨æ–­</li>
      <li>è¯­æ³•ï¼š<strong>å·¦ä¾§å¿…é¡»æœ‰æ–°çš„å˜é‡ç”Ÿæˆ</strong>ï¼Œå¦åˆ™ä¼šæœ‰è¯­æ³•é”™è¯¯</li>
      <li>ä½¿ç”¨ä½ç½®ï¼šåªèƒ½ç”¨äºå‡½æ•°ä¸­ï¼Œä¸èƒ½ç”¨äºå‡½æ•°å¤–
___</li>
    </ul>
  </li>
  <li>å‚è€ƒ: <a href="https://juejin.cn/post/6947897494059614215">Goè¯­è¨€å­¦ä¹ ä¹‹:=ä¸=çš„åŒºåˆ«</a>;<a href="https://zhuanlan.zhihu.com/p/115085755">golangå¿«é€Ÿå…¥é—¨[8.2]-è‡ªåŠ¨ç±»å‹æ¨æ–­çš„ç§˜å¯†</a></li>
</ul>

<h3 id="02-æŒ‡é’ˆçš„ä½œç”¨">02 æŒ‡é’ˆçš„ä½œç”¨</h3>

<ol>
  <li>ä¿å­˜å˜é‡åœ°å€ï¼Œé€šè¿‡<code class="language-plaintext highlighter-rouge">&amp;</code> ä¸<code class="language-plaintext highlighter-rouge">*</code> æ“ä½œç¬¦é—´æ¥è®¿é—®å†…å­˜åœ°å€ï¼Œå‡å°‘å€¼ä¼ é€’æŸè€—</li>
</ol>

<h3 id="03-go-å…è®¸å¤šä¸ªè¿”å›å€¼å—">03 Go å…è®¸å¤šä¸ªè¿”å›å€¼å—ï¼Ÿ</h3>

<p>å…è®¸ï¼ŒåŒæ—¶å…è®¸å‘½åè¿”å›å€¼ã€‚å‘½ååçš„è¿”å›å€¼ï¼Œç›¸å½“äºé¢„å®šä¹‰å˜é‡ã€‚
è¿”å›å€¼æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
  <li>è¿”å›å€¼ä¸èƒ½ç”¨å®¹å™¨å¯¹è±¡æ¥æ”¶ï¼šåªèƒ½ç”¨å¤šä¸ªå˜é‡æˆ–è€…ç”¨<code class="language-plaintext highlighter-rouge">_</code> å¿½ç•¥</li>
  <li>å‘½åè¿”å›å‚æ•°ï¼šå¯çœ‹åšå½¢å‚ç±»ä¼¼å±€éƒ¨å˜é‡ï¼Œæœ€åç”±return éšå¼è¿”å›</li>
  <li>å±€éƒ¨å˜é‡é®è”½ï¼šå‘½åè¿”å›å‚æ•°å¯è¢«åŒåå±€éƒ¨å˜é‡é®è”½ï¼Œæ­¤æ—¶éœ€è¦æ˜¾å¼è¿”å›</li>
  <li>deferä½œç”¨ï¼šdefer å‡½æ•°ä½œç”¨åœ¨ç©ºreturnä¹‹å‰ã€‚è¿”å›å€¼æ— å‘½åæ˜¯ä¼šç”Ÿæˆä¸åŒçš„ä¸´æ—¶å˜é‡ã€‚é¿å…å¼‚å¸¸</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">add1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">z</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">{</span> <span class="c">// ä¸èƒ½åœ¨ä¸€ä¸ªçº§åˆ«ï¼Œå¼•å‘ "z redeclared in this block" é”™è¯¯ã€‚</span>
        <span class="k">var</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
        <span class="c">// return   // Error: z is shadowed during return</span>
        <span class="k">return</span> <span class="n">z</span> <span class="c">// å¿…é¡»æ˜¾å¼è¿”å›ã€‚</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">add2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">z</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">z</span><span class="o">++</span>
        <span class="nb">println</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c">// è¾“å‡º: 203</span>
    <span class="p">}()</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">z</span> <span class="o">+</span> <span class="m">200</span> <span class="c">// æ‰§è¡Œé¡ºåº: (z = z + 200) -&gt; (call defer) -&gt; (return)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">add3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="n">z</span> <span class="o">:=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span>
    <span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">z</span><span class="o">++</span>
        <span class="nb">println</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="c">// è¾“å‡º: 204</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">z</span> <span class="o">+</span> <span class="m">200</span> <span class="c">// æ‰§è¡Œé¡ºåºï¼š(s = z + 200) -&gt; (call defer) -&gt; (return )</span>
<span class="p">}</span>


<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">println</span><span class="p">(</span><span class="n">add1</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span> <span class="c">// è¾“å‡ºï¼š3</span>
    <span class="nb">println</span><span class="p">(</span><span class="n">add2</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span> <span class="c">// è¾“å‡º: 204</span>
    <span class="nb">println</span><span class="p">(</span><span class="n">add3</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span> <span class="c">// è¾“å‡º: 203</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://www.topgoer.com/%E5%87%BD%E6%95%B0/%E8%BF%94%E5%9B%9E%E5%80%BC.html">goè¿”å›å€¼</a></li>
</ul>

<h3 id="04-go-æœ‰å¼‚å¸¸ç±»å‹å—">04 Go æœ‰å¼‚å¸¸ç±»å‹å—ï¼Ÿ</h3>
<p>go æ²¡æœ‰å¼‚å¸¸ç±»å‹ï¼Œåªæœ‰é”™è¯¯ç±»å‹ï¼Œé€šå¸¸ç”¨è¿”å›å€¼æ¥è¡¨ç¤ºå¼‚å¸¸çŠ¶æ€</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s">"test.txt"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
    <span class="n">log</span><span class="o">.</span><span class="n">Fatal</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="05-ä»€ä¹ˆæ˜¯åç¨‹goroutine">05 ä»€ä¹ˆæ˜¯åç¨‹ï¼ˆGoroutineï¼‰</h3>
<p>Goroutine æ˜¯ä¸å…¶ä»–å‡½æ•°æˆ–æ–¹æ³•åŒæ—¶è¿è¡Œçš„å‡½æ•°æˆ–æ–¹æ³•ã€‚ Goroutines å¯ä»¥è¢«è®¤ä¸ºæ˜¯è½»é‡çº§çš„çº¿ç¨‹ã€‚ ä¸çº¿ç¨‹ç›¸æ¯”ï¼Œåˆ›å»º Goroutine çš„å¼€é”€å¾ˆå°ã€‚ Goåº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œæ•°åƒä¸ª Goroutine æ˜¯éå¸¸å¸¸è§çš„åšæ³•ã€‚
___
å‚è€ƒï¼š<a href="https://wangpengcheng.github.io/2019/12/17/baidu_interview_prepare/#418-%E8%AF%B7%E4%BD%A0%E6%9D%A5%E8%AF%B4%E4%B8%80%E8%AF%B4%E5%8D%8F%E7%A8%8B">è¯´ä¸€è¯´åç¨‹</a>;<a href="https://wangpengcheng.github.io/2019/12/17/baidu_interview_prepare/#418-%E8%AF%B7%E4%BD%A0%E6%9D%A5%E8%AF%B4%E4%B8%80%E8%AF%B4%E5%8D%8F%E7%A8%8B">åç¨‹ä¸çº¿ç¨‹åŒºåˆ«</a></p>

<h3 id="06-å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²">06 å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²</h3>
<p>Goè¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²æ˜¯åªè¯»çš„ï¼Œæ¯æ¬¡ä¿®æ”¹æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²(ä¸javaç±»ä¼¼)ï¼Œå¦‚æœéœ€è¦æ‹¼æ¥å¤šæ¬¡ï¼Œä½¿ç”¨strings.Builderï¼Œæœ€å°åŒ–å†…å­˜æ‹·è´æ¬¡æ•°</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">str</span> <span class="n">strings</span><span class="o">.</span><span class="n">Builder</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">1000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
    <span class="n">str</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">str</span><span class="o">.</span><span class="n">String</span><span class="p">())</span>
</code></pre></div></div>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://blog.51cto.com/yuzhou1su/5268459">æ·±å…¥ç†è§£ Go ä¸­çš„å­—ç¬¦ä¸²</a>;<a href="https://blog.csdn.net/sinat_31862487/article/details/134044392">æ·±å…¥ç†è§£Goè¯­è¨€çš„string ç±»å‹</a>;<a href="https://segmentfault.com/a/1190000040023113">ä½ ä¸çŸ¥é“çš„Go ä¹‹string</a></li>
</ul>

<h3 id="07-ä»€ä¹ˆæ˜¯-rune-ç±»å‹">07 ä»€ä¹ˆæ˜¯ rune ç±»å‹</h3>
<p>go è¯­è¨€ä¸­runeæ˜¯unicode ç¼–ç ä»£ç§°ï¼Œæ˜¯int32çš„åˆ«åï¼Œstring å¯ä»¥è½¬æ¢ä¸ºruneæ•°ç»„ã€‚
ä½†æ˜¯å­—ç¬¦ä¸²çš„åº•å±‚æ˜¯byte(8 bit)åºåˆ—ï¼Œè€Œérune(32bit)ã€‚å¦‚ä¸‹ï¼š</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">a</span> <span class="o">:=</span> <span class="s">`Goè¯­è¨€`</span>
    <span class="c">// è¿™é‡Œstringåº•å±‚ä¸ºbyteï¼Œ`è¯­è¨€`ä¸ºutf-8ç¼–ç å› æ­¤ä½¿ç”¨6ä¸ªå­—èŠ‚</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="c">// 8</span>
    <span class="c">// è¿™é‡Œè½¬æ¢ä¸ºruneæ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸€ä¸ªruneï¼Œé•¿åº¦ä¸º4ï¼Œå†…å­˜ä¸º16å­—èŠ‚</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">([]</span><span class="kt">rune</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span> <span class="c">// 4</span>
    <span class="c">// è¾“å‡ºå†…å­˜ä¸­ç¬¬3ä¸ªå­—èŠ‚å†…å®¹ï¼Œé•¿åº¦ä¸º1å­—èŠ‚</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="m">2</span><span class="p">])</span> <span class="c">// 232</span>
    <span class="c">// è¾“å‡ºç¬¬äºŒä¸ªruneå†…å®¹ï¼Œé•¿åº¦ä¸º4å­—èŠ‚</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">([]</span><span class="kt">rune</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="m">2</span><span class="p">])</span> <span class="c">// 35821</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Hello W3Cschool!"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>æ³¨æ„ï¼š
    <ul>
      <li>å­—ç¬¦ä¸²éå†<strong>é€šè¿‡ä¸‹æ ‡ç´¢å¼•å­—ç¬¦ä¸²å°†ä¼šäº§ç”Ÿä¸€ä¸ªå­—èŠ‚</strong>,å­—ç¬¦ä¸²ä¸­å«æœ‰UTF-8ç¼–ç å­—ç¬¦æ—¶ï¼Œä¼šå‡ºç°ä¹±ç </li>
      <li>ä½¿ç”¨range éå†ï¼šä¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºruneç±»å‹</li>
    </ul>
  </li>
</ul>

<hr />

<p>å‚è€ƒ:<a href="https://zhuanlan.zhihu.com/p/93052559">Go è¯­è¨€ä¸­çš„å­—ç¬¦ä¸å­—ç¬¦ä¸²éå†</a>;<a href="https://segmentfault.com/a/1190000040023113">ä½ ä¸çŸ¥é“çš„Goä¹‹string</a></p>

<h3 id="08-å¦‚ä½•åˆ¤æ–­-map-ä¸­æ˜¯å¦åŒ…å«æŸä¸ª-key-">08 å¦‚ä½•åˆ¤æ–­ map ä¸­æ˜¯å¦åŒ…å«æŸä¸ª key ï¼Ÿ</h3>
<ul>
  <li>æ™®é€šæƒ…å†µä¸‹ï¼š åœ¨mapä¸ä¸º<code class="language-plaintext highlighter-rouge">nil</code> çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æ ¹æ®keyå–å€¼ç¬¬äºŒä¸ªï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨å³å¯ï¼Œå¦‚ä¸‹ï¼š
    <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">val</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">dict</span><span class="p">[</span><span class="s">"foo"</span><span class="p">];</span> <span class="n">ok</span> <span class="p">{</span>
  <span class="c">//do something here</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>é«˜å¹¶å‘æƒ…å†µä¸‹ï¼šåŸå§‹mapå¹¶éå¹¶å‘å®‰å…¨ï¼Œé«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨è¯»å†™é”/åˆ†ç‰‡é”/sync.map(ä»…ä»…é€‚ç”¨äºä¸€å†™å¤šè¯»æƒ…å†µ)</li>
</ul>

<hr />

<p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/356739568">Goå¹¶å‘ä¹‹ä¸‰ç§çº¿ç¨‹å®‰å…¨çš„map</a>;<a href="https://developer.aliyun.com/article/1172753">Golang sync.MapåŸç†ï¼ˆä¸¤ä¸ªmapå®ç° è¯»å†™åˆ†ç¦»ã€é€‚ç”¨è¯»å¤šå†™å°‘åœºæ™¯ï¼‰</a></p>

<h3 id="09-goæ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—">09 Goæ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—ï¼Ÿ</h3>
<ul>
  <li>ä¸æ”¯æŒï¼šGOä¸æ”¯æŒå¯é€‰å‚æ•°å’Œé»˜è®¤å‚æ•°ï¼Œä¹Ÿä¸æ”¯æŒæ–¹æ³•é‡è½½ã€‚å¯ä»¥é€šè¿‡structçš„æ–¹å¼ï¼Œæ·»åŠ é»˜è®¤å‚æ•°ã€‚æ”¯æŒå¯å˜å‚æ•°ï¼Œå¯ä»¥é€šè¿‡å¯å˜å‚æ•°åˆ¤æ–­ï¼Œé—´æ¥å®ç°å‚æ•°å¯é€‰</li>
  <li>é—´æ¥æ”¯æŒï¼š
    <ul>
      <li>å¯ç”¨é€šè¿‡structé…åˆåå°„å®ç°å¯å˜å‚æ•°çš„é—´æ¥æ”¯æŒ</li>
      <li>é€šè¿‡é€‰æ‹©å™¨æ¨¡å¼ä¸é€‚é…å™¨æ¨¡å¼å®ç°å¯å˜å‚æ•°çš„é—´æ¥æ”¯æŒ</li>
    </ul>
  </li>
</ul>

<hr />

<p>å‚è€ƒ: <a href="https://cloud.tencent.com/developer/article/2025794">golangä¸­å‡½æ•°å¦‚ä½•è®¾ç½®å‚æ•°é»˜è®¤å€¼</a>;<a href="https://www.zhihu.com/question/24368980">golangå‡½æ•°ä¸­çš„å‚æ•°ä¸ºä»€ä¹ˆä¸æ”¯æŒé»˜è®¤å€¼?-çŸ¥ä¹</a>;<a href="https://www.cnblogs.com/smartrui/p/10324320.html">Golangä¸­è®¾ç½®å‡½æ•°é»˜è®¤å‚æ•°çš„ä¼˜é›…å®ç°</a></p>

<h3 id="10-defer-çš„æ‰§è¡Œé¡ºåº">10 defer çš„æ‰§è¡Œé¡ºåº</h3>
<ul>
  <li>å¤šä¸ªdefer åè¿›å…ˆå‡ºï¼šå¤šä¸ªdeferéµå¾ªåè¿›å…ˆå‡ºçš„åŸåˆ™ï¼Œæœ€åå£°æ˜çš„æœ€å…ˆå¾—åˆ°æ‰§è¡Œ</li>
  <li>å·²ä»£ç å—ä¸ºåˆ†ç•Œç‚¹ï¼šä»£ç å—ä¸­deferä½œç”¨åœ¨ä»£ç å—ä¸Šä¸‹æ–‡ä¸­</li>
  <li>defer åœ¨returnä¹‹åï¼Œå‡½æ•°é€€å‡ºä¹‹å‰æ‰§è¡Œï¼šå°†<code class="language-plaintext highlighter-rouge">return i</code> æ‹†åˆ†ä¸º<code class="language-plaintext highlighter-rouge">s=i; return </code>ä¸¤ä¸ªè¯­å¥åˆ†ææ¥å£</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">test</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">i</span> <span class="o">:=</span> <span class="m">0</span>

    <span class="p">{</span>
        <span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"defer0"</span><span class="p">)</span>    
        <span class="p">}()</span>
    <span class="p">}</span>

	<span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"defer1"</span><span class="p">)</span>
	<span class="p">}()</span>
	<span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">i</span> <span class="o">+=</span> <span class="m">1</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"defer2"</span><span class="p">)</span>
	<span class="p">}()</span>
	<span class="k">return</span> <span class="n">i</span>
<span class="p">}</span>


<span class="k">func</span> <span class="n">test1</span><span class="p">()</span> <span class="p">(</span><span class="n">i</span>  <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">i</span> <span class="o">=</span> <span class="m">0</span>
	<span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">i</span> <span class="o">+=</span> <span class="m">1</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"defer4"</span><span class="p">)</span>
	<span class="p">}()</span>
	<span class="k">return</span> <span class="n">i</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"return"</span><span class="p">,</span> <span class="n">test</span><span class="p">())</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"return"</span><span class="p">,</span> <span class="n">test1</span><span class="p">())</span>
<span class="p">}</span>
<span class="c">// defer0</span>
<span class="c">// defer2</span>
<span class="c">// defer1</span>
<span class="c">// return 0</span>
<span class="c">// defer4</span>
<span class="c">// return 1</span>
</code></pre></div></div>
<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://juejin.cn/post/7095631673865273352">Golangçš„deferä¸returnçš„æ‰§è¡Œé¡ºåº</a></li>
</ul>

<h3 id="11-å¦‚ä½•äº¤æ¢-2-ä¸ªå˜é‡çš„å€¼">11 å¦‚ä½•äº¤æ¢ 2 ä¸ªå˜é‡çš„å€¼ï¼Ÿ</h3>

<p>go ä¸­æ— swapå‡½æ•°ï¼Œä¹Ÿä¸åƒjavaäº¤æ¢å¤æ‚(éœ€è¦å€ŸåŠ©ä¸´æ—¶å˜é‡)ï¼Œç›´æ¥äº¤æ¢å³å¯ã€‚å¦‚ä¸‹ï¼š</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">:=</span> <span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="c">// B A</span>
</code></pre></div></div>

<h3 id="12-go-è¯­è¨€-tag-çš„ç”¨å¤„">12 Go è¯­è¨€ tag çš„ç”¨å¤„ï¼Ÿ</h3>

<p>æœ¬è´¨ï¼štagçš„æœ¬è´¨æ˜¯structå­—æ®µæ³¨è§£ï¼šç”¨äºå®šä¹‰å­—æ®µçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§ï¼Œé€šè¿‡åå°„è·å–tagè¿›è¡Œè§£æ
ç”±æœ¬è´¨è¡ç”Ÿäº†å¦‚ä¸‹ä½œç”¨ï¼š</p>
<ul>
  <li>åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šé€šè¿‡æ ‡ç­¾æ§åˆ¶å­—æ®µä¸è¾“å‡ºå€¼çš„æ˜ å°„ï¼Œæ§åˆ¶å…¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œå¦‚jsonè½¬æ¢ï¼šé€šè¿‡<code class="language-plaintext highlighter-rouge">json:"xxx"</code>å®šä¹‰ç»“æ„ä½“å­—æ®µä¸jsonå­—æ®µçš„è½¬æ¢å…³ç³»</li>
  <li>æ•°æ®éªŒè¯ï¼šé€šè¿‡æ ‡ç­¾ä¸­çš„<code class="language-plaintext highlighter-rouge">default</code> è¿›è¡Œå­—æ®µå€¼çš„éªŒè¯å’Œæ·»åŠ </li>
  <li>æ•°æ®åº“ ORM æ˜ å°„ï¼š æœ‰äº›æ•°æ®åº“ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰åº“å…è®¸ä½ ä½¿ç”¨æ ‡ç­¾æ¥å®šä¹‰æ•°æ®åº“è¡¨å’Œç»“æ„ä½“ä¹‹é—´çš„æ˜ å°„å…³ç³»</li>
  <li>HTTP è·¯ç”±å’Œå¤„ç†ï¼š åœ¨æŸäº› Web æ¡†æ¶ä¸­ï¼Œæ ‡ç­¾å¯ä»¥è¢«ç”¨æ¥å®šä¹‰ HTTP è·¯ç”±è§„åˆ™æˆ–è€…è¯·æ±‚å¤„ç†é€»è¾‘</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"reflect"</span>
<span class="p">)</span>

<span class="k">type</span> <span class="n">User</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Name</span> <span class="kt">string</span> <span class="s">`json:"name" mytag:"myName"`</span>
	<span class="n">Age</span>  <span class="kt">int</span>    <span class="s">`json:"age" mytag:"myAge"`</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">user</span> <span class="o">:=</span> <span class="n">User</span><span class="p">{</span><span class="s">"Bob"</span><span class="p">,</span> <span class="m">30</span><span class="p">}</span>
	<span class="c">// è·å–å€¼åå°„</span>
	<span class="n">v</span> <span class="o">:=</span> <span class="n">reflect</span><span class="o">.</span><span class="n">ValueOf</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
	<span class="c">// è·å–ç±»å‹</span>
	<span class="n">t</span> <span class="o">:=</span> <span class="n">v</span><span class="o">.</span><span class="n">Type</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">t</span><span class="o">.</span><span class="n">NumField</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="c">// å­—æ®µ</span>
		<span class="n">field</span> <span class="o">:=</span> <span class="n">t</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		<span class="c">// è¾“å‡ºå­—æ®µå’Œå€¼</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"json"</span><span class="p">),</span> <span class="n">field</span><span class="o">.</span><span class="n">Tag</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"mytag"</span><span class="p">),</span> <span class="n">v</span><span class="o">.</span><span class="n">FieldByName</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">Name</span><span class="p">))</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c">// è¾“å‡ºï¼š</span>
<span class="c">// Name name myName Bob</span>
<span class="c">// Age age myAge 30</span>

</code></pre></div></div>
<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://learnku.com/articles/78000">GoTagæ ‡ç­¾</a></li>
</ul>

<h3 id="13-å¦‚ä½•åˆ¤æ–­-2-ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡slice-æ˜¯ç›¸ç­‰çš„">13 å¦‚ä½•åˆ¤æ–­ 2 ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡(slice) æ˜¯ç›¸ç­‰çš„ï¼Ÿ</h3>
<p>ä¸èƒ½ç›´æ¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">==</code> è¿™æ ·åªèƒ½è¯´æ˜ä¸¤ä¸ªsliceæŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„</p>

<ul>
  <li>åå°„æ¯”è¾ƒï¼šç›´æ¥ä½¿ç”¨åå°„reflect.DeepEqual(a, b) åˆ¤æ–­ aã€bä¸¤ä¸ªåˆ‡ç‰‡æ˜¯å¦ç›¸ç­‰ã€‚ä½†æ˜¯æ€§èƒ½è¾ƒä½</li>
  <li>ç›´æ¥æ¯”è¾ƒï¼šéå†æ¯”è¾ƒåˆ‡ç‰‡ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆæ³¨æ„å¤„ç†è¶Šç•Œçš„æƒ…å†µï¼‰ï¼Œæ€§èƒ½è¾ƒå¥½</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">StringSliceEqualBCE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="no">false</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">b</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="no">false</span>
    <span class="p">}</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="o">:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">a</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">{</span>
            <span class="k">return</span> <span class="no">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="no">true</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />

<ul>
  <li>å‚è€ƒ: <a href="https://zhuanlan.zhihu.com/p/615613789">Golangä¸­å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªsliceæ˜¯å¦ç›¸ç­‰ï¼Ÿ</a>;<a href="https://darjun.github.io/2021/05/09/youdontknowgo/slice/">ä½ ä¸çŸ¥é“çš„Goä¹‹slice</a></li>
</ul>

<h3 id="14-å­—ç¬¦ä¸²æ‰“å°æ—¶v-å’Œ-v-çš„åŒºåˆ«">14 å­—ç¬¦ä¸²æ‰“å°æ—¶ï¼Œ%v å’Œ %+v çš„åŒºåˆ«</h3>
<p>%v å’Œ %+v éƒ½å¯ä»¥ç”¨æ¥æ‰“å° struct çš„å€¼ï¼ŒåŒºåˆ«åœ¨äº %v ä»…æ‰“å°å„ä¸ªå­—æ®µçš„å€¼ï¼Œ%+v è¿˜ä¼šæ‰“å°å„ä¸ªå­—æ®µçš„åç§°ã€‚</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Stu</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Name</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">Stu</span><span class="p">{</span><span class="s">"Tom"</span><span class="p">})</span> <span class="c">// {Tom}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%+v</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">Stu</span><span class="p">{</span><span class="s">"Tom"</span><span class="p">})</span> <span class="c">// {Name:Tom}</span>
<span class="p">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ ¼å¼</th>
      <th style="text-align: left">æè¿°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%v</code></td>
      <td style="text-align: left">æŒ‰å€¼çš„æœ¬æ¥å€¼è¾“å‡º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%+v</code></td>
      <td style="text-align: left">åœ¨ %v åŸºç¡€ä¸Šï¼Œå¯¹ç»“æ„ä½“å­—æ®µåå’Œå€¼è¿›è¡Œå±•å¼€</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%#v</code></td>
      <td style="text-align: left">è¾“å‡º Go è¯­è¨€è¯­æ³•æ ¼å¼çš„å€¼</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%T</code></td>
      <td style="text-align: left">è¾“å‡º Go è¯­è¨€è¯­æ³•æ ¼å¼çš„ç±»å‹å’Œå€¼</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%%</code></td>
      <td style="text-align: left">è¾“å‡º % æœ¬ä½“</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%b</code></td>
      <td style="text-align: left">æ•´å‹ä»¥äºŒè¿›åˆ¶æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%o</code></td>
      <td style="text-align: left">æ•´å‹ä»¥å…«è¿›åˆ¶æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%d</code></td>
      <td style="text-align: left">æ•´å‹ä»¥åè¿›åˆ¶æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%x</code></td>
      <td style="text-align: left">æ•´å‹ä»¥åå…­è¿›åˆ¶æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%X</code></td>
      <td style="text-align: left">æ•´å‹ä»¥åå…­è¿›åˆ¶ã€å­—æ¯å¤§å†™æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%U</code></td>
      <td style="text-align: left">Unicode å­—ç¬¦</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%f</code></td>
      <td style="text-align: left">æµ®ç‚¹æ•°,å¦‚<code class="language-plaintext highlighter-rouge">%6.2f</code>ï¼ŒæŒ‡å®šæ•´æ•°ä¸å°æ•°ä½é•¿åº¦</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%p</code></td>
      <td style="text-align: left">æŒ‡é’ˆï¼Œåå…­è¿›åˆ¶æ–¹å¼æ˜¾ç¤º</td>
    </tr>
    <tr>
      <td style="text-align: center"><code class="language-plaintext highlighter-rouge">%s</code></td>
      <td style="text-align: left">å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²è¾“å‡ºï¼Œ<code class="language-plaintext highlighter-rouge">%10s</code>/<code class="language-plaintext highlighter-rouge">%-10s</code>ï¼Œå®½åº¦ä¸º10å·¦/å³å¯¹é½</td>
    </tr>
  </tbody>
</table>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://www.runoob.com/go/go-fmt-sprintf.html">Gofmt.Sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²</a>;<a href="https://studygolang.com/articles/17400">æ·±å…¥ç†è§£fmtåŒ…</a></li>
</ul>

<h3 id="15-go-è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼enums">15 Go è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼(enums)ï¼Ÿ</h3>

<p>ä½¿ç”¨const å¸¸é‡æ¥è¡¨ç¤ºæšä¸¾å€¼ <code class="language-plaintext highlighter-rouge">iota</code> è¡¨ç¤º0</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">StuType</span> <span class="kt">int32</span>

<span class="k">const</span> <span class="p">(</span>
	<span class="n">Type1</span> <span class="n">StuType</span> <span class="o">=</span> <span class="no">iota</span>
	<span class="n">Type2</span>
	<span class="n">Type3</span>
	<span class="n">Type4</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">Type1</span><span class="p">,</span> <span class="n">Type2</span><span class="p">,</span> <span class="n">Type3</span><span class="p">,</span> <span class="n">Type4</span><span class="p">)</span> <span class="c">// 0, 1, 2, 3</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="16-ç©º-struct-çš„ç”¨é€”">16 ç©º struct{} çš„ç”¨é€”</h3>
<p>ä¸»è¦ç”¨äºå ä½ç¬¦å·ï¼Œè¡¨æ˜è¿™é‡Œå¹¶ä¸éœ€è¦ä¸€ä¸ªå€¼ï¼Œæ¥è¿›è¡Œå†…å­˜èŠ‚çœã€‚ä¸»è¦ç”¨äºä»¥ä¸‹åœºæ™¯</p>
<ol>
  <li>mapä¸­valueå ä½ç¬¦ï¼Œç”¨äºè¡¨ç¤ºset</li>
  <li>ç®¡é“(channel)ä¸­å ä½ç¬¦ï¼Œä»…ä»…è¡¨ç¤ºä¿¡å·</li>
  <li>åŸºç¡€å·¥å…·ç±»ï¼šä»…ä»…ç”¨äºç»§æ‰¿æ¥å£å£°æ˜æ–¹æ³•</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span> 

<span class="c">// 1. è¾“å‡ºå€¼</span>
<span class="k">func</span> <span class="n">PrintTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">unsafe</span><span class="o">.</span><span class="n">Sizeof</span><span class="p">(</span><span class="k">struct</span><span class="p">{}{}))</span> <span class="c">// 0</span>
<span class="p">}</span>

<span class="c">// 2. æ„é€ set</span>
<span class="k">type</span> <span class="n">Set</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="k">struct</span><span class="p">{}</span>

<span class="k">func</span> <span class="n">SetTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">set</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="n">Set</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="o">:=</span> <span class="k">range</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">"A"</span><span class="p">,</span> <span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">,</span> <span class="s">"C"</span><span class="p">}</span> <span class="p">{</span>
		<span class="n">set</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="k">struct</span><span class="p">{}{}</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">set</span><span class="p">))</span> <span class="c">// 3</span>
	<span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">set</span><span class="p">[</span><span class="s">"A"</span><span class="p">];</span> <span class="n">ok</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"A exists"</span><span class="p">)</span> <span class="c">// A exists</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c">// 3. ä½¿ç”¨ç®¡é“</span>
<span class="k">func</span> <span class="n">ChannelTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">struct</span><span class="p">{},</span> <span class="m">1</span><span class="p">)</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="o">&lt;-</span><span class="n">ch</span>
		<span class="c">// do something</span>
	<span class="p">}()</span>
	<span class="n">ch</span> <span class="o">&lt;-</span> <span class="k">struct</span><span class="p">{}{}</span>
<span class="p">}</span>

<span class="c">// 4. å£°æ˜æ–¹æ³•ç»§æ‰¿</span>
<span class="k">type</span> <span class="n">Lamp</span> <span class="k">struct</span><span class="p">{}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">l</span> <span class="n">Lamp</span><span class="p">)</span> <span class="n">On</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">println</span><span class="p">(</span><span class="s">"On"</span><span class="p">)</span>

<span class="p">}</span>
<span class="k">func</span> <span class="p">(</span><span class="n">l</span> <span class="n">Lamp</span><span class="p">)</span> <span class="n">Off</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">println</span><span class="p">(</span><span class="s">"Off"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">PrintTest</span><span class="p">()</span>
    <span class="n">SetTest</span><span class="p">()</span>
    <span class="n">ChannelTest</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="å®ç°åŸç†">å®ç°åŸç†</h2>
<h3 id="01-init-å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„">01 init() å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„ï¼Ÿ</h3>
<ul>
  <li>init ä¸manå‡½æ•°ä¸€æ ·ï¼Œä¸èƒ½æœ‰å…¥å‚ä¸è¿”å›å€¼</li>
  <li>init å‡½æ•°ç”±runtimeåˆå§‹åŒ–æ¯ä¸ªåŒ…çš„å¯¼å…¥ï¼ŒæŒ‰ç…§è§£æçš„ä¾èµ–å…³ç³»ï¼Œæ²¡æœ‰ä¾èµ–çš„åŒ…æœ€å…ˆåˆå§‹åŒ–</li>
  <li>åŒ…åˆå§‹åŒ–é¡ºåºï¼š åŒ…ä½œç”¨åŸŸå¸¸é‡-&gt; åŒ…ä½œç”¨åŸŸå˜é‡-&gt; åŒ…å†…init()å‡½æ•°ã€‚å³<code class="language-plaintext highlighter-rouge">import â€“&gt; const â€“&gt; var â€“&gt; init() â€“&gt; main()</code></li>
  <li>åŒåŒ…å†…å¤šä¸ª<code class="language-plaintext highlighter-rouge">init()</code>ï¼šæŒ‰ç…§å®ƒä»¬å‘ˆç°ç»™ç¼–è¯‘å™¨çš„é¡ºåºè¢«è°ƒç”¨
    <ul>
      <li>åŒæ–‡ä»¶å†…ï¼šæŒ‰ç…§å‡½æ•°é¡ºåºè¿›è¡Œè°ƒç”¨</li>
      <li>åŒåŒ…ä¸åŒæºæ–‡ä»¶ï¼šæ˜¯æ ¹æ®æ–‡ä»¶åçš„å­—å…¸åºæ¥ç¡®å®š</li>
    </ul>
  </li>
  <li>ä¸åŒåŒ…ï¼š
    <ul>
      <li>æ— ç›¸äº’ä¾èµ–ï¼šæŒ‰ç…§main åŒ…ä¸­importçš„é¡ºåºè°ƒç”¨å…¶åŒ…ä¸­çš„initå‡½æ•°</li>
      <li>å­˜åœ¨ä¾èµ–ï¼šè°ƒç”¨é¡ºåºä¸ºæœ€åè¢«ä¾èµ–çš„æœ€å…ˆè¢«åˆå§‹åŒ–ï¼Œå¦‚å¯¼å…¥é¡ºåº<code class="language-plaintext highlighter-rouge">main &gt; a &gt; b &gt;c</code>, åˆå§‹åŒ–é¡ºåº<code class="language-plaintext highlighter-rouge">c &gt; b &gt; a &gt; main</code></li>
    </ul>
  </li>
  <li>ä½¿ç”¨å»ºè®®ï¼šåº”å½“å°½é‡é¿å…ä½¿ç”¨<code class="language-plaintext highlighter-rouge">init()</code>ï¼Œé¿å…<code class="language-plaintext highlighter-rouge">init</code> ä¾èµ–å…¶ä»–é¡ºåºã€‚</li>
</ul>

<p><img src="https://cdn.learnku.com/uploads/images/202007/13/1/hVMYyqi6EU.png!large" alt="" /></p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// a åŒ…</span>
<span class="c">// a.go</span>
<span class="k">package</span> <span class="n">a</span>

<span class="k">import</span> <span class="n">_</span> <span class="s">"main/b"</span>

<span class="k">func</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">println</span><span class="p">(</span><span class="s">"init a"</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// b åŒ…</span>
<span class="c">// b.go</span>
<span class="k">package</span> <span class="n">b</span>

<span class="k">import</span> <span class="n">_</span> <span class="s">"main/c"</span>

<span class="k">func</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">println</span><span class="p">(</span><span class="s">"init b"</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// c åŒ…</span>
<span class="c">// c.go</span>
<span class="k">package</span> <span class="n">c</span>

<span class="k">func</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">println</span><span class="p">(</span><span class="s">"init c"</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// main åŒ…</span>
<span class="c">// main.go</span>
<span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="n">_</span> <span class="s">"main/a"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">println</span><span class="p">(</span><span class="s">"init main"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">println</span><span class="p">(</span><span class="s">"main"</span><span class="p">)</span>
<span class="p">}</span>

</code></pre></div></div>
<p>å¯¹åº”è¾“å‡ºï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>go build <span class="o">&amp;&amp;</span> ./main
init c
init b
init a
init main
main
</code></pre></div></div>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://learnku.com/go/t/47135">ä¸€å¼ å›¾äº†è§£ Go è¯­è¨€ä¸­çš„ init () æ‰§è¡Œé¡ºåº
</a>;<a href="https://cloud.tencent.com/developer/article/2138066">ä¸€æ–‡è¯»æ‡‚Golang initå‡½æ•°æ‰§è¡Œé¡ºåº</a></li>
</ul>

<h3 id="02-go-è¯­è¨€çš„å±€éƒ¨å˜é‡åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Š">02 Go è¯­è¨€çš„å±€éƒ¨å˜é‡åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šï¼Ÿ</h3>

<p>ç”±ç¼–è¯‘å™¨å†³å®šã€‚ç¼–è¯‘å™¨ç»è¿‡é€ƒé€¸åˆ†æï¼Œå‘ç°å˜é‡ä½œç”¨åŸŸæœªè¶…å‡ºå‡½æ•°èŒƒå›´æ—¶ï¼Œåˆ†é…åœ¨æ ˆä¸Šã€‚åä¹‹å¿…é¡»åˆ†é…åœ¨å †ä¸Šã€‚å¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">-gcflags=-m</code> ç¼–è¯‘å‚æ•°ï¼ŒæŸ¥çœ‹é€ƒé€¸åˆ†æ</p>

<p>å…³é”®åœ¨äºgoçš„é€ƒé€¸åˆ†æï¼Œgo é€ƒé€¸(å †ä¸Šåˆ†é…)åŸåˆ™å¦‚ä¸‹ï¼š</p>
<ol>
  <li>æŒ‡é’ˆé€ƒé€¸ï¼šå‡½æ•°è¿”å›å¯¹è±¡æŒ‡é’ˆæ—¶ï¼Œå†…å­˜åˆ†é…åœ¨å †ä¸Š</li>
  <li><code class="language-plaintext highlighter-rouge">interface{}</code>åŠ¨æ€ç±»å‹é€ƒé€¸ï¼šinterface{}ä¸ºæŒ‡é’ˆåˆ«åï¼Œä¹Ÿä¼šå‘ç”Ÿé€ƒé€¸</li>
  <li>æ ˆç©ºé—´ä¸è¶³ï¼šæ ˆä½¿ç”¨è¶…è¿‡æ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹æ ˆé™åˆ¶(64ä½é€šå¸¸ä¸º8M,å¯ä»¥ç”¨<code class="language-plaintext highlighter-rouge">ulimit -a</code>æŸ¥çœ‹)æˆ–è€…åˆ‡ç‰‡é•¿åº¦æ— æ³•ç¡®å®šæ—¶ï¼Œå°†å­˜åœ¨é€ƒé€¸</li>
  <li>é—­åŒ…ï¼šé—­åŒ…ä¸­å†…å±‚å‡½æ•°ä¼šè®¿é—®å¤–å±‚å‡½æ•°ä½œç”¨åŸŸã€‚è®¿é—®çš„å¤–éƒ¨å˜é‡ä¼šé€ƒé€¸</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// 1. è¿”å›æŒ‡é’ˆé€ƒé€¸</span>
<span class="c">// d åœ¨å †ä¸Šåˆ†é…å†…å­˜</span>
<span class="k">func</span> <span class="n">createDemo</span><span class="p">(</span><span class="n">name</span> <span class="kt">string</span><span class="p">)</span> <span class="o">*</span><span class="n">Demo</span> <span class="p">{</span>
	<span class="n">d</span> <span class="o">:=</span> <span class="nb">new</span><span class="p">(</span><span class="n">Demo</span><span class="p">)</span> <span class="c">// å±€éƒ¨å˜é‡ d é€ƒé€¸åˆ°å †</span>
	<span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
	<span class="k">return</span> <span class="n">d</span>
<span class="p">}</span>

<span class="c">// 2. interface é€ƒé€¸</span>
<span class="c">// å±€éƒ¨å˜é‡demo ä¸ä¼šå‘ç”Ÿé€ƒé€¸ï¼Œä½†æ˜¯demo.name ä¼šé€ƒé€¸</span>
<span class="k">func</span> <span class="n">test</span><span class="p">(</span><span class="n">demo</span> <span class="o">*</span><span class="n">Demo</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">demo</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// 3. å†…å­˜ä¸è¶³é€ƒé€¸</span>
<span class="c">// 3.1 è¶…è¿‡64KBå‘ç”Ÿé€ƒé€¸</span>
<span class="k">func</span> <span class="n">generate8192</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">nums</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="m">8192</span><span class="p">)</span> <span class="c">// = 64KB</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">8192</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">Int</span><span class="p">()</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="c">// 3.2 ä¸ç¡®å®šå¤§å°é€ƒé€¸</span>
<span class="k">func</span> <span class="n">generate</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">nums</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="c">// ä¸ç¡®å®šå¤§å°</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">Int</span><span class="p">()</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c">// 4. é—­åŒ…é€ƒé€¸</span>
<span class="c">// Increase() è¿”å›å€¼æ˜¯ä¸€ä¸ªé—­åŒ…å‡½æ•°</span>
<span class="c">// å‡½æ•°è®¿é—®äº†å¤–éƒ¨å˜é‡n,nä¼šä¸€ç›´å­˜åœ¨ç›´åˆ°in è¢«é”€æ¯</span>
<span class="k">func</span> <span class="n">IncreaseTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">in</span> <span class="o">:=</span> <span class="n">Increase</span><span class="p">()</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">in</span><span class="p">())</span> <span class="c">// 1</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">Increase</span><span class="p">()</span> <span class="k">func</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">n</span> <span class="o">:=</span> <span class="m">0</span>
	<span class="k">return</span> <span class="k">func</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
		<span class="n">n</span><span class="o">++</span>
		<span class="k">return</span> <span class="n">n</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ä½¿ç”¨å»ºè®®ï¼š</p>
<ul>
  <li>æŒ‡é’ˆä¼ é€’å¢åŠ é€ƒé€¸è´Ÿæ‹…ï¼šä¼ å€¼ä¼šæ‹·è´æ•´ä¸ªå¯¹è±¡ï¼Œè€ŒæŒ‡é’ˆåªä¼šæ‹·è´æŒ‡é’ˆåœ°å€ï¼Œå¯¹åº”çš„å¯¹è±¡ä¸€ç›´æ˜¯åŒä¸€ä¸ªï¼Œä¼ æŒ‡é’ˆå¯ä»¥æœ‰æ•ˆå‡å°‘å€¼çš„æ‹·è´ã€‚ä½†æ˜¯ä¼šå¯¼è‡´å†…å­˜åˆ†é…é€ƒé€¸åˆ°å †ä¸­ï¼Œå¢åŠ GCè´Ÿæ‹…ã€‚åœ¨å¯¹è±¡é¢‘ç¹åˆ›å»ºå’Œåˆ é™¤çš„åœºæ™¯ä¸‹ï¼Œä¼ é€’æŒ‡é’ˆå¯¼è‡´çš„ GC å¼€é”€å¯èƒ½ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚
    <ul>
      <li><strong>å¯¹äºéœ€è¦ä¿®æ”¹åŸå¯¹è±¡å€¼ï¼Œæˆ–å ç”¨å†…å­˜æ¯”è¾ƒå¤§çš„ç»“æ„ä½“ï¼Œé€‰æ‹©ä¼ æŒ‡é’ˆ</strong></li>
      <li><strong>åªè¯»çš„å ç”¨å†…å­˜è¾ƒå°çš„ç»“æ„ä½“ï¼Œç›´æ¥ä¼ å€¼èƒ½å¤Ÿè·å¾—æ›´å¥½çš„æ€§èƒ½</strong></li>
    </ul>
  </li>
</ul>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://draveness.me/golang/docs/part3-runtime/ch07-memory/golang-memory-allocator/">goå†…å­˜ç®¡ç†</a>;<a href="https://geektutu.com/post/hpg-escape-analysis.html">Goé€ƒé€¸åˆ†æ</a>;<a href="https://zhuanlan.zhihu.com/p/523215127">10åˆ†é’ŸæŒæ¡golangå†…å­˜ç®¡ç†æœºåˆ¶</a></li>
</ul>

<h3 id="03-2-ä¸ª-interface-å¯ä»¥æ¯”è¾ƒå—">03 2 ä¸ª interface å¯ä»¥æ¯”è¾ƒå—ï¼Ÿ</h3>
<ul>
  <li>å¯ä»¥ï¼šgo interface å†…éƒ¨å®ç°åŒ…å«äº†ç±»å‹<code class="language-plaintext highlighter-rouge">T</code> å’Œå€¼<code class="language-plaintext highlighter-rouge">v</code>ã€‚å¯è¿›è¡Œæ¯”è¾ƒï¼Œç›¸ç­‰æ—¶å­˜åœ¨å¦‚ä¸‹æƒ…å†µ
    <ol>
      <li>å‡ä¸ºnil(vå’ŒTéƒ½å¤„äºunsetçŠ¶æ€)</li>
      <li>ç±»å‹ç›¸åŒï¼Œå¹¶ä¸”å¯¹åº”çš„å€¼ç›¸ç­‰
interfaceåº•å±‚ä½¿ç”¨2ä¸ªstructè¡¨ç¤ºçš„ï¼šefaceå’Œifaceï¼Œå…¶å®é™…ç±»å‹å®šä¹‰å¦‚ä¸‹ï¼š</li>
    </ol>
  </li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// runtime/runtime2.go</span>
<span class="c">// ç©ºæ•°æ®ç±»å‹æŒ‡é’ˆ--ä¸å¸¦æ–¹æ³•</span>
<span class="k">type</span> <span class="n">eface</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">_type</span> <span class="o">*</span><span class="n">_type</span>  <span class="c">// ç±»å‹æŒ‡é’ˆ</span>
	<span class="n">data</span>  <span class="n">unsafe</span><span class="o">.</span><span class="n">Pointer</span> <span class="c">// æ•°æ®å€¼æŒ‡é’ˆ</span>
<span class="p">}</span>

<span class="c">// runtime/runtime2.go</span>
<span class="c">// éç©ºæ¥å£--å¸¦æ–¹æ³•</span>
<span class="k">type</span> <span class="n">iface</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">tab</span>  <span class="o">*</span><span class="n">itab</span>          <span class="c">// å¯¹åº”çš„è™šæ‹Ÿå‡½æ•°è¡¨</span>
    <span class="n">data</span> <span class="n">unsafe</span><span class="o">.</span><span class="n">Pointer</span> <span class="c">//æŒ‡å‘åŸå§‹æ•°æ®æŒ‡é’ˆ</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">type</span> <span class="n">TestStruct</span> <span class="k">struct</span><span class="p">{}</span>

<span class="c">// Go è¯­è¨€çš„æ¥å£ç±»å‹ä¸æ˜¯ä»»æ„ç±»å‹</span>
<span class="c">// è¿™é‡Œè¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå°†ç±»å‹è½¬æ¢ä¸ºäº†*TestStructç±»å‹</span>
<span class="c">// åŒ…å«äº†*TestStructçš„ç±»å‹ä¿¡æ¯</span>
<span class="k">func</span> <span class="n">NilOrNot</span><span class="p">(</span><span class="n">v</span> <span class="k">interface</span><span class="p">{})</span> <span class="kt">bool</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">v</span> <span class="o">==</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">s</span> <span class="o">*</span><span class="n">TestStruct</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span>      <span class="c">// #=&gt; true</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">NilOrNot</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>   <span class="c">// #=&gt; false</span>
<span class="p">}</span>

<span class="err">$</span> <span class="k">go</span> <span class="n">run</span> <span class="n">main</span><span class="o">.</span><span class="k">go</span>
<span class="no">true</span>
<span class="no">false</span>
</code></pre></div></div>

<hr />

<ul>
  <li>å‚è€ƒ: <a href="https://www.cnblogs.com/jiujuan/p/12653806.html">æ·±å…¥ç†è§£Goè¯­è¨€(01): interfaceæºç åˆ†æ</a>;<a href="https://github.com/friendlyhank/toBeTopgopher/blob/master/golang/source/golang%E4%B9%8Binterface%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">golangä¹‹interfaceæ¥å£æºç è§£æ</a>;<a href="https://github.com/friendlyhank/toBeTopgopher/blob/master/golang/source/golang%E4%B9%8Binterface%E6%8E%A5%E5%8F%A3%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.md">goè¯­è¨€æ¥å£</a></li>
</ul>

<h3 id="04-2-ä¸ª-nil-å¯èƒ½ä¸ç›¸ç­‰å—">04 2 ä¸ª nil å¯èƒ½ä¸ç›¸ç­‰å—ï¼Ÿ</h3>

<p>å¯èƒ½: ç±»å‹å€¼ä¸åŒæ—¶ï¼Œå¯èƒ½ä¸ç›¸ç­‰</p>
<ul>
  <li>nilæŒ‡é’ˆå«ä¹‰ï¼šæ¥å£(interface) æ˜¯å¯¹éæ¥å£å€¼(æŒ‡é’ˆ/structç­‰)çš„å°è£…ï¼Œå†…éƒ¨å®ç°åŒ…å«<code class="language-plaintext highlighter-rouge">T</code> å’Œ<code class="language-plaintext highlighter-rouge">v</code>ã€‚ä¸€ä¸ªæ¥å£ä¸ºnilï¼Œä»…ä»…è¡¨æ˜<code class="language-plaintext highlighter-rouge">T</code>/<code class="language-plaintext highlighter-rouge">V</code> éƒ½å¤„äº<code class="language-plaintext highlighter-rouge">unset</code> çŠ¶æ€(<code class="language-plaintext highlighter-rouge">T=nil, V = unset</code>)ã€‚</li>
  <li>æ¥å£å€¼æ¯”è¾ƒï¼šå…ˆæ¯”è¾ƒ<code class="language-plaintext highlighter-rouge">T</code>, å†æ¯”è¾ƒ<code class="language-plaintext highlighter-rouge">V</code></li>
  <li>æ¥å£å€¼ä¸éæ¥å£å€¼æ¯”è¾ƒï¼šå°†éæ¥å£å€¼è½¬æ¢ä¸ºæ¥å£å€¼ï¼Œå†è¿›è¡Œæ¯”è¾ƒ</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="k">type</span> <span class="n">MyInterface</span> <span class="k">interface</span> <span class="p">{</span>
    <span class="n">DoSomething</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">MyType</span> <span class="k">struct</span><span class="p">{}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">mt</span> <span class="o">*</span><span class="n">MyType</span><span class="p">)</span> <span class="n">DoSomething</span><span class="p">()</span> <span class="p">{}</span>

<span class="k">func</span> <span class="n">test2</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">i</span> <span class="n">MyInterface</span>
    <span class="k">var</span> <span class="n">t</span> <span class="o">*</span><span class="n">MyType</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span>  <span class="c">// è¾“å‡ºï¼štrue</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span>  <span class="c">// è¾“å‡ºï¼štrue</span>
 	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span>  <span class="c">// è¾“å‡ºï¼šfalse</span>
	
    <span class="n">i</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span>  <span class="c">// è¾“å‡ºï¼šfalse</span>
<span class="p">}</span>



<span class="k">func</span> <span class="n">test1</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">p</span> <span class="o">*</span><span class="kt">int</span> <span class="o">=</span> <span class="no">nil</span> 
    <span class="c">// æ­¤æ—¶i ä¸­çš„T = *int, V= nil</span>
    <span class="k">var</span> <span class="n">i</span> <span class="k">interface</span><span class="p">{}</span> <span class="o">=</span> <span class="n">p</span>
    <span class="c">// ç±»å‹ç›¸åŒä¸å€¼ç›¸åŒ--ç›¸ç­‰</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">p</span><span class="p">)</span> <span class="c">// true</span>
    <span class="c">// p å€¼ä¸ºnil--ç›¸ç­‰</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">p</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span> <span class="c">// true</span>
	<span class="c">// å°†nil è½¬æ¢ä¸ºæ¥å£(T=nil, V=nil), i Tå€¼ä¸ç›¸åŒ--ä¸ç›¸ç­‰</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="no">nil</span><span class="p">)</span> <span class="c">// false -- i å­˜åœ¨ç±»å‹å€¼</span>
<span class="p">}</span>

</code></pre></div></div>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://www.iamshuaidi.com/23121.html">åœ¨Golangä¸­,ä¸¤ä¸ªnilå¯èƒ½ä¸ç›¸ç­‰å—ï¼Ÿ</a>;</li>
</ul>

<h3 id="05-ç®€è¿°-go-è¯­è¨€gcåƒåœ¾å›æ”¶çš„å·¥ä½œåŸç†">05 ç®€è¿° Go è¯­è¨€GC(åƒåœ¾å›æ”¶)çš„å·¥ä½œåŸç†</h3>
<p>å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•æœ‰<strong>æ ‡è®°æ¸…é™¤(Mark-Sweep)</strong>å’Œ<strong>å¼•ç”¨è®¡æ•°(Reference Count)(å¦‚c++ share_ptr)</strong>ï¼ŒGOè¯­è¨€é‡‡ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ŒåŒæ—¶ä¸ºäº†æé«˜æ•ˆç‡ä¿è¯å‡†ç¡®æ€§ï¼Œä½¿ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•å’Œå†™å±éšœæŠ€æœ¯ã€‚</p>

<p>æ ‡è®°æ¸…é™¤æ³•åˆ†ä¸ºå¦‚ä¸‹ä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ul>
  <li>æ ‡è®°(Mark)é˜¶æ®µï¼šä»æ ¹å¯¹è±¡å‡ºå‘ï¼ŒæŸ¥æ‰¾å¹¶æ ‡è®°å †ä¸­æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡ã€‚éœ€è¦ä½¿ç”¨<strong>æš‚åœç¨‹åº(Stop The World, STW)</strong></li>
  <li>æ¸…é™¤(Sweep)é˜¶æ®µï¼šéå†å †ä¸­çš„å…¨éƒ¨å¯¹è±¡ï¼Œå›æ”¶æœªæ ‡è®°çš„åƒåœ¾å¯¹è±¡å¹¶å°†å›æ”¶çš„å†…å­˜åŠ å…¥ç©ºé—²é“¾è¡¨
Go ä¸ºäº†èƒ½å¤Ÿå¼‚æ­¥æ‰§è¡Œï¼Œå‡å°‘STWæ—¶é—´ï¼Œé‡‡ç”¨äº†ä¸‰è‰²æ ‡è®°æ³•ã€‚é€šè¿‡ä¸‰è‰²æ ‡è®°ç®—æ³•é™ä½æ ‡è®°çš„éœ€è¦æ—¶é—´ã€‚ä¸»è¦æ˜¯å°†ç®—æ³•ç¨‹åºä¸­çš„å¯¹è±¡åˆ†ä¸ºé»‘ã€ç™½ã€ç°ä¸‰ç±»ï¼Œåªæœ‰ç™½è‰²ä¼šè¢«æ¸…é™¤ï¼š</li>
  <li>ç™½è‰²ï¼šä¸ç¡®å®šå¯¹è±¡â€“å¯ä»¥æ¸…é™¤</li>
  <li>ç°è‰²ï¼šå­˜æ´»å¯¹è±¡ï¼Œå­å¯¹è±¡éœ€è¦è¿›ä¸€æ­¥å¤„ç†</li>
  <li>é»‘è‰²ï¼šå­˜æ´»å¯¹è±¡</li>
</ul>

<p>ä¸»è¦æ¸…é™¤æ ‡è®°æµç¨‹å¦‚ä¸‹ï¼š</p>

<ol>
  <li>ç¨‹åºåˆå§‹åŒ–ï¼šåˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰å¯¹è±¡åŠ å…¥ç™½è‰²é›†åˆ(éœ€è¦STW)ï¼Œå°†<strong>æ ¹å¯¹è±¡(æŒ‡èµ‹å€¼å™¨ä¸éœ€è¦é€šè¿‡å…¶ä»–å¯¹è±¡å°±å¯ä»¥ç›´æ¥è®¿é—®åˆ°çš„å¯¹è±¡,å¦‚å…¨å±€å˜é‡/åç¨‹æ‰§è¡Œæ ˆ)</strong>æ ‡è®°ä¸ºç°è‰²ã€‚</li>
  <li>é¢œè‰²æ‰«æï¼šä»ç°è‰²ç‹¬äº«é›†åˆä¸­å–å‡º(ROOT)å¯¹è±¡å¼€å§‹æ‰«æ
 a. å°†ç›´æ¥å¯è¾¾çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²
 a. å°†å–å‡ºå¯¹è±¡æ ‡è®°ä¸ºé»‘è‰²
 b. å°†å…¶æŒ‡å‘çš„æ‰€æœ‰å¯¹è±¡æ ‡è®°ä¸ºç°è‰²
 c. é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°æ— ç°è‰²å¯¹è±¡</li>
  <li>å¯¹è±¡æ¸…é™¤ï¼šæ¸…é™¤ç™½è‰²å¯¹è±¡</li>
</ol>

<p><img src="https://data.eolink.com/2022-01-14/1642152085-909098-image.png" alt="åˆå§‹ä¸‰è‰²æ ‡è®°æ³•" /></p>

<p>ä½†æ˜¯ä¸‰è‰²æ ‡è®°æ³•å¼ºä¾èµ– STW(æ€§èƒ½è¾ƒå·®)ï¼Œ å¦åˆ™æ ‡è®°é˜¶æ®µç¨‹åºçš„é€»è¾‘æ”¹å˜å¯¹è±¡å¼•ç”¨å…³ç³»,ä¼šå½±å“æ ‡è®°ç»“æœçš„æ­£ç¡®æ€§ï¼Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æƒ…å†µï¼š</p>

<p><img src="https://data.eolink.com/2022-01-14/1642152123-524607-image.png" alt="éSTW ä¸‰è‰²æ ‡è®°å¼‚å¸¸" /></p>

<p>ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œå°½é‡å‡å°‘STWä½¿ç”¨ï¼ŒGolang å¯¹ä¸‰è‰²æ ‡è®°æ³•è¿›è¡Œäº†ä¼˜åŒ–ã€‚
ä¸Šé¢çš„æ ‡è®°å¼‚å¸¸é—®é¢˜å‡ºç°ï¼Œå­˜åœ¨ä¸¤ä¸ªæ¡ä»¶</p>
<ol>
  <li><strong>ç™½è‰²å¯¹è±¡è¢«é»‘è‰²å¯¹è±¡å¼•ç”¨</strong></li>
  <li><strong>ç°è‰²å¯¹è±¡ä¸ç™½è‰²å¯¹è±¡ä¹‹é—´çš„å¯è¾¾å…³ç³»é­åˆ°ç ´å</strong></li>
</ol>

<p>åªè¦ä¸Šè¿°æ¡ä»¶ä»»æ„ç ´åä¸€ä¸‹ï¼Œå°±å¯ä»¥ä¿è¯å¯¹è±¡ä¸ä¸¢å¤±ã€‚ç”±æ­¤æå‡ºäº†ç ´åæ–¹å¼ï¼š</p>
<ol>
  <li><strong>å¼ºä¸‰è‰²ä¸å˜å¼ï¼š</strong> ä¸å…è®¸é»‘è‰²å¯¹è±¡å¼•ç”¨ç™½è‰²å¯¹è±¡â€“ç ´åæ¡ä»¶ä¸€</li>
  <li><strong>å¼±ä¸‰è‰²ä¸å˜å¼ï¼š</strong> é»‘è‰²å¯¹è±¡å¯ä»¥å¼•ç”¨ç™½è‰²å¯¹è±¡ï¼Œä½†æ˜¯ç™½è‰²å¯¹è±¡çš„ä¸Šæ¸¸å¿…é¡»å­˜åœ¨ç°è‰²å¯¹è±¡â€“ä¿è¯ç™½è‰²å¯¹è±¡ä¸€å®šå¯ä»¥è¢«æ‰«æåˆ°</li>
</ol>

<p>ä¸ºäº†å°è¯•ä¿è¯ä¸Šè¿°ä¸¤ç‚¹ï¼Œæœ‰å¦‚ä¸‹æ–¹å¼ï¼Œè¯¦ç»†æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>

<ul>
  <li><strong>æ’å…¥å†™å±éšœ</strong>(å¼ºä¸‰è‰²)ï¼šå½“ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å¦å¤–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°†å¦å¤–ä¸€ä¸ªå¯¹è±¡æ ‡è®°ä¸ºç°è‰²ã€‚
    <ul>
      <li><img src="https://data.eolink.com/2022-01-14/1642152399-611837-image.png" alt="æ€»ä½“æœºåˆ¶" /></li>
      <li>ç”±äºæ ˆä¸Šå¯¹è±¡æ²¡æœ‰æ’å…¥å†™æœºåˆ¶ï¼Œåœ¨æ‰«æå®Œæˆåéœ€è¦å¯¹æ ˆä¸Šç©ºé—´è¿›è¡ŒSTWï¼Œé˜²æ­¢å¯¹è±¡é”™è¯¯åˆ é™¤ã€‚å¦‚ä¸‹ï¼š</li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152399-611837-image.png" alt="" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152408-446949-image.png" alt="" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152415-201031-image.png" alt="" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152430-572346-image.png" alt="" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152437-364823-image.png" alt="" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152443-909009-image.png" alt="" /></li>
      <li><strong>ç¼ºç‚¹ï¼š</strong> æ ˆä¸Šå¯¹è±¡æ— æ³•æ“ä½œ, éœ€è¦å¯¹æ ˆç©ºé—´è¿›è¡Œstwä¿æŠ¤ï¼Œç„¶årescanä¿è¯å¼•ç”¨çš„ç™½è‰²å¯¹è±¡å­˜æ´»ã€‚å¢åŠ äº†GCæ—¶é—´</li>
    </ul>
  </li>
  <li><strong>åˆ é™¤å†™å±éšœ</strong>(å¼±ä¸‰è‰²)ï¼šåœ¨åˆ é™¤å¼•ç”¨æ—¶ï¼Œå¦‚æœè¢«åˆ é™¤å¼•ç”¨çš„å¯¹è±¡è‡ªèº«ä¸ºç°è‰²æˆ–è€…ç™½è‰²ï¼Œé‚£ä¹ˆè¢«æ ‡è®°ä¸ºç°è‰²ã€‚
    <ul>
      <li><img src="https://data.eolink.com/2022-01-14/1642152473-725532-image.png" alt="åˆ é™¤å†™å±éšœ" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152488-972239-image.png" alt="åˆ é™¤å†™å±éšœ2" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152483-907048-image.png" alt="åˆ é™¤å†™å±éšœ3" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152488-972239-image.png" alt="åˆ é™¤å†™å±éšœ4" /></li>
      <li><strong>ç¼ºç‚¹ï¼š</strong> ä¸­é—´å˜æ›´çš„æ— å¼•ç”¨å¯¹è±¡ï¼Œä¼šè¢«ä¿ç•™ï¼Œå­˜æ´»åˆ°ä¸‹ä¸€è½®ï¼Œé™ä½äº†å›æ”¶ç²¾åº¦
        <ul>
          <li><a href="https://data.eolink.com/2022-01-14/1642152499-445418-image.png">åˆ é™¤æœºåˆ¶</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>æ··åˆå†™å±éšœæœºåˆ¶(v1.8)</strong>ï¼šæ ˆä¸Šå¯è¾¾å¯¹è±¡å…¨éƒ¨æ ‡é»‘(é¿å…æ ˆå¼•ç”¨ä¸¢å¤±)ï¼Œå †ä¸Šåˆ é™¤/æ·»åŠ å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹
    <ul>
      <li>GCåˆšå¼€å§‹çš„æ—¶å€™ï¼Œä¼šå°†æ ˆä¸Šçš„å¯è¾¾å¯¹è±¡å…¨éƒ¨æ ‡è®°ä¸ºé»‘è‰²ã€‚</li>
      <li>GCæœŸé—´ï¼Œä»»ä½•åœ¨æ ˆä¸Šæ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå‡ä¸ºé»‘è‰²ã€‚</li>
      <li>å †ä¸Šè¢«åˆ é™¤çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²</li>
      <li>å †ä¸Šæ–°æ·»åŠ çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²</li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152632-450577-image.png" alt="æµç¨‹å›¾1" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152632-450577-image.png" alt="æµç¨‹å›¾2" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152638-980225-image.png" alt="æµç¨‹å›¾3" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152643-404267-image.png" alt="æµç¨‹å›¾4" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152647-868470-image.png" alt="æµç¨‹å›¾5" /></li>
      <li><img src="https://data.eolink.com/2022-01-14/1642152652-807003-image.png" alt="æµç¨‹å›¾6" /></li>
    </ul>
  </li>
</ul>

<p>æœ€ç»ˆgo ä½¿ç”¨<strong>æ’å…¥å†™æœºåˆ¶</strong>ï¼Œåœ¨ç”¨æˆ·ç¨‹åºè¯»å–å¯¹è±¡ã€åˆ›å»ºæ–°å¯¹è±¡ä»¥åŠæ›´æ–°å¯¹è±¡æ—¶ï¼Œæ‰§è¡Œä¸€æ®µä¸´ç•ŒåŒºä»£ç (å†…å­˜å±éšœ)ã€‚å½“å¯¹è±¡æ–°å¢æˆ–è€…æ›´æ–°æ—¶ï¼Œå°†å…¶ç€è‰²ä¸ºç°è‰²ã€‚è¿™æ ·å³ä½¿ä¸ç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œå¯¹è±¡çš„å¼•ç”¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨ä¹Ÿèƒ½æ­£ç¡®å¤„ç†äº†ã€‚</p>

<ul>
  <li>æ€»ç»“ï¼Œ
    <ul>
      <li>å®Œæ•´GCé˜¶æ®µå¦‚ä¸‹ï¼š
        <ul>
          <li>1ï¼‰æ ‡è®°å‡†å¤‡(Mark Setupï¼Œéœ€ STW)ï¼Œæ‰“å¼€å†™å±éšœ(Write Barrier)</li>
          <li>2ï¼‰ä½¿ç”¨ä¸‰è‰²æ ‡è®°æ³•æ ‡è®°ï¼ˆMarking, å¹¶å‘ï¼‰</li>
          <li>3ï¼‰æ ‡è®°ç»“æŸ(Mark Terminationï¼Œéœ€ STW)ï¼Œå…³é—­å†™å±éšœã€‚</li>
          <li>4ï¼‰æ¸…ç†(Sweeping, å¹¶å‘)</li>
        </ul>
      </li>
      <li>ç‰ˆæœ¬æ¼”è¿›ï¼š
        <ul>
          <li>v1.3ï¼šé‡‡ç”¨ä¼ ç»Ÿé‡‡å–æ ‡è®°-æ¸…é™¤æ³•ï¼Œéœ€è¦STWï¼Œæš‚åœæ•´ä¸ªç¨‹åºçš„è¿è¡Œã€‚</li>
          <li>v1.5ï¼šå¼•å…¥äº†ä¸‰è‰²æ ‡è®°æ³•å’Œæ’å…¥å†™å±éšœæœºåˆ¶ï¼Œå…¶ä¸­æ’å…¥å†™å±éšœæœºåˆ¶åªåœ¨å †å†…å­˜ä¸­ç”Ÿæ•ˆã€‚ä½†åœ¨æ ‡è®°è¿‡ç¨‹ä¸­ï¼Œæœ€åéœ€è¦å¯¹æ ˆè¿›è¡ŒSTWã€‚</li>
          <li>v1.8ï¼šç»“åˆåˆ é™¤å†™å±éšœæœºåˆ¶ï¼Œæ¨å‡ºäº†æ··åˆå±éšœæœºåˆ¶ï¼Œå±éšœé™åˆ¶åªåœ¨å †å†…å­˜ä¸­ç”Ÿæ•ˆã€‚é¿å…äº†æœ€åèŠ‚ç‚¹å¯¹æ ˆè¿›è¡ŒSTWçš„é—®é¢˜ï¼Œæå‡äº†GCæ•ˆç‡</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://draveness.me/golang/docs/part3-runtime/ch07-memory/golang-garbage-collector/">goåƒåœ¾æ”¶é›†å™¨</a>;<a href="https://community.apinto.com/d/34057-golang-gc">ä¸€æ–‡å¼„æ‡‚ Golang GCã€ä¸‰è‰²æ ‡è®°ã€æ··åˆå†™å±éšœæœºåˆ¶</a></li>
</ul>

<h3 id="06-å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨">06 å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨ï¼Ÿ</h3>

<p>å®‰å…¨ï¼šGolang ä¼šå¯¹æ¯ä¸ªå˜é‡è¿›è¡Œé€ƒé€¸åˆ†æï¼Œå‘ç°å…¶ä½œç”¨åŸŸè¶…å‡ºå‡½æ•°æ—¶ï¼Œä¼šç›´æ¥åœ¨å †ä¸Šåˆ†é…å†…å­˜</p>

<h3 id="07-éæ¥å£çš„ä»»æ„ç±»å‹-t-éƒ½èƒ½å¤Ÿè°ƒç”¨-t-çš„æ–¹æ³•å—åè¿‡æ¥å‘¢">07 éæ¥å£çš„ä»»æ„ç±»å‹ T() éƒ½èƒ½å¤Ÿè°ƒç”¨ *T çš„æ–¹æ³•å—ï¼Ÿåè¿‡æ¥å‘¢ï¼Ÿ</h3>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">T()</code>è°ƒç”¨<code class="language-plaintext highlighter-rouge">*T</code>ä»…ä»…åœ¨Tå¯å¯»å€çš„æƒ…å†µä¸‹æˆç«‹</strong>ï¼šç¼–è¯‘å™¨åœ¨è°ƒç”¨æŒ‡é’ˆå±ä¸»æ–¹æ³•ä¹‹å‰ï¼Œä¼šè‡ªåŠ¨å–æ­¤Tå€¼çš„åœ°å€ã€‚å› ä¸ºä¸æ˜¯æ¯ä¸ªTéƒ½å¯ä»¥è¿›è¡Œå¯»å€ï¼Œæ‰€ä»¥å¹¶éä»»ä½•Tå€¼éƒ½èƒ½å¤Ÿè°ƒç”¨ä¸ºç±»å‹*Tå£°æ˜çš„æ–¹æ³•ã€‚å­˜åœ¨å¦‚ä¸‹æƒ…å†µ(ç¼–è¯‘å‰ç¡®å®šçš„å€¼)æ—¶ä¸å¯å¯»å€
    <ul>
      <li>å­—ç¬¦ä¸²ä¸­çš„å­—èŠ‚</li>
      <li>map å¯¹è±¡ä¸­çš„å…ƒç´ ï¼ˆslice å¯¹è±¡ä¸­çš„å…ƒç´ æ˜¯å¯å¯»å€çš„ï¼Œsliceçš„åº•å±‚æ˜¯æ•°ç»„ï¼‰</li>
      <li>å¸¸é‡</li>
      <li>åŒ…çº§åˆ«çš„å‡½æ•°</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">*T</code> ç±»å‹çš„å€¼<strong>å¯ä»¥è°ƒç”¨</strong><code class="language-plaintext highlighter-rouge">T</code>å£°æ˜æ–¹æ³•ï¼š
    <ul>
      <li>å› ä¸ºè§£å¼•ç”¨æŒ‡é’ˆæ€»æ˜¯åˆæ³•çš„ã€‚</li>
      <li>æ¯ä¸€ä¸ªç±»å‹<code class="language-plaintext highlighter-rouge">T</code> å£°æ˜çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨éƒ½ä¼šä¸ºç±»å‹<code class="language-plaintext highlighter-rouge">*T</code> è‡ªåŠ¨éšå¼å£°æ˜ä¸€ä¸ªåŒåå’ŒåŒç­¾åçš„æ–¹æ³•ã€‚</li>
    </ul>
  </li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">T</span> <span class="kt">string</span>

<span class="k">func</span> <span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="n">hello</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"hello"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">t1</span> <span class="n">T</span> <span class="o">=</span> <span class="s">"ABC"</span>
	<span class="n">t1</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span> <span class="c">// hello</span>
    <span class="c">// t2 ä¸ºå¸¸é‡--é*T ç±»å‹</span>
	<span class="k">const</span> <span class="n">t2</span> <span class="n">T</span> <span class="o">=</span> <span class="s">"ABC"</span>
	<span class="n">t2</span><span class="o">.</span><span class="n">hello</span><span class="p">()</span> <span class="c">// error: cannot call pointer method on t</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="å¹¶å‘ç¼–ç¨‹">å¹¶å‘ç¼–ç¨‹</h2>

<h3 id="01-æ— ç¼“å†²çš„-channel-å’Œæœ‰ç¼“å†²çš„-channel-çš„åŒºåˆ«">01 æ— ç¼“å†²çš„ channel å’Œæœ‰ç¼“å†²çš„ channel çš„åŒºåˆ«ï¼Ÿ</h3>
<ul>
  <li>æ— ç¼“å†²channel: å‘é€æ–¹å°†é˜»å¡è¯¥ä¿¡é“ï¼Œç›´åˆ°æ¥æ”¶æ–¹ä»è¯¥ä¿¡é“æ”¶åˆ°æ•°æ®ä¸ºæ­¢ï¼Œæ¥æ”¶æ–¹åŒæ ·éœ€è¦é˜»å¡è¯¥ä¿¡å·ï¼Œç›´åˆ°å‘é€æ–¹å°†æ•°æ®å‘é€åˆ°è¯¥ä¿¡é“ä¸­ä¸ºæ­¢</li>
  <li>æœ‰ç¼“å†²channel: ä¿¡å·å†å­˜åœ¨ç¼“å†²ä¸­ï¼Œåœ¨ç¼“å†²åŒºç”¨å°½çš„æƒ…å†µä¸‹é˜»å¡</li>
</ul>

<p>å¯ä»¥ç”¨äºè¿›è¡Œåç¨‹äº¤æ›¿æ‰“å°å­—ç¬¦ä¸²</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ch1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">struct</span><span class="p">{})</span>
<span class="n">ch2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">struct</span><span class="p">{})</span>
<span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
<span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>

<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="m">2</span> <span class="p">{</span>
      <span class="o">&lt;-</span><span class="n">ch1</span>
      <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">ch2</span> <span class="o">&lt;-</span> <span class="k">struct</span><span class="p">{}{}</span>
   <span class="p">}</span>
   <span class="o">&lt;-</span><span class="n">ch1</span>
<span class="p">}()</span>

<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="m">2</span> <span class="p">{</span>
      <span class="o">&lt;-</span><span class="n">ch2</span>
      <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">ch1</span> <span class="o">&lt;-</span> <span class="k">struct</span><span class="p">{}{}</span>
<span class="p">}</span>

<span class="n">ch1</span> <span class="o">&lt;-</span> <span class="k">struct</span><span class="p">{}{}</span>
<span class="c">// ç­‰å¾…åç¨‹æ‰§è¡Œå®Œæ¯•</span>
<span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
</code></pre></div></div>

<hr />

<ul>
  <li>å‚è€ƒ: <a href="https://ayang.ink/go_%E9%9D%A2%E8%AF%95%E9%A2%98-%E4%B8%A4%E4%B8%AA%E5%8D%8F%E7%A8%8B%E4%BA%A4%E6%9B%BF%E6%89%93%E5%8D%B0%E5%A5%87%E5%81%B6%E6%95%B0%E5%86%85%E5%90%AB%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/">é¢è¯•é¢˜ - ä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°å¥‡å¶æ•°ï¼ˆå†…å«ä¸‰ç§æ–¹æ³•ï¼‰</a>;<a href="https://juejin.cn/post/7209319092515635261">golangä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°</a>;<a href="https://studygolang.com/articles/35057?fr=sidebar">Golangä¸¤ä¸ªåç¨‹äº¤æ›¿è¾“å‡º</a></li>
</ul>

<h3 id="02-ä»€ä¹ˆæ˜¯åç¨‹æ³„éœ²goroutine-leak">02 ä»€ä¹ˆæ˜¯åç¨‹æ³„éœ²(Goroutine Leak)ï¼Ÿ</h3>
<ul>
  <li>å®šä¹‰ï¼šåç¨‹åˆ›å»ºåé•¿æ—¶é—´ä¸é‡Šæ”¾ï¼Œå¹¶ä¸”è¿˜åœ¨ä¸æ–­çš„åˆ›å»ºæ–°çš„åç¨‹ï¼Œæœ€ç»ˆå¯¼è‡´å†…å­˜è€—å°½ï¼Œç¨‹åºå´©æºƒã€‚</li>
  <li>åŸå› ï¼šå¯¼è‡´åç¨‹æ³„æ¼çš„ä¸»è¦åœºæ™¯æœ‰ä»¥ä¸‹å‡ ç§ï¼š
    <ul>
      <li>ç¼ºå°‘æ¥æ”¶å™¨/ç¼ºå°‘å‘é€å™¨:ï¼Œå¯¼è‡´å¯¹åº”çº¿ç¨‹é˜»å¡ï¼Œæ— æ³•æ­£å¸¸è¿›è¡Œé€€å‡º</li>
      <li>æ­»é”(dead lock):ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„åç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºç«äº‰èµ„æºæˆ–è€…ç”±äºå½¼æ­¤é€šä¿¡è€Œé€ æˆé˜»å¡ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šå¯¼è‡´åç¨‹è¢«é˜»å¡ï¼Œä¸èƒ½é€€å‡ºã€‚</li>
      <li>æ— é™å¾ªç¯(infinite loops): ä¸ºäº†é¿å…ç½‘ç»œç­‰é—®é¢˜ï¼Œé‡‡ç”¨äº†æ— é™é‡è¯•çš„æ–¹å¼ï¼Œå‘é€ HTTP è¯·æ±‚ï¼Œç›´åˆ°è·å–åˆ°æ•°æ®ã€‚é‚£å¦‚æœ HTTP æœåŠ¡å®•æœºï¼Œæ°¸è¿œä¸å¯è¾¾ï¼Œå¯¼è‡´åç¨‹ä¸èƒ½é€€å‡ºï¼Œå‘ç”Ÿæ³„æ¼</li>
    </ul>
  </li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// ç¼ºå°‘æ¥æ”¶å™¨å¯¼è‡´æ­»é”</span>
<span class="k">func</span> <span class="n">query</span><span class="p">()</span> <span class="kt">int</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">int</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">1000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span> <span class="n">ch</span> <span class="o">&lt;-</span> <span class="m">0</span> <span class="p">}()</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="o">&lt;-</span><span class="n">ch</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">queryTest</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">query</span><span class="p">()</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"goroutines: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">runtime</span><span class="o">.</span><span class="n">NumGoroutine</span><span class="p">())</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="c">// goroutines: 1001</span>
<span class="c">// goroutines: 2000</span>
<span class="c">// goroutines: 2999</span>
<span class="c">// goroutines: 3998</span>


<span class="c">// è¿™é‡Œæ­»å¾ªç¯è¯·æ±‚</span>
<span class="k">func</span> <span class="n">request</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">,</span> <span class="n">wg</span> <span class="o">*</span><span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">http</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">url</span><span class="p">);</span> <span class="n">err</span> <span class="o">==</span> <span class="no">nil</span> <span class="p">{</span>
            <span class="c">// write to db</span>
            <span class="k">break</span>
        <span class="p">}</span>
        <span class="n">i</span><span class="o">++</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="m">3</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
        <span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">waitTest</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
    <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">1000</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
        <span class="k">go</span> <span class="n">request</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"https://127.0.0.1:8080/%d"</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">wg</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/383138313">ä»€ä¹ˆæ˜¯åç¨‹æ³„éœ²(Goroutine Leak)ï¼Ÿ</a>;<a href="https://blog.csdn.net/qq_37102984/article/details/129326866">Golang httpè¯·æ±‚å¿˜è®°è°ƒç”¨resp.Body.Close()è€Œå¯¼è‡´çš„åç¨‹æ³„æ¼é—®é¢˜</a></li>
</ul>

<h3 id="03-go-å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—">03 Go å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—ï¼Ÿ</h3>

<ul>
  <li>å¯ä»¥ï¼›å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡ GOMAXPROCS æˆ– runtime.GOMAXPROCS(num int) è®¾ç½®ï¼Œä¾‹å¦‚ï¼š</li>
</ul>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">runtime</span><span class="o">.</span><span class="n">GOMAXPROCS</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="c">// é™åˆ¶åŒæ—¶æ‰§è¡ŒGoä»£ç çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹æ•°ä¸º 1</span>
</code></pre></div></div>
<p>ä»å®˜æ–¹æ–‡æ¡£çš„è§£é‡Šå¯ä»¥çœ‹åˆ°ï¼ŒGOMAXPROCS é™åˆ¶çš„æ˜¯åŒæ—¶æ‰§è¡Œç”¨æˆ·æ€ Go ä»£ç çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡ï¼Œä½†æ˜¯å¯¹äºè¢«ç³»ç»Ÿè°ƒç”¨é˜»å¡çš„çº¿ç¨‹æ•°é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚GOMAXPROCS çš„é»˜è®¤å€¼ç­‰äº CPU çš„é€»è¾‘æ ¸æ•°ï¼ŒåŒä¸€æ—¶é—´ï¼Œä¸€ä¸ªæ ¸åªèƒ½ç»‘å®šä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åè¿è¡Œè¢«è°ƒåº¦çš„åç¨‹ã€‚å› æ­¤å¯¹äº CPU å¯†é›†å‹çš„ä»»åŠ¡ï¼Œè‹¥è¯¥å€¼è¿‡å¤§ï¼Œä¾‹å¦‚è®¾ç½®ä¸º CPU é€»è¾‘æ ¸æ•°çš„ 2 å€ï¼Œä¼šå¢åŠ çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œé™ä½æ€§èƒ½ã€‚å¯¹äº I/O å¯†é›†å‹åº”ç”¨ï¼Œé€‚å½“åœ°è°ƒå¤§è¯¥å€¼ï¼Œå¯ä»¥æé«˜ I/O ååç‡ã€‚</p>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://www.zhihu.com/question/584554235/answer/3033310978?utm_id=0">Golang åœ¨ runtime ä¸­çš„çŸ¥è¯†ç‚¹æœ‰å“ªäº›ï¼Ÿ</a>;<a href="https://zhuanlan.zhihu.com/p/95056679?from=groupmessage">ä¸‡å­—é•¿æ–‡æ·±å…¥æµ…å‡º Golang Runtime</a>;<a href="https://pkg.go.dev/runtime">go-runtime</a></li>
</ul>

<h2 id="ä»£ç è¾“å‡º">ä»£ç è¾“å‡º</h2>
<h3 id="å˜é‡ä¸å¸¸é‡">å˜é‡ä¸å¸¸é‡</h3>

<ol>
  <li>ä¸‹é¢ä»£ç çš„è¾“å‡ºæ˜¯ï¼š</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">const</span> <span class="p">(</span>
		<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">"golang"</span><span class="p">,</span> <span class="m">100</span>
		<span class="n">d</span><span class="p">,</span> <span class="n">e</span>
		<span class="n">f</span> <span class="kt">bool</span> <span class="o">=</span> <span class="no">true</span>
		<span class="n">g</span>
	<span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="p">}</span>
<span class="c">// golang 100 true</span>

</code></pre></div></div>
<p>åœ¨åŒä¸€ä¸ª const group ä¸­ï¼Œå¦‚æœå¸¸é‡å®šä¹‰ä¸å‰ä¸€è¡Œçš„å®šä¹‰ä¸€è‡´ï¼Œåˆ™å¯ä»¥çœç•¥ç±»å‹å’Œå€¼ã€‚ç¼–è¯‘æ—¶ï¼Œä¼šæŒ‰ç…§å‰ä¸€è¡Œçš„å®šä¹‰è‡ªåŠ¨è¡¥å…¨ã€‚å³ç­‰ä»·äºï¼š</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">const</span> <span class="p">(</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="s">"golang"</span><span class="p">,</span> <span class="m">100</span>
        <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="s">"golang"</span><span class="p">,</span> <span class="m">100</span>
        <span class="n">f</span> <span class="kt">bool</span> <span class="o">=</span> <span class="no">true</span>
        <span class="n">g</span> <span class="kt">bool</span> <span class="o">=</span> <span class="no">true</span>
    <span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>ä¸‹åˆ—ä»£ç çš„è¾“å‡ºæ˜¯ï¼š</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">const</span> <span class="n">N</span> <span class="o">=</span> <span class="m">100</span>
    <span class="k">var</span> <span class="n">x</span> <span class="kt">int</span> <span class="o">=</span> <span class="n">N</span>

    <span class="k">const</span> <span class="n">M</span> <span class="kt">int32</span> <span class="o">=</span> <span class="m">100</span>
    <span class="k">var</span> <span class="n">y</span> <span class="kt">int</span> <span class="o">=</span> <span class="n">M</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// ç¼–è¯‘å¤±è´¥ï¼šcannot use M (type int32) as type int in assignment</span>
</code></pre></div></div>

<p>Go è¯­è¨€ä¸­ï¼Œå¸¸é‡åˆ†ä¸ºæ— ç±»å‹å¸¸é‡å’Œæœ‰ç±»å‹å¸¸é‡ä¸¤ç§ï¼Œconst N = 100ï¼Œå±äºæ— ç±»å‹å¸¸é‡ï¼Œèµ‹å€¼ç»™å…¶ä»–å˜é‡æ—¶ï¼Œå¦‚æœå­—é¢é‡èƒ½å¤Ÿè½¬æ¢ä¸ºå¯¹åº”ç±»å‹çš„å˜é‡ï¼Œåˆ™èµ‹å€¼æˆåŠŸï¼Œä¾‹å¦‚ï¼Œvar x int = Nã€‚ä½†æ˜¯å¯¹äºæœ‰ç±»å‹çš„å¸¸é‡ const M int32 = 100ï¼Œèµ‹å€¼ç»™å…¶ä»–å˜é‡æ—¶ï¼Œéœ€è¦ç±»å‹åŒ¹é…æ‰èƒ½æˆåŠŸï¼Œæ‰€ä»¥æ˜¾ç¤ºåœ°ç±»å‹è½¬æ¢ï¼š<code class="language-plaintext highlighter-rouge">var y int = int(M)</code></p>

<ol>
  <li>ä¸‹åˆ—ä»£ç çš„è¾“å‡ºæ˜¯ï¼š</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">a</span> <span class="kt">int8</span> <span class="o">=</span> <span class="o">-</span><span class="m">1</span>
    <span class="k">var</span> <span class="n">b</span> <span class="kt">int8</span> <span class="o">=</span> <span class="o">-</span><span class="m">128</span> <span class="o">/</span> <span class="n">a</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="p">}</span>
<span class="c">// -128</span>
</code></pre></div></div>

<p>int8 èƒ½è¡¨ç¤ºçš„æ•°å­—çš„èŒƒå›´æ˜¯ [-2^7, 2^7-1]ï¼Œå³ [-128, 127]ã€‚-128 æ˜¯æ— ç±»å‹å¸¸é‡ï¼Œè½¬æ¢ä¸º int8ï¼Œå†é™¤ä»¥å˜é‡ -1ï¼Œç»“æœä¸º 128ï¼Œå¸¸é‡é™¤ä»¥å˜é‡ï¼Œç»“æœæ˜¯ä¸€ä¸ªå˜é‡ã€‚<strong>å˜é‡è½¬æ¢æ—¶å…è®¸æº¢å‡º</strong>ï¼Œç¬¦å·ä½å˜ä¸º1ï¼Œè½¬ä¸ºè¡¥ç åæ°å¥½ç­‰äº -128ã€‚
å¯¹äºæœ‰ç¬¦å·æ•´å‹ï¼Œæœ€é«˜ä½æ˜¯æ˜¯ç¬¦å·ä½ï¼Œè®¡ç®—æœºç”¨è¡¥ç è¡¨ç¤ºè´Ÿæ•°ã€‚è¡¥ç  = åŸç å–ååŠ ä¸€ã€‚</p>

<pre><code class="language-txt">-1 :  11111111
00000001(åŸç )    11111110(å–å)    11111111(åŠ ä¸€)
-128ï¼š    
10000000(åŸç )    01111111(å–å)    10000000(åŠ ä¸€)

-1 + 1 = 0
11111111 + 00000001 = 00000000(æœ€é«˜ä½æº¢å‡ºçœç•¥)
-128 + 127 = -1
10000000 + 01111111 = 11111111

</code></pre>
<ul>
  <li><strong>æ­£æ•°ä»¥åŸç å½¢å¼å­˜åœ¨ï¼Œè´Ÿæ•°ä»¥è¡¥ç å½¢å¼å­˜åœ¨()</strong></li>
  <li><strong>æ­£æ•°æœ€é«˜ä½ä¸º0ï¼Œè´Ÿæ•°æœ€é«˜ä½ä¸º1</strong></li>
  <li><strong>æœ€é«˜ä½ä¸º1çš„éœ€è¦å½“ä½œè¡¥ç è½¬æ¢ä¸ºè´Ÿæ•°</strong></li>
</ul>

<ol>
  <li>ä¸‹åˆ—ä»£ç çš„è¾“å‡ºæ˜¯ï¼š</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">const</span> <span class="n">a</span> <span class="kt">int8</span> <span class="o">=</span> <span class="o">-</span><span class="m">1</span>
    <span class="k">var</span> <span class="n">b</span> <span class="kt">int8</span> <span class="o">=</span> <span class="o">-</span><span class="m">128</span> <span class="o">/</span> <span class="n">a</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ç¼–è¯‘å¤±è´¥ï¼šconstant 128 overflows int8</p>

<p>-128 å’Œ a éƒ½æ˜¯å¸¸é‡ï¼Œåœ¨ç¼–è¯‘æ—¶æ±‚å€¼ï¼Œ-128 / a = 128ï¼Œä¸¤ä¸ªå¸¸é‡ç›¸é™¤ï¼Œç»“æœä¹Ÿæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå¸¸é‡ç±»å‹è½¬æ¢æ—¶ä¸å…è®¸æº¢å‡ºï¼Œå› è€Œç¼–è¯‘å¤±è´¥ã€‚</p>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/129361870">è´Ÿæ•°åœ¨è®¡ç®—æœºä¸­çš„å‚¨å­˜æ–¹å¼</a></li>
</ul>

<h3 id="ä½œç”¨åŸŸ">ä½œç”¨åŸŸ</h3>

<p>ä¸‹é¢çš„ä»£ç è¾“å‡ºæ˜¯</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">err</span> <span class="kt">error</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">==</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">err</span> <span class="o">:=</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"err"</span><span class="p">)</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c">// 1 err</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">:=</code> è¡¨ç¤ºå£°æ˜å¹¶èµ‹å€¼ï¼Œ<code class="language-plaintext highlighter-rouge">=</code> è¡¨ç¤ºä»…èµ‹å€¼ã€‚</p>

<p>å˜é‡çš„ä½œç”¨åŸŸæ˜¯å¤§æ‹¬å·ï¼Œå› æ­¤åœ¨ç¬¬ä¸€ä¸ª <code class="language-plaintext highlighter-rouge">if</code> è¯­å¥ <code class="language-plaintext highlighter-rouge">if err == nil</code> å†…éƒ¨é‡æ–°å£°æ˜ä¸”èµ‹å€¼äº†ä¸å¤–éƒ¨å˜é‡åŒåçš„å±€éƒ¨å˜é‡ <code class="language-plaintext highlighter-rouge">err</code>ã€‚å¯¹è¯¥å±€éƒ¨å˜é‡çš„èµ‹å€¼ä¸ä¼šå½±å“åˆ°å¤–éƒ¨çš„ <code class="language-plaintext highlighter-rouge">err</code>ã€‚å› æ­¤ç¬¬äºŒä¸ª <code class="language-plaintext highlighter-rouge">if</code> è¯­å¥ <code class="language-plaintext highlighter-rouge">if err != nil</code> ä¸æˆç«‹ã€‚æ‰€ä»¥åªæ‰“å°äº† <code class="language-plaintext highlighter-rouge">1 err</code>ã€‚</p>

<h3 id="deferå»¶è¿Ÿè°ƒç”¨">deferå»¶è¿Ÿè°ƒç”¨</h3>

<ol>
  <li>ä¸‹é¢çš„ä»£ç è¾“å‡ºæ˜¯</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">T</span> <span class="k">struct</span><span class="p">{}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">t</span> <span class="n">T</span><span class="p">)</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">)</span> <span class="n">T</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">var</span> <span class="n">t</span> <span class="n">T</span>
    <span class="k">defer</span> <span class="n">t</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="p">}</span>
<span class="c">// 132</span>
</code></pre></div></div>

<p>defer å»¶è¿Ÿè°ƒç”¨æ—¶ï¼Œéœ€è¦ä¿å­˜å‡½æ•°æŒ‡é’ˆå’Œå‚æ•°ï¼Œå› æ­¤é“¾å¼è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œé™¤äº†æœ€åä¸€ä¸ªå‡½æ•°/æ–¹æ³•å¤–çš„å‡½æ•°/æ–¹æ³•éƒ½ä¼šåœ¨è°ƒç”¨æ—¶ç›´æ¥æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ t.f(1) ç›´æ¥æ‰§è¡Œï¼Œç„¶åæ‰§è¡Œ fmt.Print(3)ï¼Œæœ€åå‡½æ•°è¿”å›æ—¶å†æ‰§è¡Œ .f(2)ï¼Œå› æ­¤è¾“å‡ºæ˜¯ 132ã€‚â€“ <strong>è¯­æ³•è§£æï¼Œå°†deferçœ‹ä½œä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°æŒ‡é’ˆå’Œå‚æ•°ï¼Œç”±æœ€åä¸€ä¸ªå†³å®š</strong></p>

<ol>
  <li>ä¸‹é¢çš„ä»£ç è¾“å‡ºæ˜¯</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// defer æ‰§è¡Œè¯­å¥ä¸å‡½æ•°ï¼Œåœ¨å¼€å§‹æ—¶å°±ç¡®å®š</span>
    <span class="c">// è¿™é‡Œnè¿›è¡Œäº†å€¼æ‹·è´ï¼Œè¾“å‡ºä¸º1</span>
    <span class="k">defer</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="m">100</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">f3</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span><span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// è¿™é‡Œ*nä¸€å¼€å§‹è¾“å…¥å°±ç¡®å®šäº†</span>
    <span class="c">// è¾“å‡ºä¸º3</span>
    <span class="k">defer</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="m">100</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">f2</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// è®¾ç½®è¾“å‡ºä¸ºæœ€ç»ˆçš„n</span>
    <span class="c">// å› æ­¤nè¾“å‡ºä¸º102</span>
    <span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">}()</span>
    <span class="c">// è¿™é‡Œç›´æ¥è¾“å‡ºn</span>
    <span class="c">// n åœ¨è®¾ç½®æ—¶å°±ç¡®å®šäº†ï¼Œå› æ­¤ä¸º2</span>
    <span class="k">defer</span> <span class="k">func</span><span class="p">(</span><span class="n">n</span> <span class="kt">int</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">}(</span><span class="n">n</span><span class="p">)</span>
    <span class="c">// è®¾ç½®å‚æ•°ä¸ºnæŒ‡é’ˆï¼Œæœ€ç»ˆè¾“å‡ºä¸ºnçš„å¼•ç”¨å€¼</span>
    <span class="c">// 102</span>
    <span class="k">defer</span> <span class="k">func</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span><span class="kt">int</span> <span class="p">)</span> <span class="p">{</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
    <span class="p">}(</span><span class="o">&amp;</span><span class="n">n</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="m">100</span>

<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">f</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
    <span class="n">f2</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">:=</span> <span class="m">3</span>
    <span class="n">f3</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">)</span>
<span class="p">}</span>

<span class="c">// 1  </span>
<span class="c">// 102</span>
<span class="c">// 2</span>
<span class="c">// 102</span>
<span class="c">// 3</span>
</code></pre></div></div>

<p>defer è¯­å¥æ‰§è¡Œæ—¶ï¼Œä¼šå°†éœ€è¦å»¶è¿Ÿè°ƒç”¨çš„å‡½æ•°å’Œå‚æ•°ä¿å­˜èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œåˆ° defer æ—¶ï¼Œå‚æ•° n(æ­¤æ—¶ç­‰äº1) å·²ç»è¢«ä¿å­˜äº†ã€‚å› æ­¤åé¢å¯¹ n çš„æ”¹åŠ¨å¹¶ä¸ä¼šå½±å“å»¶è¿Ÿå‡½æ•°è°ƒç”¨çš„ç»“æœã€‚</p>

<ol>
  <li>ä¸‹åˆ—ä»£ç çš„è¾“å‡ºæ˜¯ï¼š</li>
</ol>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">n</span> <span class="o">:=</span> <span class="m">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="m">1</span> <span class="p">{</span>
        <span class="k">defer</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="m">100</span>
    <span class="p">}</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="p">}</span>
<span class="c">// 101</span>
<span class="c">// 1</span>
</code></pre></div></div>
<p>å…ˆæ‰“å° 101ï¼Œå†æ‰“å° 1ã€‚defer çš„ä½œç”¨åŸŸæ˜¯å‡½æ•°ï¼Œè€Œä¸æ˜¯ä»£ç å—ï¼Œå› æ­¤ if è¯­å¥é€€å‡ºæ—¶ï¼Œdefer ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯ç­‰ 101 æ‰“å°åï¼Œæ•´ä¸ªå‡½æ•°è¿”å›æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œã€‚</p>

<h2 id="åŸºç¡€">åŸºç¡€</h2>

<h3 id="1-golang-ä¸­-make-å’Œ-new-çš„åŒºåˆ«åŸºæœ¬å¿…é—®">1. golang ä¸­ make å’Œ new çš„åŒºåˆ«ï¼Ÿï¼ˆåŸºæœ¬å¿…é—®ï¼‰</h3>

<ol>
  <li>ä½œç”¨ä¸åŒï¼š
    <ul>
      <li>new: æ ¹æ®ä¼ å…¥çš„ç±»å‹åˆ†é…ä¸€ç‰‡å†…å­˜ç©ºé—´å¹¶è¿”å›æŒ‡å‘è¿™ç‰‡å†…å­˜ç©ºé—´çš„æŒ‡é’ˆ</li>
      <li>make: åˆå§‹åŒ–å†…ç½®çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å‰é¢æåˆ°çš„åˆ‡ç‰‡ã€å“ˆå¸Œè¡¨å’Œ Channelï¼Œå¹¶ä¸è´Ÿè´£å˜é‡çš„äº§ç”Ÿ</li>
    </ul>
  </li>
  <li>è¿”å›å€¼ä¸åŒï¼šnew è¿”å›çš„æ˜¯ç±»å‹çš„æŒ‡é’ˆï¼Œmakeè¿”å›ç±»å‹çš„å¼•ç”¨</li>
  <li>ä½¿ç”¨èŒƒå›´ä¸åŒï¼š
    <ul>
      <li>newï¼šç”¨äºåˆ¶å®šç±»å‹<code class="language-plaintext highlighter-rouge">T</code> å¦‚<code class="language-plaintext highlighter-rouge">struct</code> ç±»çš„åˆå§‹åŒ–</li>
      <li>make: åªèƒ½ç”¨äº sliceï¼Œmapï¼Œchannel</li>
    </ul>
  </li>
</ol>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="https://sanyuesha.com/2017/07/26/go-make-and-new/">Go make å’Œ new çš„åŒºåˆ«</a>;<a href="https://draveness.me/golang/docs/part2-foundation/ch05-keyword/golang-make-and-new/">5.5 make å’Œ new</a></li>
</ul>

<h3 id="2-æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ«-åŸºæœ¬å¿…é—®">2. æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ« ï¼ˆåŸºæœ¬å¿…é—®ï¼‰</h3>

<p>ç›¸åŒç‚¹ï¼š</p>
<ul>
  <li>éƒ½æ˜¯é¡ºåºå­˜å‚¨çš„æ•°æ®ç»“æ„</li>
</ul>

<p>ä¸åŒç‚¹ï¼š</p>
<ol>
  <li>é•¿åº¦å®šä¹‰ä¸åŒï¼šæ•°ç»„æ˜¯ä¸€ä¸ªé•¿åº¦å›ºå®šçš„æ•°æ®ç±»å‹ï¼Œå…¶é•¿åº¦åœ¨å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šï¼Œä¸èƒ½åŠ¨æ€æ”¹å˜ï¼›åˆ‡ç‰‡æ˜¯ä¸€ä¸ªé•¿åº¦å¯å˜çš„æ•°æ®ç±»å‹ï¼Œå…¶é•¿åº¦åœ¨å®šä¹‰æ—¶å¯ä»¥ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªåˆå§‹é•¿åº¦ã€‚</li>
  <li>å†…å­˜ç©ºé—´åˆ†é…æ–¹å¼ä¸åŒï¼šæ•°ç»„çš„å†…å­˜ç©ºé—´æ˜¯åœ¨å®šä¹‰æ—¶åˆ†é…çš„ï¼Œå…¶å¤§å°æ˜¯å›ºå®šçš„ï¼›åˆ‡ç‰‡çš„å†…å­˜ç©ºé—´æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…çš„ï¼Œå…¶å¤§å°æ˜¯å¯å˜çš„ï¼Œåœ¨æ·»åŠ æ—¶è¿›è¡Œ<a href="https://draveness.me/golang/docs/part2-foundation/ch03-datastructure/golang-array-and-slice/#324-%E8%BF%BD%E5%8A%A0%E5%92%8C%E6%89%A9%E5%AE%B9">è‡ªåŠ¨æ‰©å®¹</a></li>
  <li>æ“ä½œå˜æ›´ä¸åŒï¼šå½“æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œå‡½æ•°æ“ä½œçš„æ˜¯æ•°ç»„çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œä¸ä¼šå½±å“åŸå§‹æ•°ç»„(å†™æ—¶æ‹·è´)ï¼›å½“åˆ‡ç‰‡ä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œå‡½æ•°æ“ä½œçš„æ˜¯åˆ‡ç‰‡çš„å¼•ç”¨ï¼Œä¼šå½±å“åŸå§‹åˆ‡ç‰‡ã€‚</li>
  <li>å®¹é‡ä¸åŒï¼šåˆ‡ç‰‡è¿˜æœ‰å®¹é‡çš„æ¦‚å¿µï¼Œå®ƒæŒ‡çš„æ˜¯åˆ†é…çš„å†…å­˜ç©ºé—´ã€‚</li>
</ol>

<hr />

<ul>
  <li>å‚è€ƒï¼š<a href="http://www.hangdaowangluo.com/archives/1938">GOä¸­æ•°ç»„ä¸åˆ‡ç‰‡çš„åŒºåˆ«</a>;<a href="https://draveness.me/golang/docs/part2-foundation/ch03-datastructure/golang-array/">goæ•°ç»„</a>;<a href="https://www.51cto.com/article/750465.html">Go è¯­è¨€æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ«</a>;<a href="https://golang.design/go-questions/slice/vs-array/">æ•°ç»„å’Œåˆ‡ç‰‡æœ‰ä»€ä¹ˆå¼‚åŒ</a></li>
</ul>

<h3 id="3-for-range-çš„æ—¶å€™å®ƒçš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–ä¹ˆ">3. for range çš„æ—¶å€™å®ƒçš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–ä¹ˆï¼Ÿ</h3>

<h3 id="4-go-deferå¤šä¸ª-defer-çš„é¡ºåºdefer-åœ¨ä»€ä¹ˆæ—¶æœºä¼šä¿®æ”¹è¿”å›å€¼">4. go deferï¼Œå¤šä¸ª defer çš„é¡ºåºï¼Œdefer åœ¨ä»€ä¹ˆæ—¶æœºä¼šä¿®æ”¹è¿”å›å€¼ï¼Ÿ</h3>

<h3 id="5-uint-ç±»å‹æº¢å‡º">5. uint ç±»å‹æº¢å‡º</h3>

<h3 id="6-ä»‹ç»-rune-ç±»å‹">6. ä»‹ç» rune ç±»å‹</h3>

<h3 id="7-golang-ä¸­è§£æ-tag-æ˜¯æ€ä¹ˆå®ç°çš„åå°„åŸç†æ˜¯ä»€ä¹ˆ">7. golang ä¸­è§£æ tag æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿåå°„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3>

<h3 id="8-è°ƒç”¨å‡½æ•°ä¼ å…¥ç»“æ„ä½“æ—¶åº”è¯¥ä¼ å€¼è¿˜æ˜¯æŒ‡é’ˆ-golang-éƒ½æ˜¯ä¼ å€¼">8. è°ƒç”¨å‡½æ•°ä¼ å…¥ç»“æ„ä½“æ—¶ï¼Œåº”è¯¥ä¼ å€¼è¿˜æ˜¯æŒ‡é’ˆï¼Ÿ ï¼ˆGolang éƒ½æ˜¯ä¼ å€¼ï¼‰</h3>

<h2 id="contextç›¸å…³">contextç›¸å…³</h2>

<h3 id="1-context-ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„">1. context ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3>

<h3 id="2-context-ä½¿ç”¨åœºæ™¯å’Œç”¨é€”">2. context ä½¿ç”¨åœºæ™¯å’Œç”¨é€”</h3>

<h2 id="channelç›¸å…³">channelç›¸å…³</h2>

<h3 id="1-channel-æ˜¯å¦çº¿ç¨‹å®‰å…¨é”ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹">1. channel æ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Ÿé”ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</h3>

<h3 id="2-go-channel-çš„åº•å±‚å®ç°åŸç†-æ•°æ®ç»“æ„">2. go channel çš„åº•å±‚å®ç°åŸç† ï¼ˆæ•°æ®ç»“æ„ï¼‰</h3>

<h3 id="3-å…³é—­çš„-channel-æœ‰æ•°æ®çš„-channelå†è¿›è¡Œè¯»-å†™-å…³é—­ä¼šæ€ä¹ˆæ ·å„ç±»å˜ç§é¢˜å‹">3. å…³é—­çš„ channel. æœ‰æ•°æ®çš„ channelï¼Œå†è¿›è¡Œè¯». å†™. å…³é—­ä¼šæ€ä¹ˆæ ·ï¼Ÿï¼ˆå„ç±»å˜ç§é¢˜å‹ï¼‰</h3>

<h3 id="4-å‘-channel-å‘é€æ•°æ®å’Œä»-channel-è¯»æ•°æ®çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„">4. å‘ channel å‘é€æ•°æ®å’Œä» channel è¯»æ•°æ®çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3>

<h2 id="mapç›¸å…³">mapç›¸å…³</h2>

<h3 id="1-map-ä½¿ç”¨æ³¨æ„çš„ç‚¹å¹¶å‘å®‰å…¨">1. map ä½¿ç”¨æ³¨æ„çš„ç‚¹ï¼Œå¹¶å‘å®‰å…¨ï¼Ÿ</h3>

<h3 id="2-map-å¾ªç¯æ˜¯æœ‰åºçš„è¿˜æ˜¯æ— åºçš„">2. map å¾ªç¯æ˜¯æœ‰åºçš„è¿˜æ˜¯æ— åºçš„ï¼Ÿ</h3>

<h3 id="3-map-ä¸­åˆ é™¤ä¸€ä¸ª-keyå®ƒçš„å†…å­˜ä¼šé‡Šæ”¾ä¹ˆ">3. map ä¸­åˆ é™¤ä¸€ä¸ª keyï¼Œå®ƒçš„å†…å­˜ä¼šé‡Šæ”¾ä¹ˆï¼Ÿ</h3>

<h3 id="4-æ€ä¹ˆå¤„ç†å¯¹-map-è¿›è¡Œå¹¶å‘è®¿é—®æœ‰æ²¡æœ‰å…¶ä»–æ–¹æ¡ˆ-åŒºåˆ«æ˜¯ä»€ä¹ˆ">4. æ€ä¹ˆå¤„ç†å¯¹ map è¿›è¡Œå¹¶å‘è®¿é—®ï¼Ÿæœ‰æ²¡æœ‰å…¶ä»–æ–¹æ¡ˆï¼Ÿ åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3>

<h3 id="5-nil-map-å’Œç©º-map-æœ‰ä½•ä¸åŒ">5. nil map å’Œç©º map æœ‰ä½•ä¸åŒï¼Ÿ</h3>

<h3 id="6-map-çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆæ˜¯æ€ä¹ˆå®ç°æ‰©å®¹">6. map çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯æ€ä¹ˆå®ç°æ‰©å®¹ï¼Ÿ</h3>

<h2 id="gmpç›¸å…³">GMPç›¸å…³</h2>

<h3 id="1-ä»€ä¹ˆæ˜¯-gmpå¿…é—®">1. ä»€ä¹ˆæ˜¯ GMPï¼Ÿï¼ˆå¿…é—®ï¼‰</h3>

<h3 id="2-è¿›ç¨‹-çº¿ç¨‹-åç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«">2. è¿›ç¨‹. çº¿ç¨‹. åç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>

<h3 id="3-æŠ¢å å¼è°ƒåº¦æ˜¯å¦‚ä½•æŠ¢å çš„">3. æŠ¢å å¼è°ƒåº¦æ˜¯å¦‚ä½•æŠ¢å çš„ï¼Ÿ</h3>

<h3 id="4-m-å’Œ-p-çš„æ•°é‡é—®é¢˜">4. M å’Œ P çš„æ•°é‡é—®é¢˜ï¼Ÿ</h3>

<h2 id="é”ç›¸å…³">é”ç›¸å…³</h2>

<h3 id="1-é™¤äº†-mutex-ä»¥å¤–è¿˜æœ‰é‚£äº›æ–¹å¼å®‰å…¨è¯»å†™å…±äº«å˜é‡">1. é™¤äº† mutex ä»¥å¤–è¿˜æœ‰é‚£äº›æ–¹å¼å®‰å…¨è¯»å†™å…±äº«å˜é‡ï¼Ÿ</h3>

<h3 id="2-go-å¦‚ä½•å®ç°åŸå­æ“ä½œ">2. Go å¦‚ä½•å®ç°åŸå­æ“ä½œï¼Ÿ</h3>

<h3 id="3-mutex-æ˜¯æ‚²è§‚é”è¿˜æ˜¯ä¹è§‚é”æ‚²è§‚é”-ä¹è§‚é”æ˜¯ä»€ä¹ˆ">3. Mutex æ˜¯æ‚²è§‚é”è¿˜æ˜¯ä¹è§‚é”ï¼Ÿæ‚²è§‚é”. ä¹è§‚é”æ˜¯ä»€ä¹ˆï¼Ÿ</h3>

<h3 id="4-mutex-æœ‰å‡ ç§æ¨¡å¼">4. Mutex æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</h3>

<h3 id="5-goroutine-çš„è‡ªæ—‹å ç”¨èµ„æºå¦‚ä½•è§£å†³">5. goroutine çš„è‡ªæ—‹å ç”¨èµ„æºå¦‚ä½•è§£å†³</h3>

<h2 id="å¹¶å‘ç›¸å…³">å¹¶å‘ç›¸å…³</h2>

<h3 id="1-æ€ä¹ˆæ§åˆ¶å¹¶å‘æ•°">1. æ€ä¹ˆæ§åˆ¶å¹¶å‘æ•°ï¼Ÿ</h3>

<h3 id="2-å¤šä¸ª-goroutine-å¯¹åŒä¸€ä¸ª-map-å†™ä¼š-panicå¼‚å¸¸æ˜¯å¦å¯ä»¥ç”¨-defer-æ•è·">2. å¤šä¸ª goroutine å¯¹åŒä¸€ä¸ª map å†™ä¼š panicï¼Œå¼‚å¸¸æ˜¯å¦å¯ä»¥ç”¨ defer æ•è·ï¼Ÿ</h3>

<h3 id="3-å¦‚ä½•ä¼˜é›…çš„å®ç°ä¸€ä¸ª-goroutine-æ± ç™¾åº¦-æ‰‹å†™ä»£ç ">3. å¦‚ä½•ä¼˜é›…çš„å®ç°ä¸€ä¸ª goroutine æ± ï¼ˆç™¾åº¦. æ‰‹å†™ä»£ç ï¼‰</h3>

<h2 id="gcç›¸å…³">GCç›¸å…³</h2>

<h3 id="1-go-gc-æ˜¯æ€ä¹ˆå®ç°çš„å¿…é—®">1. go gc æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿï¼ˆå¿…é—®ï¼‰</h3>

<h3 id="2-go-æ˜¯-gc-ç®—æ³•æ˜¯æ€ä¹ˆå®ç°çš„-å¾—ç‰©å‡ºç°é¢‘ç‡ä½">2. go æ˜¯ gc ç®—æ³•æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ï¼ˆå¾—ç‰©ï¼Œå‡ºç°é¢‘ç‡ä½ï¼‰</h3>

<h3 id="3-gc-ä¸­-stw-æ—¶æœºå„ä¸ªé˜¶æ®µæ˜¯å¦‚ä½•è§£å†³çš„-ç™¾åº¦">3. GC ä¸­ stw æ—¶æœºï¼Œå„ä¸ªé˜¶æ®µæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ ï¼ˆç™¾åº¦ï¼‰</h3>

<h3 id="4-gc-çš„è§¦å‘æ—¶æœº">4. GC çš„è§¦å‘æ—¶æœºï¼Ÿ</h3>

<h2 id="å†…å­˜ç›¸å…³">å†…å­˜ç›¸å…³</h2>

<h3 id="1-è°ˆè°ˆå†…å­˜æ³„éœ²ä»€ä¹ˆæƒ…å†µä¸‹å†…å­˜ä¼šæ³„éœ²æ€ä¹ˆå®šä½æ’æŸ¥å†…å­˜æ³„æ¼é—®é¢˜">1. è°ˆè°ˆå†…å­˜æ³„éœ²ï¼Œä»€ä¹ˆæƒ…å†µä¸‹å†…å­˜ä¼šæ³„éœ²ï¼Ÿæ€ä¹ˆå®šä½æ’æŸ¥å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿ</h3>

<h3 id="2-çŸ¥é“-golang-çš„å†…å­˜é€ƒé€¸å—ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿå†…å­˜é€ƒé€¸">2. çŸ¥é“ golang çš„å†…å­˜é€ƒé€¸å—ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿå†…å­˜é€ƒé€¸ï¼Ÿ</h3>

<h3 id="3-è¯·ç®€è¿°-go-æ˜¯å¦‚ä½•åˆ†é…å†…å­˜çš„">3. è¯·ç®€è¿° Go æ˜¯å¦‚ä½•åˆ†é…å†…å­˜çš„ï¼Ÿ</h3>

<h3 id="4-channel-åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šå“ªäº›å¯¹è±¡åˆ†é…åœ¨å †ä¸Šå“ªäº›å¯¹è±¡åˆ†é…åœ¨æ ˆä¸Š">4. Channel åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šï¼Ÿå“ªäº›å¯¹è±¡åˆ†é…åœ¨å †ä¸Šï¼Œå“ªäº›å¯¹è±¡åˆ†é…åœ¨æ ˆä¸Šï¼Ÿ</h3>

<h3 id="5-ä»‹ç»ä¸€ä¸‹å¤§å¯¹è±¡å°å¯¹è±¡ä¸ºä»€ä¹ˆå°å¯¹è±¡å¤šäº†ä¼šé€ æˆ-gc-å‹åŠ›">5. ä»‹ç»ä¸€ä¸‹å¤§å¯¹è±¡å°å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆå°å¯¹è±¡å¤šäº†ä¼šé€ æˆ gc å‹åŠ›ï¼Ÿ</h3>

<h2 id="ç®—æ³•ç›¸å…³">ç®—æ³•ç›¸å…³</h2>

<h3 id="æ ‡å‡†è¾“å…¥é—®é¢˜">æ ‡å‡†è¾“å…¥é—®é¢˜</h3>
<ul>
  <li><a href="https://www.nowcoder.com/feed/main/detail/c707c89102eb4fd4b54919546f1a26a4?sourceSSR=search">goæ ‡å‡†è¾“å…¥é—®é¢˜</a></li>
</ul>
:ET