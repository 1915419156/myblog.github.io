I",¼<h1 id="sqlç»ƒä¹ ç¬”è®°">SQLç»ƒä¹ ç¬”è®°</h1>
<blockquote>
  <p>2023-11-07 14:35:58</p>
</blockquote>

<p>SQL ç»ƒä¹ ç¬”è®°ï¼ŒåŒ…å«leetcodeç­‰SQLé¢˜ç›®å†²åˆºç¬”è®°</p>

<h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h2>
<ul>
  <li><a href="https://leetcode.cn/problemset/database/">leetcode-shell</a></li>
</ul>

<h2 id="leetcode-é¢˜ç›®">leetcode é¢˜ç›®</h2>

<h3 id="175-ç»„åˆä¸¤ä¸ªè¡¨"><a href="https://leetcode.cn/problems/combine-two-tables/description/">175. ç»„åˆä¸¤ä¸ªè¡¨</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ç›´æ¥æ­£å¸¸æŸ¥è¯¢å³å¯</span> 
<span class="k">SELECT</span> <span class="n">Person</span><span class="p">.</span><span class="n">FirstName</span> <span class="k">as</span> <span class="n">firstName</span><span class="p">,</span> <span class="n">Person</span><span class="p">.</span><span class="n">LastName</span> <span class="k">as</span> <span class="n">lastName</span><span class="p">,</span> <span class="n">Address</span><span class="p">.</span><span class="n">City</span> <span class="k">as</span> <span class="n">city</span><span class="p">,</span> <span class="n">Address</span><span class="p">.</span><span class="k">State</span> <span class="k">AS</span> <span class="k">state</span>  <span class="k">FROM</span> <span class="n">Person</span> <span class="k">LEFT</span> <span class="k">JOIN</span>  <span class="n">Address</span> <span class="k">ON</span> <span class="n">Person</span><span class="p">.</span><span class="n">PersonId</span> <span class="o">=</span> <span class="n">Address</span><span class="p">.</span><span class="n">PersonId</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span> <span class="n">firstname</span><span class="p">,</span> <span class="n">lastname</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="k">state</span> <span class="k">FROM</span> <span class="n">person</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">address</span> <span class="k">ON</span> <span class="n">person</span><span class="p">.</span><span class="n">personid</span> <span class="o">=</span> <span class="n">address</span><span class="p">.</span><span class="n">personid</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">FirstName</span><span class="p">,</span> <span class="n">LastName</span><span class="p">,</span> <span class="n">City</span><span class="p">,</span> <span class="k">State</span>
<span class="k">from</span> <span class="n">Person</span> <span class="k">left</span> <span class="k">join</span> <span class="n">Address</span>
<span class="k">on</span> <span class="n">Person</span><span class="p">.</span><span class="n">PersonId</span> <span class="o">=</span> <span class="n">Address</span><span class="p">.</span><span class="n">PersonId</span><span class="p">;</span>
</code></pre></div></div>
<blockquote>

  <p>ä½œè€…ï¼šLeetCode
é“¾æ¥ï¼šhttps://leetcode.cn/problems/combine-two-tables/
æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>

</blockquote>

<h3 id="176ç¬¬äºŒé«˜çš„è–ªæ°´"><a href="https://leetcode.cn/problems/second-highest-salary/description/">176.ç¬¬äºŒé«˜çš„è–ªæ°´</a></h3>

<ul>
  <li>æäº¤è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="n">notice</span><span class="p">:</span> <span class="err">è¿™é‡Œå¿…é¡»ä½¿ç”¨</span><span class="k">SELECT</span> <span class="err">å­æŸ¥è¯¢æ‰èƒ½è®©ç©ºè¡Œæ˜¾ç¤º</span><span class="k">null</span>
<span class="k">SELECT</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">salary</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">SecondHighestSalary</span><span class="p">;</span>


<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="n">ISFULL</span> <span class="err">è¿›è¡ŒäºŒæ¬¡æ›¿æ¢</span>
<span class="k">SELECT</span> <span class="p">(</span>
    <span class="n">IFNULL</span><span class="p">((</span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">salary</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="k">NULL</span><span class="p">)</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">SecondHighestSalary</span><span class="p">;</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">offset</span><span class="err">åŠ å¿«äº†é€Ÿåº¦</span>
<span class="k">SELECT</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">Salary</span> <span class="k">AS</span> <span class="s1">'SecondHighestSalary'</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Salary</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span> <span class="k">OFFSET</span> <span class="mi">1</span>
<span class="p">)</span> <span class="k">AS</span> <span class="s1">'SecondHighestSalary'</span><span class="p">;</span>  
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">æ€è·¯ç›¸åŒ</span>
<span class="k">SELECT</span>
    <span class="n">IFNULL</span><span class="p">(</span>
      <span class="p">(</span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">Salary</span>
       <span class="k">FROM</span> <span class="n">Employee</span>
       <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">Salary</span> <span class="k">DESC</span>
        <span class="k">LIMIT</span> <span class="mi">1</span> <span class="k">OFFSET</span> <span class="mi">1</span><span class="p">),</span>
    <span class="k">NULL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">SecondHighestSalary</span>
</code></pre></div></div>

<h3 id="177ç¬¬né«˜çš„è–ªæ°´"><a href="https://leetcode.cn/problems/nth-highest-salary/description/">177.ç¬¬Né«˜çš„è–ªæ°´</a></h3>

<ul>
  <li>å‚è€ƒé“¾æ¥ï¼š
    <ul>
      <li><a href="https://zhuanlan.zhihu.com/p/128744140">MySQLä¹‹è‡ªå®šä¹‰å‡½æ•°</a></li>
      <li><a href="https://www.cnblogs.com/wzh2010/p/13843095.html">MySQLå…¨é¢ç“¦è§£18ï¼šè‡ªå®šä¹‰å‡½æ•°</a></li>
    </ul>
  </li>
  <li>ä¸ªäººè§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">getNthHighestSalary</span><span class="p">(</span><span class="n">N</span> <span class="nb">INT</span><span class="p">)</span> <span class="k">RETURNS</span> <span class="nb">INT</span>
<span class="k">BEGIN</span>
    <span class="k">declare</span> <span class="n">a</span> <span class="nb">int</span><span class="p">;</span>
   <span class="k">SET</span> <span class="n">a</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">RETURN</span> <span class="p">(</span>
    <span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span><span class="p">.</span>
   <span class="k">SELECT</span> <span class="n">IFNULL</span><span class="p">((</span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">salary</span>  <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span> <span class="k">OFFSET</span> <span class="n">a</span><span class="p">),</span><span class="k">NULL</span><span class="p">)</span>
   
  <span class="p">);</span>
<span class="k">END</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">getNthHighestSalary</span><span class="p">(</span><span class="n">N</span> <span class="nb">INT</span><span class="p">)</span> <span class="k">RETURNS</span> <span class="nb">INT</span>
<span class="k">BEGIN</span>
<span class="k">Declare</span> <span class="n">M</span> <span class="nb">INT</span><span class="p">;</span>
<span class="k">set</span> <span class="n">M</span><span class="o">=</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="k">RETURN</span> <span class="p">(</span>
      <span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span><span class="p">.</span>
<span class="k">select</span> <span class="k">distinct</span> <span class="n">Salary</span>
      <span class="k">from</span> <span class="n">Employee</span>
      <span class="k">order</span> <span class="k">by</span> <span class="n">Salary</span> <span class="k">desc</span>
      <span class="k">limit</span> <span class="n">M</span><span class="p">,</span><span class="mi">1</span>
  <span class="p">);</span>
<span class="k">END</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">getNthHighestSalary</span><span class="p">(</span><span class="n">N</span> <span class="nb">INT</span><span class="p">)</span> <span class="k">RETURNS</span> <span class="nb">INT</span>
<span class="k">BEGIN</span>
<span class="k">DECLARE</span> <span class="n">M</span> <span class="nb">INT</span><span class="p">;</span> 
    <span class="k">SET</span> <span class="n">M</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> 
  <span class="k">RETURN</span> <span class="p">(</span>
      <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">salary</span>
      <span class="k">FROM</span> <span class="n">Employee</span>
      <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span>
      <span class="k">LIMIT</span> <span class="n">M</span><span class="p">,</span> <span class="mi">1</span>
  <span class="p">);</span>
<span class="k">END</span>

<span class="o">#</span> <span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span> <span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">nth</span><span class="o">-</span><span class="n">highest</span><span class="o">-</span><span class="n">salary</span><span class="o">/</span>
<span class="o">#</span> <span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span> <span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="178-åˆ†æ•°æ’å"><a href="https://leetcode.cn/problems/rank-scores/description/">178. åˆ†æ•°æ’å</a></h3>

<ul>
  <li>å‚è€ƒé“¾æ¥ï¼š
    <ul>
      <li><a href="https://segmentfault.com/a/1190000014386692">mysql è®¡ç®—æ’åï¼Œç”Ÿæˆæ’è¡Œæ¦œ</a></li>
      <li><a href="https://dev.mysql.com/doc/refman/8.0/en/window-functions-usage.html">mysqlçª—å£å‡½æ•°</a></li>
    </ul>
  </li>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
 <span class="n">a</span><span class="p">.</span><span class="n">score</span><span class="p">,</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span>  <span class="n">score</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Scores</span> <span class="k">AS</span> <span class="n">b</span> <span class="k">WHERE</span>  <span class="n">b</span><span class="p">.</span><span class="n">score</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">.</span><span class="n">score</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">AS</span> <span class="s1">'rank'</span>
<span class="k">FROM</span> <span class="n">Scores</span> <span class="k">AS</span> <span class="n">a</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">a</span><span class="p">.</span><span class="n">score</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">select</span>  <span class="o">*</span> <span class="k">from</span>  <span class="n">Scores</span> <span class="n">id</span>  <span class="k">where</span> <span class="n">score</span> <span class="k">order</span> <span class="k">by</span> <span class="k">desc</span><span class="p">;</span>
<span class="o">#</span> <span class="n">dense_rank</span><span class="p">()</span><span class="err">çª—å£å‡½æ•°è¿›è¡Œæ’åº</span>
<span class="o">#</span><span class="err">å¯¹</span><span class="n">Scores</span><span class="err">è¿™å¼ è¡¨çš„</span><span class="n">S</span><span class="err">å­—æ®µè¿›è¡Œæ’åº</span>
<span class="o">#</span><span class="err">å¯¹</span><span class="n">score</span><span class="err">å­—æ®µè¿›è¡Œæ’åºæŒ‰ç…§é™åºæ’åº</span>
<span class="o">#</span><span class="err">æœ€åæ”¾åˆ°</span><span class="n">rank</span><span class="err">è¿™ä¸ªæ–°çš„åˆ—ä¸­</span>
<span class="k">select</span> <span class="n">S</span><span class="p">.</span><span class="n">score</span><span class="p">,</span> <span class="n">dense_rank</span><span class="p">()</span> <span class="n">over</span><span class="p">(</span>
    <span class="k">order</span> <span class="k">by</span> <span class="n">S</span><span class="p">.</span><span class="n">score</span> <span class="k">desc</span>
<span class="p">)</span> <span class="k">As</span> <span class="s1">'rank'</span> <span class="k">from</span> <span class="n">Scores</span> <span class="n">S</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
  <span class="n">S</span><span class="p">.</span><span class="n">score</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">T</span><span class="p">.</span><span class="n">score</span><span class="p">)</span> <span class="k">AS</span> <span class="s1">'rank'</span>
<span class="k">FROM</span>
  <span class="n">Scores</span> <span class="n">S</span>
  <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">Scores</span> <span class="n">T</span> <span class="k">ON</span> <span class="n">S</span><span class="p">.</span><span class="n">score</span> <span class="o">&lt;=</span> <span class="n">T</span><span class="p">.</span><span class="n">score</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="n">S</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
  <span class="n">S</span><span class="p">.</span><span class="n">score</span>
<span class="k">ORDER</span> <span class="k">BY</span>
  <span class="n">S</span><span class="p">.</span><span class="n">score</span> <span class="k">DESC</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">rank</span><span class="o">-</span><span class="n">scores</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
  <span class="n">S</span><span class="p">.</span><span class="n">score</span><span class="p">,</span>
  <span class="n">DENSE_RANK</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span>
    <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="n">S</span><span class="p">.</span><span class="n">score</span> <span class="k">DESC</span>
  <span class="p">)</span> <span class="k">AS</span> <span class="s1">'rank'</span>
<span class="k">FROM</span>
  <span class="n">Scores</span> <span class="n">S</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">rank</span><span class="o">-</span><span class="n">scores</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="180-è¿ç»­å‡ºç°çš„æ•°å­—"><a href="https://leetcode.cn/problems/consecutive-numbers/description/">180. è¿ç»­å‡ºç°çš„æ•°å­—</a></h3>

<ul>
  <li>å‚è€ƒé“¾æ¥ï¼š
    <ul>
      <li><a href="https://blog.csdn.net/Guanjs2016/article/details/80237490">mysql in å¤šä¸ªå­—æ®µçš„ç”¨æ³•</a></li>
    </ul>
  </li>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">in</span><span class="err">è¯­å¥</span><span class="p">,</span><span class="err">ä¿è¯</span><span class="n">id</span><span class="err">è¿›è¡ŒåŒåŒ¹é…å³å¯</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">AS</span> <span class="n">ConsecutiveNums</span>   <span class="k">FROM</span> <span class="n">Logs</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span><span class="n">num</span> <span class="k">FROM</span> <span class="n">Logs</span><span class="p">)</span>
<span class="k">AND</span> <span class="p">(</span><span class="n">id</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span><span class="n">num</span> <span class="k">FROM</span> <span class="n">Logs</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> 
<span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">æŸ¥è¯¢</span><span class="n">num</span> <span class="err">åˆ«å</span>
<span class="k">select</span> <span class="k">distinct</span> <span class="n">Num</span> <span class="k">as</span> <span class="n">ConsecutiveNums</span>
<span class="k">from</span> <span class="p">(</span>
  <span class="k">select</span> <span class="n">Num</span><span class="p">,</span> 
    <span class="o">#</span> <span class="err">ç­›é€‰</span><span class="n">CNT</span>
    <span class="k">case</span> 
      <span class="k">when</span> <span class="o">@</span><span class="n">prev</span> <span class="o">=</span> <span class="n">Num</span> <span class="k">then</span> <span class="o">@</span><span class="k">count</span> <span class="p">:</span><span class="o">=</span> <span class="o">@</span><span class="k">count</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">when</span> <span class="p">(</span><span class="o">@</span><span class="n">prev</span> <span class="p">:</span><span class="o">=</span> <span class="n">Num</span><span class="p">)</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span> <span class="k">then</span> <span class="o">@</span><span class="k">count</span> <span class="p">:</span><span class="o">=</span> <span class="mi">1</span>
    <span class="k">end</span> <span class="k">as</span> <span class="n">CNT</span>
  <span class="k">from</span> <span class="n">Logs</span><span class="p">,</span> <span class="p">(</span><span class="k">select</span> <span class="o">@</span><span class="n">prev</span> <span class="p">:</span><span class="o">=</span> <span class="k">null</span><span class="p">,</span><span class="o">@</span><span class="k">count</span> <span class="p">:</span><span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span>
<span class="p">)</span> <span class="k">as</span> <span class="k">temp</span>
<span class="k">where</span> <span class="k">temp</span><span class="p">.</span><span class="n">CNT</span> <span class="o">&gt;=</span> <span class="mi">3</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">##</span> <span class="err">ç›´æ¥ä½¿ç”¨åˆ«åè¿›è¡Œç®€å•è®¡ç®—å³å¯</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span>
    <span class="n">l1</span><span class="p">.</span><span class="n">Num</span> <span class="k">AS</span> <span class="n">ConsecutiveNums</span>
<span class="k">FROM</span>
    <span class="n">Logs</span> <span class="n">l1</span><span class="p">,</span>
    <span class="n">Logs</span> <span class="n">l2</span><span class="p">,</span>
    <span class="n">Logs</span> <span class="n">l3</span>
<span class="k">WHERE</span>
    <span class="n">l1</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="n">l2</span><span class="p">.</span><span class="n">Id</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">AND</span> <span class="n">l2</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="n">l3</span><span class="p">.</span><span class="n">Id</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">AND</span> <span class="n">l1</span><span class="p">.</span><span class="n">Num</span> <span class="o">=</span> <span class="n">l2</span><span class="p">.</span><span class="n">Num</span>
    <span class="k">AND</span> <span class="n">l2</span><span class="p">.</span><span class="n">Num</span> <span class="o">=</span> <span class="n">l3</span><span class="p">.</span><span class="n">Num</span>
<span class="p">;</span>
<span class="o">#</span> <span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span> <span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">consecutive</span><span class="o">-</span><span class="n">numbers</span><span class="o">/</span>
<span class="o">#</span> <span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span> <span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="181-è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥"><a href="https://leetcode.cn/problems/employees-earning-more-than-their-managers/description/">181. è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨å­æŸ¥è¯¢åˆ«åè¿›è¡Œç­›é€‰</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">as</span> <span class="n">Employee</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">JOIN</span> <span class="p">(</span>
 <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">salary</span> <span class="k">FROM</span> <span class="n">Employee</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">new_table</span> <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">managerId</span> <span class="o">=</span> <span class="n">new_table</span><span class="p">.</span><span class="n">id</span> <span class="k">WHERE</span>  <span class="n">Employee</span><span class="p">.</span><span class="n">salary</span> <span class="o">&gt;</span> <span class="n">new_table</span><span class="p">.</span><span class="n">salary</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">inner</span> <span class="k">join</span> <span class="err">è¿›è¡Œå¿«é€ŸæŸ¥è¯¢</span>
<span class="k">select</span> <span class="n">a</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">Employee</span>
<span class="k">from</span>  <span class="n">Employee</span> <span class="k">as</span> <span class="n">a</span>  <span class="k">inner</span> <span class="k">join</span> <span class="n">Employee</span> <span class="k">as</span> <span class="n">b</span>
<span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="n">managerId</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">and</span> <span class="n">a</span><span class="p">.</span><span class="n">salary</span><span class="o">&gt;</span><span class="n">b</span><span class="p">.</span><span class="n">salary</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">ç›´æ¥åˆ«åè¿›è¡Œè”è¡¨æŸ¥è¯¢</span>
<span class="k">SELECT</span>
    <span class="o">*</span>
<span class="k">FROM</span>
    <span class="n">Employee</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">Employee</span> <span class="k">AS</span> <span class="n">b</span>
<span class="k">WHERE</span>
    <span class="n">a</span><span class="p">.</span><span class="n">ManagerId</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">Id</span>
        <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">Salary</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">.</span><span class="n">Salary</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">employees</span><span class="o">-</span><span class="n">earning</span><span class="o">-</span><span class="k">more</span><span class="o">-</span><span class="k">than</span><span class="o">-</span><span class="n">their</span><span class="o">-</span><span class="n">managers</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">join</span> <span class="err">è¿›è¡ŒæŸ¥è¯¢</span>
<span class="k">SELECT</span>
     <span class="n">a</span><span class="p">.</span><span class="n">NAME</span> <span class="k">AS</span> <span class="n">Employee</span>
<span class="k">FROM</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">a</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">b</span>
     <span class="k">ON</span> <span class="n">a</span><span class="p">.</span><span class="n">ManagerId</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">Id</span>
     <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">Salary</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">.</span><span class="n">Salary</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">employees</span><span class="o">-</span><span class="n">earning</span><span class="o">-</span><span class="k">more</span><span class="o">-</span><span class="k">than</span><span class="o">-</span><span class="n">their</span><span class="o">-</span><span class="n">managers</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="182-æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±"><a href="https://leetcode.cn/problems/duplicate-emails/description/">182. æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±</a></h3>

<ul>
  <li>æäº¤è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>

<span class="k">SELECT</span> <span class="n">email</span> <span class="k">AS</span> <span class="n">Email</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">email</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">Email</span> <span class="k">FROM</span> <span class="n">PERSON</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">EMAIL</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">EMAIL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">##</span> <span class="mi">1</span><span class="p">.</span> <span class="err">ç›´æ¥ä½¿ç”¨</span><span class="k">group</span> <span class="k">by</span> <span class="err">å’Œä¸´æ—¶è¡¨</span>
<span class="k">select</span> <span class="n">Email</span> <span class="k">from</span>
<span class="p">(</span>
  <span class="k">select</span> <span class="n">Email</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">Email</span><span class="p">)</span> <span class="k">as</span> <span class="n">num</span>
  <span class="k">from</span> <span class="n">Person</span>
  <span class="k">group</span> <span class="k">by</span> <span class="n">Email</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">statistic</span>
<span class="k">where</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">duplicate</span><span class="o">-</span><span class="n">emails</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

<span class="o">##</span> <span class="mi">2</span><span class="p">.</span> <span class="k">group</span> <span class="k">by</span> <span class="err">å’Œ</span><span class="k">having</span>

<span class="k">select</span> <span class="n">Email</span> <span class="k">from</span> <span class="n">Person</span> <span class="k">group</span> <span class="k">by</span> <span class="n">Email</span> <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="n">Email</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">;</span>

</code></pre></div></div>

<h3 id="183-ä»ä¸è®¢è´­çš„å®¢æˆ·"><a href="https://leetcode.cn/problems/customers-who-never-order/description/">183. ä»ä¸è®¢è´­çš„å®¢æˆ·</a></h3>

<ul>
  <li>æäº¤è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>

<span class="k">SELECT</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">Customers</span> <span class="k">FROM</span> <span class="n">Customers</span> <span class="k">WHERE</span> <span class="n">Id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span> 
    <span class="k">SELECT</span> <span class="k">DISTINCT</span><span class="p">(</span><span class="n">customerId</span><span class="p">)</span> <span class="k">AS</span> <span class="n">customerId</span> <span class="k">FROM</span> <span class="n">Orders</span>
<span class="p">);</span> 
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">æ€è·¯ç›¸åŒï¼Œæ²¡æœ‰ä½¿ç”¨</span><span class="k">DISTINCT</span> <span class="err">èŠ‚çœäº†æ—¶é—´</span>
<span class="k">SELECT</span>
    <span class="n">name</span> <span class="k">as</span> <span class="n">Customers</span>
<span class="k">FROM</span>
    <span class="n">Customers</span>
<span class="k">WHERE</span>
    <span class="n">id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">customerId</span> <span class="k">as</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">Orders</span><span class="p">)</span>

<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">NOT</span> <span class="k">EXISTS</span> <span class="err">å‡½æ•°èŠ‚çœäº†æ—¶é—´</span>
<span class="k">SELECT</span> <span class="n">Name</span> <span class="k">as</span> <span class="n">Customers</span> <span class="k">FROM</span> <span class="n">Customers</span> <span class="k">as</span> <span class="n">c1</span>
<span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">Id</span> <span class="k">FROM</span> <span class="n">Orders</span> <span class="k">as</span> <span class="n">c2</span>
    <span class="k">WHERE</span> <span class="n">c2</span><span class="p">.</span><span class="n">CustomerId</span> <span class="o">=</span> <span class="n">c1</span><span class="p">.</span><span class="n">Id</span>
<span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">ä½¿ç”¨</span> <span class="k">not</span> <span class="k">in</span> <span class="err">è¿›è¡Œæ’é™¤</span>
<span class="k">select</span> <span class="n">customers</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="s1">'Customers'</span>
<span class="k">from</span> <span class="n">customers</span>
<span class="k">where</span> <span class="n">customers</span><span class="p">.</span><span class="n">id</span> <span class="k">not</span> <span class="k">in</span>
<span class="p">(</span>
    <span class="k">select</span> <span class="n">customerid</span> <span class="k">from</span> <span class="n">orders</span>
<span class="p">);</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">customers</span><span class="o">-</span><span class="n">who</span><span class="o">-</span><span class="n">never</span><span class="o">-</span><span class="k">order</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

<span class="o">#</span> <span class="err">ä½¿ç”¨å·¦è¿æ¥</span>
<span class="k">SELECT</span> <span class="n">Customers</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Customers</span> 
<span class="k">FROM</span> <span class="n">Customers</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Orders</span> <span class="k">ON</span> <span class="n">Customers</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">CustomerId</span> <span class="k">WHERE</span> <span class="n">customerId</span> <span class="k">is</span> <span class="k">NULL</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">customers</span><span class="o">-</span><span class="n">who</span><span class="o">-</span><span class="n">never</span><span class="o">-</span><span class="k">order</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

</code></pre></div></div>

<h3 id="184-éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥"><a href="https://leetcode.cn/problems/department-highest-salary/description/">184. éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥</a></h3>

<ul>
  <li>æäº¤è§£ç­”:</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨å­æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨çš„æœ€å¤§å€¼ï¼Œç„¶ååŒ¹é…å³å¯</span>

<span class="k">SELECT</span> <span class="n">b</span><span class="p">.</span><span class="n">department_name</span> <span class="k">AS</span> <span class="n">Department</span><span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Employee</span><span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Salary</span> <span class="k">AS</span> <span class="n">Salary</span>
<span class="k">FROM</span> <span class="n">Employee</span><span class="p">,</span> <span class="p">(</span>
		<span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">AS</span> <span class="n">max_salary</span><span class="p">,</span> <span class="n">Department</span><span class="p">.</span><span class="n">id</span> <span class="k">AS</span> <span class="n">department_id</span><span class="p">,</span> <span class="n">Department</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">department_name</span>
		<span class="k">FROM</span> <span class="n">Employee</span>
			<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Department</span> <span class="k">ON</span> <span class="n">Department</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">.</span><span class="n">departmentId</span>
		<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">departmentId</span>
	<span class="p">)</span> <span class="n">b</span>
<span class="k">WHERE</span> <span class="n">Employee</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">department_id</span>
	<span class="k">AND</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Salary</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">max_salary</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”1ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="n">rank</span> <span class="err">ç»Ÿè®¡æœ€å¤§å€¼</span>
<span class="k">SELECT</span> <span class="n">Department</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">Employee</span><span class="p">,</span> <span class="n">salary</span> <span class="k">AS</span> <span class="n">Salary</span> 
<span class="k">FROM</span>
<span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Department</span><span class="p">,</span> 
           <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">a</span><span class="p">.</span><span class="n">departmentId</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rk</span>
    <span class="k">FROM</span> <span class="n">Employee</span> <span class="n">a</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Department</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">a</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span>
<span class="p">)</span> <span class="n">t</span>
<span class="k">WHERE</span> <span class="n">rk</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”2ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨è¿æ¥åï¼Œç›´æ¥ä½¿ç”¨</span><span class="k">IN</span> <span class="err">æŸ¥è¯¢</span>
<span class="k">SELECT</span> <span class="n">Department</span><span class="p">.</span><span class="n">Name</span> <span class="k">AS</span> <span class="s1">'Department'</span><span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Name</span> <span class="k">AS</span> <span class="s1">'Employee'</span><span class="p">,</span> <span class="n">Salary</span>
<span class="k">FROM</span> <span class="n">Employee</span>
<span class="k">JOIN</span> <span class="n">Department</span> 
<span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">Id</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="n">Employee</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">,</span> <span class="n">Salary</span><span class="p">)</span> 
<span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">DepartmentId</span><span class="p">,</span> <span class="k">MAX</span><span class="p">(</span><span class="n">Salary</span><span class="p">)</span>
   <span class="k">FROM</span> <span class="n">Employee</span>
   <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">DepartmentId</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">Department</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="s1">'Department'</span><span class="p">,</span>
    <span class="n">Employee</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="s1">'

Employee'</span><span class="p">,</span>
    <span class="n">Salary</span>
<span class="k">FROM</span>
    <span class="n">Employee</span>
        <span class="k">JOIN</span>
    <span class="n">Department</span> <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">Id</span>
<span class="k">WHERE</span>
    <span class="p">(</span><span class="n">Employee</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="p">,</span> <span class="n">Salary</span><span class="p">)</span> <span class="k">IN</span>
    <span class="p">(</span>   <span class="k">SELECT</span>
            <span class="n">DepartmentId</span><span class="p">,</span> <span class="k">MAX</span><span class="p">(</span><span class="n">Salary</span><span class="p">)</span>
        <span class="k">FROM</span>
            <span class="n">Employee</span>
        <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">DepartmentId</span>
    <span class="p">)</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">department</span><span class="o">-</span><span class="n">highest</span><span class="o">-</span><span class="n">salary</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

</code></pre></div></div>

<h3 id="185-éƒ¨é—¨å·¥èµ„å‰ä¸‰é«˜çš„æ‰€æœ‰å‘˜å·¥"><a href="https://leetcode.cn/problems/department-top-three-salaries/description/">185. éƒ¨é—¨å·¥èµ„å‰ä¸‰é«˜çš„æ‰€æœ‰å‘˜å·¥</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">å­æŸ¥è¯¢æ’åºåï¼Œä½¿ç”¨</span> <span class="n">ROW_NUMBER</span> <span class="err">çª—å£å‡½æ•°ç»Ÿè®¡è¡Œæ•°</span>
<span class="k">SELECT</span>  <span class="n">Department</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Department</span><span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Employee</span> <span class="p">,</span> <span class="n">Employee</span><span class="p">.</span><span class="n">salary</span> <span class="k">AS</span> <span class="n">Salary</span>  
<span class="k">FROM</span> <span class="n">Employee</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">departmentId</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">as</span> <span class="n">min_salary</span>  <span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">departmentId</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span>
        <span class="n">ROW_NUMBER</span><span class="p">()</span>  <span class="n">OVER</span><span class="p">(</span><span class="n">partition</span> <span class="k">by</span> <span class="n">departmentId</span>  <span class="k">order</span> <span class="k">by</span> <span class="n">salary</span>  <span class="k">desc</span><span class="p">)</span> <span class="k">as</span> <span class="n">num</span>
    <span class="k">FROM</span> 
    <span class="p">(</span>
        <span class="k">select</span> <span class="n">departmentId</span><span class="p">,</span><span class="n">salary</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">departmentId</span><span class="p">,</span><span class="n">salary</span> <span class="p">)</span> <span class="n">b</span>
    <span class="p">)</span> <span class="k">c</span>
    <span class="k">WHERE</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">departmentId</span>
<span class="p">)</span> <span class="n">d</span> <span class="k">ON</span>  <span class="n">Employee</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">departmentId</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Department</span>  <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">id</span> 
<span class="k">WHERE</span> <span class="n">Employee</span><span class="p">.</span><span class="n">salary</span> <span class="o">&gt;=</span> <span class="n">d</span><span class="p">.</span><span class="n">min_salary</span> <span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”1ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">##</span> <span class="err">ç›´æ¥å·¦è¿æ¥ç›¸åŒè¡¨ï¼Œæ‰¾åˆ°æ¯”è‡ªå·±å°çš„è¡¨ï¼Œæœ€ç»ˆç»Ÿè®¡å°çš„æ•°ç›®å³å¯</span>
<span class="k">SELECT</span>  <span class="n">d</span><span class="p">.</span><span class="n">name</span> <span class="n">Department</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">name</span> <span class="n">Employee</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">salary</span> <span class="n">Salary</span>
<span class="k">FROM</span> <span class="n">Employee</span> <span class="n">e</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="n">ee</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span> <span class="n">ee</span><span class="p">.</span><span class="n">departmentId</span> <span class="k">AND</span> <span class="n">e</span><span class="p">.</span><span class="n">salary</span> <span class="o">&lt;</span> <span class="n">ee</span><span class="p">.</span><span class="n">salary</span>
<span class="k">JOIN</span> <span class="n">Department</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">d</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">departmentId</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">e</span><span class="p">.</span><span class="n">id</span>
<span class="k">HAVING</span> <span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="p">(</span><span class="n">ee</span><span class="p">.</span><span class="n">salary</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”2ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨</span> <span class="n">DENSE_RANK</span> <span class="err">çª—å£å‡½æ•°ï¼Œç»Ÿè®¡å»é‡åçš„è¡Œæ•°</span>
<span class="k">SELECT</span> <span class="n">Department</span><span class="p">,</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">Employee</span><span class="p">,</span> <span class="n">salary</span> <span class="k">AS</span> <span class="n">Salary</span> 
<span class="k">FROM</span>
<span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Department</span><span class="p">,</span> 
           <span class="n">DENSE_RANK</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">a</span><span class="p">.</span><span class="n">departmentId</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">salary</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rk</span>
    <span class="k">FROM</span> <span class="n">Employee</span> <span class="n">a</span> <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Department</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">a</span><span class="p">.</span><span class="n">departmentId</span> <span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span>
<span class="p">)</span> <span class="n">t</span>
<span class="k">WHERE</span> <span class="n">rk</span> <span class="o">&lt;=</span> <span class="mi">3</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">d</span><span class="p">.</span><span class="n">Name</span> <span class="k">AS</span> <span class="s1">'Department'</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">Name</span> <span class="k">AS</span> <span class="s1">'Employee'</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">Salary</span>
<span class="k">FROM</span>
    <span class="n">Employee</span> <span class="n">e1</span>
        <span class="k">JOIN</span>
    <span class="n">Department</span> <span class="n">d</span> <span class="k">ON</span> <span class="n">e1</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">Id</span>
<span class="k">WHERE</span>
    <span class="mi">3</span> <span class="o">&gt;</span> <span class="p">(</span><span class="k">SELECT</span>
            <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">e2</span><span class="p">.</span><span class="n">Salary</span><span class="p">)</span>
        <span class="k">FROM</span>
            <span class="n">Employee</span> <span class="n">e2</span>
        <span class="k">WHERE</span>
            <span class="n">e2</span><span class="p">.</span><span class="n">Salary</span> <span class="o">&gt;</span> <span class="n">e1</span><span class="p">.</span><span class="n">Salary</span>
                <span class="k">AND</span> <span class="n">e1</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">DepartmentId</span>
        <span class="p">)</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">department</span><span class="o">-</span><span class="n">top</span><span class="o">-</span><span class="n">three</span><span class="o">-</span><span class="n">salaries</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="196-åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±"><a href="https://leetcode.cn/problems/delete-duplicate-emails/description/">196. åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</a></h3>

<ul>
  <li>æäº¤è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨å­æŸ¥è¯¢æ‰¾å‡ºæœ€å°çš„</span><span class="n">id</span><span class="err">å³å¯</span>
<span class="k">DELETE</span> <span class="k">FROM</span>  <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">a</span><span class="p">.</span><span class="n">min_id</span> <span class="k">FROM</span>
        <span class="p">(</span><span class="k">select</span> <span class="n">email</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">min_id</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">email</span><span class="p">)</span> <span class="n">a</span>
<span class="p">);</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">delete</span> <span class="k">from</span> <span class="n">Person</span>
<span class="k">where</span> <span class="n">id</span> <span class="k">in</span><span class="p">(</span>
    <span class="k">select</span> <span class="n">id</span> <span class="k">from</span><span class="p">(</span>
        <span class="k">select</span> <span class="o">*</span><span class="p">,</span><span class="n">row_number</span><span class="p">()</span> <span class="n">over</span><span class="p">(</span><span class="n">partition</span> <span class="k">by</span> <span class="n">email</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="p">)</span> <span class="k">as</span> <span class="n">row_num</span>
        <span class="k">from</span> <span class="n">Person</span>
    <span class="p">)</span> <span class="n">a</span>
    <span class="k">where</span> <span class="n">row_num</span> <span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>

</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">where</span><span class="err">è¯­å¥æ›´åŠ ç®€æ´</span>
<span class="k">DELETE</span> <span class="n">p1</span> <span class="k">FROM</span>
    <span class="n">Person</span> <span class="n">p1</span><span class="p">,</span>
    <span class="n">Person</span> <span class="n">p2</span>
<span class="k">WHERE</span>
    <span class="n">p1</span><span class="p">.</span><span class="n">Email</span> <span class="o">=</span> <span class="n">p2</span><span class="p">.</span><span class="n">Email</span> <span class="k">AND</span> <span class="n">p1</span><span class="p">.</span><span class="n">Id</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="p">.</span><span class="n">Id</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="k">delete</span><span class="o">-</span><span class="n">duplicate</span><span class="o">-</span><span class="n">emails</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>

</code></pre></div></div>

<h3 id="511-æ¸¸æˆç©æ³•åˆ†æ-i"><a href="https://leetcode.cn/problems/game-play-analysis-i/description/">511. æ¸¸æˆç©æ³•åˆ†æ I</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">SELECT</span> <span class="n">player_id</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">)</span> <span class="k">AS</span> <span class="n">first_login</span>  <span class="k">FROM</span> <span class="n">Activity</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">player_id</span><span class="p">;</span> 
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">elect</span> <span class="n">a1</span><span class="p">.</span><span class="n">player_id</span><span class="p">,</span> <span class="k">min</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">event_date</span><span class="p">)</span> <span class="k">as</span> <span class="n">first_login</span>
<span class="k">from</span> <span class="n">Activity</span> <span class="k">as</span> <span class="n">a1</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">a1</span><span class="p">.</span><span class="n">player_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä½¿ç”¨çª—å£å‡½æ•°è¿›è¡Œè§£å†³</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span>
  <span class="n">A</span><span class="p">.</span><span class="n">player_id</span><span class="p">,</span>
  <span class="n">FIRST_VALUE</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">event_date</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span>
    <span class="n">PARTITION</span> <span class="k">BY</span>
      <span class="n">A</span><span class="p">.</span><span class="n">player_id</span>
    <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="n">A</span><span class="p">.</span><span class="n">event_date</span>
  <span class="p">)</span> <span class="k">AS</span> <span class="n">first_login</span>
<span class="k">FROM</span>
  <span class="n">Activity</span> <span class="n">A</span><span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">game</span><span class="o">-</span><span class="n">play</span><span class="o">-</span><span class="n">analysis</span><span class="o">-</span><span class="n">i</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="550-æ¸¸æˆç©æ³•åˆ†æ-iv"><a href="https://leetcode.cn/problems/game-play-analysis-iv/description/">550. æ¸¸æˆç©æ³•åˆ†æ IV</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span>  <span class="n">IFNULL</span><span class="p">(</span>
    <span class="n">ROUND</span><span class="p">(</span>
        <span class="k">COUNT</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">player_id</span><span class="p">)</span> <span class="o">/</span> <span class="k">c</span><span class="p">.</span><span class="n">all_user</span><span class="p">,</span> 
        <span class="mi">2</span>
    <span class="p">),</span> 
    <span class="mi">0</span>
    <span class="p">)</span> <span class="k">AS</span> <span class="n">fraction</span> <span class="k">FROM</span> 
<span class="n">Activity</span> <span class="n">a</span><span class="p">,</span>
<span class="o">#</span> <span class="err">é¦–æ¬¡ç™»é™†æ—¶é—´</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">player_id</span><span class="p">,</span> <span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">)</span> <span class="k">AS</span> <span class="n">frist_date</span> <span class="k">FROM</span> <span class="n">Activity</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">player_id</span><span class="p">)</span> <span class="n">b</span><span class="p">,</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="p">(</span><span class="n">player_id</span><span class="p">))</span>  <span class="k">AS</span> <span class="n">all_user</span> <span class="k">FROM</span>  <span class="n">Activity</span><span class="p">)</span>  <span class="k">c</span>
<span class="k">WHERE</span> <span class="n">a</span><span class="p">.</span><span class="n">player_id</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">player_id</span> <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">event_date</span> <span class="o">=</span> <span class="n">date_add</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">frist_date</span><span class="p">,</span> <span class="n">interval</span> <span class="mi">1</span> <span class="k">day</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>

<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="n">datediff</span><span class="err">ç›´æ¥è¿›è¡Œåˆ¤æ–­</span>
<span class="k">select</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">event_date</span> <span class="k">is</span> <span class="k">null</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span> <span class="n">fraction</span>
<span class="k">from</span> 
    <span class="p">(</span><span class="k">select</span> <span class="n">player_id</span><span class="p">,</span> <span class="k">min</span><span class="p">(</span><span class="n">event_date</span><span class="p">)</span> <span class="k">as</span> <span class="n">login</span>
    <span class="k">from</span> <span class="n">activity</span>
    <span class="k">group</span> <span class="k">by</span> <span class="n">player_id</span><span class="p">)</span> <span class="n">p</span> 
<span class="k">left</span> <span class="k">join</span> <span class="n">activity</span> <span class="n">a</span> 
<span class="k">on</span> <span class="n">p</span><span class="p">.</span><span class="n">player_id</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">player_id</span> <span class="k">and</span> <span class="n">datediff</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">event_date</span><span class="p">,</span> <span class="n">p</span><span class="p">.</span><span class="n">login</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”2ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">æ€è·¯åŸºæœ¬ç›¸åŒ</span>
<span class="k">SELECT</span> 
    <span class="n">IFNULL</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="p">(</span><span class="k">result</span><span class="p">.</span><span class="n">player_id</span><span class="p">))</span> <span class="o">/</span> <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="p">(</span><span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span><span class="p">)),</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> 
    <span class="k">AS</span> <span class="n">fraction</span>
<span class="k">FROM</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span> <span class="k">as</span> <span class="n">player_id</span>
<span class="k">FROM</span> 
<span class="p">(</span><span class="k">SELECT</span> 
    <span class="n">player_id</span><span class="p">,</span>
    <span class="n">DATE_ADD</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">),</span><span class="n">INTERVAL</span> <span class="mi">1</span> <span class="k">DAY</span><span class="p">)</span> <span class="k">AS</span> <span class="n">second_date</span>
<span class="k">FROM</span>
    <span class="n">Activity</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">player_id</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">excepted</span><span class="p">,</span><span class="n">Activity</span>
<span class="k">WHERE</span> <span class="n">Activity</span><span class="p">.</span><span class="n">event_date</span> <span class="o">=</span> <span class="n">excepted</span><span class="p">.</span><span class="n">second_date</span> <span class="k">and</span> <span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span> <span class="o">=</span> <span class="n">excepted</span><span class="p">.</span><span class="n">player_id</span>
<span class="p">)</span> <span class="k">AS</span> <span class="k">result</span><span class="p">,</span><span class="n">Activity</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">IFNULL</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="p">(</span><span class="k">Result</span><span class="p">.</span><span class="n">player_id</span><span class="p">))</span> <span class="o">/</span> <span class="k">count</span><span class="p">(</span><span class="k">distinct</span><span class="p">(</span><span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="k">as</span> <span class="n">fraction</span>
<span class="k">from</span> <span class="p">(</span>
  <span class="k">select</span> <span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span> <span class="k">as</span> <span class="n">player_id</span>
  <span class="k">from</span> <span class="p">(</span>
    <span class="k">select</span> <span class="n">player_id</span><span class="p">,</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="k">MIN</span><span class="p">(</span><span class="n">event_date</span><span class="p">),</span> <span class="n">INTERVAL</span> <span class="mi">1</span> <span class="k">DAY</span><span class="p">)</span> <span class="k">as</span> <span class="n">second_date</span>
    <span class="k">from</span> <span class="n">Activity</span>
    <span class="k">group</span> <span class="k">by</span> <span class="n">player_id</span>
  <span class="p">)</span> <span class="k">as</span> <span class="n">Expected</span><span class="p">,</span> <span class="n">Activity</span>
  <span class="k">where</span> <span class="n">Activity</span><span class="p">.</span><span class="n">event_date</span> <span class="o">=</span> <span class="n">Expected</span><span class="p">.</span><span class="n">second_date</span> <span class="k">and</span> <span class="n">Activity</span><span class="p">.</span><span class="n">player_id</span> <span class="o">=</span> <span class="n">Expected</span><span class="p">.</span><span class="n">player_id</span>
<span class="p">)</span> <span class="k">as</span> <span class="k">Result</span><span class="p">,</span> <span class="n">Activity</span>

<span class="o">#</span> <span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span> <span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">game</span><span class="o">-</span><span class="n">play</span><span class="o">-</span><span class="n">analysis</span><span class="o">-</span><span class="n">iv</span><span class="o">/</span>
<span class="o">#</span> <span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span> <span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="577-å‘˜å·¥å¥–é‡‘"><a href="https://leetcode.cn/problems/employee-bonus/description/">577. å‘˜å·¥å¥–é‡‘</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="k">FROM</span> <span class="n">Employee</span> 
<span class="k">LEFT</span> <span class="k">JOIN</span>  <span class="n">Bonus</span> <span class="k">ON</span> 
    <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span> <span class="o">=</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">empId</span> 
<span class="k">WHERE</span> <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">empId</span> <span class="k">FROM</span> <span class="n">Bonus</span> <span class="k">WHERE</span> <span class="n">bonus</span> <span class="o">&gt;=</span><span class="mi">1000</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">select</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="k">from</span> <span class="n">Employee</span> <span class="k">left</span> <span class="k">join</span> <span class="n">Bonus</span> <span class="k">on</span> <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span><span class="o">=</span><span class="n">Bonus</span><span class="p">.</span><span class="n">empId</span> <span class="k">where</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="o">&lt;</span><span class="mi">1000</span> <span class="k">or</span> <span class="n">bonus</span>  <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">select</span> <span class="n">name</span><span class="p">,</span> <span class="n">bonus</span>
<span class="k">from</span> <span class="n">Employee</span> <span class="k">left</span> <span class="k">join</span> <span class="n">Bonus</span>
<span class="k">on</span> <span class="n">Employee</span><span class="p">.</span><span class="n">EmpId</span> <span class="o">=</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">EmpId</span>
<span class="k">where</span> <span class="n">bonus</span> <span class="k">is</span> <span class="k">null</span> <span class="k">or</span> <span class="n">bonus</span> <span class="o">&lt;</span> <span class="mi">1000</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">employee</span><span class="o">-</span><span class="n">bonus</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="262-è¡Œç¨‹å’Œç”¨æˆ·"><a href="https://leetcode.cn/problems/trips-and-users/description/">262. è¡Œç¨‹å’Œç”¨æˆ·</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="mi">1</span><span class="p">.</span> <span class="err">å…ˆåšå­æŸ¥è¯¢ï¼ŒæŸ¥è¯¢å‡ºéç¦æ­¢ç”¨æˆ·çš„æ‰€æœ‰è®¢å•</span>
<span class="o">#</span> <span class="mi">2</span><span class="p">.</span> <span class="err">å­æŸ¥è¯¢ç»Ÿè®¡ï¼Œæ¯å¤©è®¢å•æ€»æ•°</span><span class="o">/</span><span class="err">å–æ¶ˆè®¢å•æ•°ï¼Œå¤©æ•°</span>
<span class="o">#</span> <span class="mi">3</span><span class="p">.</span> <span class="n">round</span><span class="err">è®¡ç®—å¯¹åº”å€¼</span>

<span class="k">SELECT</span> <span class="n">b</span><span class="p">.</span><span class="n">request_at</span> <span class="k">AS</span> <span class="k">Day</span><span class="p">,</span> <span class="n">IFNULL</span><span class="p">(</span><span class="n">ROUND</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">completed_count</span> <span class="o">/</span><span class="n">b</span><span class="p">.</span><span class="n">completed_count</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="p">)</span> <span class="k">AS</span> <span class="nv">"Cancellation Rate"</span> <span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span>  <span class="n">request_at</span> <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">completed_count</span> <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">status</span><span class="p">,</span> <span class="n">request_at</span>   <span class="k">FROM</span> <span class="n">Trips</span> <span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
            <span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="nv">"Yes"</span>
        <span class="p">)</span> <span class="k">AND</span> <span class="n">driver_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
            <span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="nv">"Yes"</span>
        <span class="p">)</span> <span class="p">)</span> <span class="n">a</span> <span class="k">WHERE</span> <span class="n">request_at</span> <span class="k">between</span>  <span class="nv">"2013-10-01"</span> <span class="k">and</span> <span class="nv">"2013-10-03"</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">request_at</span> 
    <span class="p">)</span> <span class="n">b</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span> 
    <span class="p">(</span>
    <span class="k">SELECT</span>  <span class="n">request_at</span> <span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">completed_count</span> <span class="k">FROM</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">status</span><span class="p">,</span> <span class="n">request_at</span>   <span class="k">FROM</span> <span class="n">Trips</span> <span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
            <span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="nv">"Yes"</span>
        <span class="p">)</span> <span class="k">AND</span> <span class="n">driver_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
            <span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="nv">"Yes"</span>
        <span class="p">)</span> <span class="p">)</span> <span class="n">b</span> <span class="k">WHERE</span> <span class="n">status</span>  <span class="o">!=</span> <span class="nv">"completed"</span> <span class="k">AND</span>  <span class="n">request_at</span> <span class="k">between</span>  <span class="nv">"2013-10-01"</span> <span class="k">and</span> <span class="nv">"2013-10-03"</span>  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">request_at</span> 
    <span class="p">)</span> <span class="k">c</span>  
<span class="k">ON</span> <span class="n">b</span><span class="p">.</span><span class="n">request_at</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">request_at</span> 
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”1ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨</span><span class="k">AVG</span><span class="err">å‡½æ•°ï¼Œç»Ÿè®¡ç‰¹æ®ŠçŠ¶æ€çš„å€¼</span>
<span class="k">SELECT</span> 
    <span class="n">request_at</span> <span class="k">Day</span><span class="p">,</span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="s1">'completed'</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="s1">'Cancellation Rate'</span> 
  <span class="k">FROM</span> 
    <span class="n">Trips</span> 
  <span class="k">WHERE</span> 
      <span class="n">client_id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="s1">'No'</span><span class="p">)</span> 
    <span class="k">AND</span> 
      <span class="n">driver_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">users_id</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">banned</span> <span class="o">=</span> <span class="s1">'No'</span><span class="p">)</span> 
    <span class="k">AND</span> 
      <span class="n">request_at</span> <span class="k">BETWEEN</span> <span class="s1">'2013-10-01'</span> <span class="k">AND</span> <span class="s1">'2013-10-03'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">request_at</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”2ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨äº†</span><span class="n">IF</span> <span class="k">SUM</span> <span class="err">è¿ç®—æ›´å¿«</span>
<span class="k">SELECT</span> <span class="n">T</span><span class="p">.</span><span class="n">request_at</span> <span class="k">AS</span> <span class="nv">`Day`</span><span class="p">,</span> 
<span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">IF</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">STATUS</span> <span class="o">=</span> <span class="s1">'completed'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="nv">`Cancellation Rate`</span>
<span class="k">FROM</span> <span class="n">Trips</span> <span class="k">AS</span> <span class="n">T</span>
<span class="k">JOIN</span> <span class="n">Users</span> <span class="k">AS</span> <span class="n">U1</span> <span class="k">ON</span> <span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">U1</span><span class="p">.</span><span class="n">users_id</span> <span class="k">AND</span> <span class="n">U1</span><span class="p">.</span><span class="n">banned</span> <span class="o">=</span><span class="s1">'No'</span><span class="p">)</span>
<span class="k">JOIN</span> <span class="n">Users</span> <span class="k">AS</span> <span class="n">U2</span> <span class="k">ON</span> <span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">driver_id</span> <span class="o">=</span> <span class="n">U2</span><span class="p">.</span><span class="n">users_id</span> <span class="k">AND</span> <span class="n">U2</span><span class="p">.</span><span class="n">banned</span> <span class="o">=</span><span class="s1">'No'</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">T</span><span class="p">.</span><span class="n">request_at</span> <span class="k">BETWEEN</span> <span class="s1">'2013-10-01'</span> <span class="k">AND</span> <span class="s1">'2013-10-03'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">T</span><span class="p">.</span><span class="n">request_at</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š
æ— </li>
</ul>

<h3 id="570-è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†"><a href="https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/description/">570. è‡³å°‘æœ‰5åç›´æ¥ä¸‹å±çš„ç»ç†</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>

<span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨å­æŸ¥è¯¢</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">managerId</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">managerId</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
<span class="p">);</span>

<span class="o">#</span> <span class="err">ä½¿ç”¨è¿è¡¨æŸ¥è¯¢</span>
<span class="k">SELECT</span> <span class="n">e1</span><span class="p">.</span><span class="n">name</span> <span class="k">FROM</span> 
<span class="n">Employee</span> <span class="n">e1</span> <span class="k">LEFT</span> <span class="k">JOIN</span>  <span class="n">Employee</span> <span class="n">e2</span> <span class="k">ON</span>  <span class="n">e1</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">managerId</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">e1</span><span class="p">.</span><span class="n">id</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">5</span><span class="p">;</span> 

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">select</span>
    <span class="n">m</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">name</span>
<span class="k">from</span> 
    <span class="n">employee</span> <span class="n">e</span> 
<span class="k">join</span> 
    <span class="n">employee</span> <span class="n">m</span> 
<span class="k">on</span> <span class="n">e</span><span class="p">.</span><span class="n">managerId</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span>
<span class="k">group</span> <span class="k">by</span>
    <span class="n">e</span><span class="p">.</span><span class="n">managerId</span>
<span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">5</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Name</span> <span class="k">as</span> <span class="n">Name</span>
<span class="k">from</span> <span class="p">(</span>
  <span class="k">select</span> <span class="n">ManagerId</span> <span class="k">as</span> <span class="n">Id</span>
  <span class="k">from</span> <span class="n">Employee</span>
  <span class="k">group</span> <span class="k">by</span> <span class="n">ManagerId</span>
  <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">Manager</span> <span class="k">join</span> <span class="n">Employee</span>
<span class="k">on</span> <span class="n">Manager</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">.</span><span class="n">Id</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">managers</span><span class="o">-</span><span class="k">with</span><span class="o">-</span><span class="k">at</span><span class="o">-</span><span class="n">least</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">direct</span><span class="o">-</span><span class="n">reports</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="584-å¯»æ‰¾ç”¨æˆ·æ¨èäºº"><a href="https://leetcode.cn/problems/find-customer-referee/description/">584. å¯»æ‰¾ç”¨æˆ·æ¨èäºº</a></h3>

<p><em>å‚è€ƒé“¾æ¥ï¼š</em></p>
<ul>
  <li>
    <p><a href="https://blog.csdn.net/lewky_liu/article/details/103059943">SQL - whereæ¡ä»¶é‡Œçš„!=ä¼šè¿‡æ»¤å€¼ä¸ºnullçš„æ•°æ®</a></p>
  </li>
  <li>
    <p>æäº¤è§£ç­”ï¼š</p>
  </li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">Customer</span>  <span class="k">WHERE</span> <span class="n">referee_id</span> <span class="o">&lt;&gt;</span> <span class="mi">2</span> <span class="k">OR</span> <span class="n">referee_id</span> <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">è¿›è¡Œè¿‡æ»¤ç­›é€‰</span>
<span class="k">select</span> <span class="n">t</span><span class="p">.</span><span class="n">name</span> <span class="k">from</span> <span class="n">Customer</span> <span class="n">t</span> <span class="k">where</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">referee_id</span><span class="o">!=</span><span class="mi">2</span> <span class="k">or</span> <span class="n">t</span><span class="p">.</span><span class="n">referee_id</span> <span class="k">is</span> <span class="k">null</span><span class="p">)</span>
<span class="o">#</span> <span class="err">è¿›è¡Œå¯¹åº”çš„è¿‡æ»¤ç­›é€‰</span>
<span class="k">select</span> <span class="n">name</span> <span class="k">from</span> <span class="n">Customer</span> <span class="k">where</span> <span class="n">referee_id</span> <span class="o">!=</span> <span class="mi">2</span> <span class="k">or</span> <span class="n">referee_id</span> <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">customer</span> <span class="k">WHERE</span> <span class="n">referee_id</span> <span class="o">!=</span> <span class="mi">2</span> <span class="k">OR</span> <span class="n">referee_id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="ç»Ÿè®¡ç”¨æˆ·æ¯å¤©ç™»é™†æ—¶é•¿"><a href="https://zhuanlan.zhihu.com/p/358887348">ç»Ÿè®¡ç”¨æˆ·æ¯å¤©ç™»é™†æ—¶é•¿</a></h3>

<h3 id="577å‘˜å·¥å¥–é‡‘"><a href="https://leetcode.cn/problems/employee-bonus/description/">577.å‘˜å·¥å¥–é‡‘</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ç›´æ¥åå‘å–æ•°å³å¯</span>
<span class="k">SELECT</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">LEFT</span> <span class="k">JOIN</span>  <span class="n">Bonus</span> <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span> <span class="o">=</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">empId</span> <span class="k">WHERE</span> <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">empId</span> <span class="k">FROM</span> <span class="n">Bonus</span> <span class="k">WHERE</span> <span class="n">bonus</span> <span class="o">&gt;=</span><span class="mi">1000</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”(å®˜æ–¹é¢˜è§£)ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨</span><span class="k">null</span><span class="err">è¿‡æ»¤</span>
<span class="k">select</span> <span class="n">Employee</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="k">from</span> <span class="n">Employee</span> <span class="k">left</span> <span class="k">join</span> <span class="n">Bonus</span> <span class="k">on</span> <span class="n">Employee</span><span class="p">.</span><span class="n">empId</span><span class="o">=</span><span class="n">Bonus</span><span class="p">.</span><span class="n">empId</span> <span class="k">where</span> <span class="n">Bonus</span><span class="p">.</span><span class="n">bonus</span> <span class="o">&lt;</span><span class="mi">1000</span> <span class="k">or</span> <span class="n">bonus</span>  <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="585-2016å¹´çš„æŠ•èµ„"><a href="https://leetcode.cn/problems/investments-in-2016/">585. 2016å¹´çš„æŠ•èµ„</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>


<span class="o">#</span> <span class="err">ä¿ç•™ä¸¤ä½å°æ•°</span>
<span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">tiv_2016</span><span class="p">),</span><span class="mi">2</span> <span class="p">)</span> <span class="k">AS</span> <span class="n">tiv_2016</span> <span class="k">FROM</span> <span class="n">Insurance</span> 
<span class="k">WHERE</span> <span class="n">pid</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="o">#</span> <span class="err">æ¡ä»¶</span><span class="mi">1</span>
    <span class="k">SELECT</span>  <span class="n">a</span><span class="p">.</span><span class="n">pid</span> <span class="k">FROM</span> <span class="n">Insurance</span> <span class="n">a</span><span class="p">,</span> <span class="n">Insurance</span> <span class="n">b</span> <span class="k">WHERE</span> <span class="n">a</span><span class="p">.</span><span class="n">pid</span> <span class="o">!=</span> <span class="n">b</span><span class="p">.</span><span class="n">pid</span>  <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">tiv_2015</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">tiv_2015</span><span class="p">)</span> 
<span class="k">AND</span> <span class="n">pid</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="o">#</span> <span class="err">æ¡ä»¶</span><span class="mi">2</span>
    <span class="k">SELECT</span>  <span class="n">a</span><span class="p">.</span><span class="n">pid</span> <span class="k">FROM</span> <span class="n">Insurance</span> <span class="n">a</span><span class="p">,</span> <span class="n">Insurance</span> <span class="n">b</span> <span class="k">WHERE</span> <span class="n">a</span><span class="p">.</span><span class="n">pid</span> <span class="o">!=</span> <span class="n">b</span><span class="p">.</span><span class="n">pid</span> <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">lat</span> <span class="k">AND</span> <span class="n">a</span><span class="p">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">lon</span>
<span class="p">);</span>



<span class="o">#</span> <span class="err">ä¿ç•™ä¸¤ä½å°æ•°</span>
<span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">tiv_2016</span><span class="p">),</span><span class="mi">2</span> <span class="p">)</span> <span class="k">AS</span> <span class="n">tiv_2016</span> 
<span class="k">FROM</span> <span class="n">Insurance</span> 
<span class="k">WHERE</span>  <span class="n">tiv_2015</span>  <span class="k">IN</span> <span class="p">(</span>
    <span class="o">#</span> <span class="err">è‡³å°‘ä¸€ç›¸åŒ</span>
    <span class="k">SELECT</span> <span class="n">tiv_2015</span>  <span class="k">FROM</span> <span class="n">Insurance</span>  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">tiv_2015</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="p">)</span> 
<span class="k">AND</span> <span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="k">FROM</span> <span class="n">Insurance</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">lat</span><span class="p">,</span><span class="n">lon</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="n">partition</span> <span class="err">ç›´æ¥ç»Ÿè®¡æ•°é‡</span>
<span class="k">select</span> <span class="n">round</span><span class="p">(</span> <span class="k">sum</span><span class="p">(</span><span class="n">tiv_2016</span><span class="p">)</span> <span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="n">tiv_2016</span>
<span class="k">from</span><span class="p">(</span>
    <span class="k">select</span> <span class="o">*</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">over</span><span class="p">(</span><span class="n">partition</span> <span class="k">by</span> <span class="n">tiv_2015</span><span class="p">)</span> <span class="n">c1</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">over</span><span class="p">(</span><span class="n">partition</span> <span class="k">by</span> <span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">)</span> <span class="n">c2</span>
    <span class="k">from</span> <span class="n">Insurance</span>
<span class="p">)</span> <span class="n">t1</span>
<span class="k">where</span> <span class="n">t1</span><span class="p">.</span><span class="n">c1</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">t1</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span> 
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">SELECT</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">insurance</span><span class="p">.</span><span class="n">TIV_2016</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TIV_2016</span>
<span class="k">FROM</span>
    <span class="n">insurance</span>
<span class="k">WHERE</span>
    <span class="n">insurance</span><span class="p">.</span><span class="n">TIV_2015</span> <span class="k">IN</span>
    <span class="p">(</span>
      <span class="k">SELECT</span>
        <span class="n">TIV_2015</span>
      <span class="k">FROM</span>
        <span class="n">insurance</span>
      <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">TIV_2015</span>
      <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="k">AND</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span> <span class="k">IN</span>
    <span class="p">(</span>
      <span class="k">SELECT</span>
        <span class="n">CONCAT</span><span class="p">(</span><span class="n">LAT</span><span class="p">,</span> <span class="n">LON</span><span class="p">)</span>
      <span class="k">FROM</span>
        <span class="n">insurance</span>
      <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">LAT</span> <span class="p">,</span> <span class="n">LON</span>
      <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">##</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="586-è®¢å•æœ€å¤šçš„å®¢æˆ·"><a href="https://leetcode.cn/problems/customer-placing-the-largest-number-of-orders/description/">586. è®¢å•æœ€å¤šçš„å®¢æˆ·</a></h3>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">SELECT</span> <span class="n">customer_number</span> <span class="k">FROM</span> <span class="n">Orders</span> <span class="k">GROUP</span> <span class="k">bY</span> <span class="n">customer_number</span> <span class="k">ORDER</span> <span class="k">BY</span>  <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä¸ä½¿ç”¨</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="err">ç›´æ¥æŒ‡æ˜å­—æ®µï¼Œæå‡äº†é€Ÿåº¦</span>
<span class="k">select</span>  <span class="n">customer_number</span>
<span class="k">from</span> <span class="n">Orders</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">customer_number</span>
<span class="k">order</span> <span class="k">by</span> <span class="k">count</span><span class="p">(</span><span class="n">customer_number</span><span class="p">)</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">1</span>


<span class="o">##</span>  <span class="err">ä½¿ç”¨å­æŸ¥è¯¢</span>
<span class="k">select</span> <span class="n">cn</span> <span class="n">customer_number</span> 
<span class="k">from</span> <span class="p">(</span>
    <span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">customer_number</span><span class="p">)</span> <span class="n">cc</span><span class="p">,</span> <span class="n">customer_number</span> <span class="n">cn</span>
    <span class="k">from</span> <span class="n">Orders</span>
    <span class="k">group</span> <span class="k">by</span> <span class="n">customer_number</span>
<span class="p">)</span> <span class="n">T</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">T</span><span class="p">.</span><span class="n">cc</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">customer_number</span>
<span class="k">FROM</span>
    <span class="n">orders</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">customer_number</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">1</span>
<span class="p">;</span>

<span class="o">#</span> <span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span> <span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">customer</span><span class="o">-</span><span class="k">placing</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">largest</span><span class="o">-</span><span class="n">number</span><span class="o">-</span><span class="k">of</span><span class="o">-</span><span class="n">orders</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">2366301</span><span class="o">/</span><span class="n">ding</span><span class="o">-</span><span class="n">dan</span><span class="o">-</span><span class="n">zui</span><span class="o">-</span><span class="n">duo</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">ke</span><span class="o">-</span><span class="n">hu</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetcode</span><span class="o">-</span><span class="n">so</span><span class="o">-</span><span class="n">bywe</span><span class="o">/</span>
<span class="o">#</span> <span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span> <span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="595-å¤§çš„å›½å®¶"><a href="https://leetcode.cn/problems/big-countries/description/">595. å¤§çš„å›½å®¶</a></h3>

<p>World è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| name        | varchar |
| continent   | varchar |
| area        | int     |
| population  | int     |
| gdp         | bigint  |
+-------------+---------+
</code></pre></div></div>

<p>name æ˜¯è¯¥è¡¨çš„ä¸»é”®ï¼ˆå…·æœ‰å”¯ä¸€å€¼çš„åˆ—ï¼‰ã€‚
è¿™å¼ è¡¨çš„æ¯ä¸€è¡Œæä¾›ï¼šå›½å®¶åç§°ã€æ‰€å±å¤§é™†ã€é¢ç§¯ã€äººå£å’Œ GDP å€¼ã€‚</p>

<p>å¦‚æœä¸€ä¸ªå›½å®¶æ»¡è¶³ä¸‹è¿°ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼Œåˆ™è®¤ä¸ºè¯¥å›½æ˜¯ å¤§å›½ ï¼š</p>

<p>é¢ç§¯è‡³å°‘ä¸º 300 ä¸‡å¹³æ–¹å…¬é‡Œï¼ˆå³ï¼Œ3000000 km2ï¼‰ï¼Œæˆ–è€…
äººå£è‡³å°‘ä¸º 2500 ä¸‡ï¼ˆå³ 25000000ï¼‰
ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡º å¤§å›½ çš„å›½å®¶åç§°ã€äººå£å’Œé¢ç§¯ã€‚</p>

<p>æŒ‰ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">area</span> <span class="k">FROM</span> <span class="n">World</span> <span class="k">WHERE</span> <span class="n">population</span> <span class="o">&gt;=</span> <span class="mi">25000000</span> <span class="k">OR</span> <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">3000000</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">select</span> <span class="n">name</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">area</span>
<span class="k">from</span> <span class="n">World</span>
<span class="k">where</span> <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">3000000</span> <span class="k">or</span> <span class="n">population</span> <span class="o">&gt;=</span><span class="mi">25000000</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">name</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">area</span>
<span class="k">FROM</span>
    <span class="n">world</span>
<span class="k">WHERE</span>
    <span class="n">area</span> <span class="o">&gt;=</span> <span class="mi">3000000</span> <span class="k">OR</span> <span class="n">population</span> <span class="o">&gt;=</span> <span class="mi">25000000</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">big</span><span class="o">-</span><span class="n">countries</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">2366084</span><span class="o">/</span><span class="n">big</span><span class="o">-</span><span class="n">countries</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetcode</span><span class="o">-</span><span class="n">solution</span><span class="o">-</span><span class="mi">8</span><span class="n">k13</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="596-è¶…è¿‡5åå­¦ç”Ÿçš„è¯¾"><a href="https://leetcode.cn/problems/classes-more-than-5-students/description/">596. è¶…è¿‡5åå­¦ç”Ÿçš„è¯¾</a></h3>

<p>è¡¨: Courses</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| student     | varchar |
| class       | varchar |
+-------------+---------+
</code></pre></div></div>

<p>åœ¨ SQL ä¸­ï¼Œ(student, class)æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºå­¦ç”Ÿçš„åå­—å’Œä»–ä»¬æ³¨å†Œçš„ç­çº§ã€‚</p>

<p>æŸ¥è¯¢ è‡³å°‘æœ‰5ä¸ªå­¦ç”Ÿ çš„æ‰€æœ‰ç­çº§ã€‚</p>

<p>ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>ç¤ºä¾‹ 1:</p>

<p>è¾“å…¥:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Courses table:
+---------+----------+
| student | class    |
+---------+----------+
| A       | Math     |
| B       | English  |
| C       | Math     |
| D       | Biology  |
| E       | Math     |
| F       | Computer |
| G       | Math     |
| H       | Math     |
| I       | Math     |
+---------+----------+
</code></pre></div></div>

<p>è¾“å‡º:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------+ 
| class   | 
+---------+ 
| Math    | 
+---------+
</code></pre></div></div>

<p>è§£é‡Š: 
-æ•°å­¦è¯¾æœ‰6ä¸ªå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬åŒ…æ‹¬å®ƒã€‚
-è‹±è¯­è¯¾æœ‰1åå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚
-ç”Ÿç‰©è¯¾æœ‰1åå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚
-è®¡ç®—æœºè¯¾æœ‰1ä¸ªå­¦ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åŒ…æ‹¬å®ƒã€‚</p>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä¸»è¦æ€è·¯ç›´æ¥ä½¿ç”¨</span><span class="k">GROUP</span> <span class="err">å’Œ</span><span class="k">having</span><span class="err">è¿›è¡Œè§£å†³</span>
<span class="k">SELECT</span> <span class="k">class</span> <span class="k">FROM</span> <span class="n">Courses</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">class</span> <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">()</span> <span class="o">&gt;=</span><span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">select</span>
    <span class="k">class</span>
<span class="k">From</span>
    <span class="n">Courses</span>
<span class="k">group</span> <span class="k">by</span> 
    <span class="k">class</span>
<span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="n">student</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">##</span> <span class="err">ä½¿ç”¨å­æŸ¥è¯¢å¯¹æ¯ä¸ªç­çº§çš„å­¦ç”Ÿè¿›è¡Œç»Ÿè®¡</span>
<span class="o">##</span> <span class="err">ç»Ÿè®¡å®Œæˆåæ‰§è¡Œè¿‡æ»¤</span>
<span class="k">SELECT</span>
    <span class="k">class</span>
<span class="k">FROM</span>
    <span class="p">(</span><span class="k">SELECT</span>
        <span class="k">class</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">student</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num</span>
    <span class="k">FROM</span>
        <span class="n">courses</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="k">class</span><span class="p">)</span> <span class="k">AS</span> <span class="n">temp_table</span>
<span class="k">WHERE</span>
    <span class="n">num</span> <span class="o">&gt;=</span> <span class="mi">5</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">classes</span><span class="o">-</span><span class="k">more</span><span class="o">-</span><span class="k">than</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">students</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">2366294</span><span class="o">/</span><span class="n">chao</span><span class="o">-</span><span class="n">guo</span><span class="o">-</span><span class="mi">5</span><span class="n">ming</span><span class="o">-</span><span class="n">xue</span><span class="o">-</span><span class="n">sheng</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">ke</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetco</span><span class="o">-</span><span class="n">l4es</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="602-å¥½å‹ç”³è¯·-ii-è°æœ‰æœ€å¤šçš„å¥½å‹httpsleetcodecnproblemsfriend-reqz">[602. å¥½å‹ç”³è¯· II ï¼šè°æœ‰æœ€å¤šçš„å¥½å‹](https://leetcode.cn/problems/friend-reqz</h3>

<p>RequestAccepted è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----------------+---------+
| Column Name    | Type    |
+----------------+---------+
| requester_id   | int     |
| accepter_id    | int     |
| accept_date    | date    |
+----------------+---------+
</code></pre></div></div>

<p>(requester_id, accepter_id) æ˜¯è¿™å¼ è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ)ã€‚
è¿™å¼ è¡¨åŒ…å«å‘é€å¥½å‹è¯·æ±‚çš„äººçš„ ID ï¼Œæ¥æ”¶å¥½å‹è¯·æ±‚çš„äººçš„ ID ï¼Œä»¥åŠå¥½å‹è¯·æ±‚é€šè¿‡çš„æ—¥æœŸã€‚</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ‹¥æœ‰æœ€å¤šçš„å¥½å‹çš„äººå’Œä»–æ‹¥æœ‰çš„å¥½å‹æ•°ç›®ã€‚</p>

<p>ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹ä¿è¯æ‹¥æœ‰æœ€å¤šå¥½å‹æ•°ç›®çš„åªæœ‰ 1 ä¸ªäººã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p>ç¤ºä¾‹ 1ï¼š</p>

<p>è¾“å…¥ï¼š
RequestAccepted è¡¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+--------------+-------------+-------------+
| requester_id | accepter_id | accept_date |
+--------------+-------------+-------------+
| 1            | 2           | 2016/06/03  |
| 1            | 3           | 2016/06/08  |
| 2            | 3           | 2016/06/08  |
| 3            | 4           | 2016/06/09  |
+--------------+-------------+-------------+
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-----+
| id | num |
+----+-----+
| 3  | 3   |
+----+-----+
</code></pre></div></div>

<p>è§£é‡Šï¼š
ç¼–å·ä¸º 3 çš„äººæ˜¯ç¼–å·ä¸º 1 ï¼Œ2 å’Œ 4 çš„äººçš„å¥½å‹ï¼Œæ‰€ä»¥ä»–æ€»å…±æœ‰ 3 ä¸ªå¥½å‹ï¼Œæ¯”å…¶ä»–äººéƒ½å¤šã€‚</p>

<p>è¿›é˜¶ï¼šåœ¨çœŸå®ä¸–ç•Œé‡Œï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªäººæ‹¥æœ‰å¥½å‹æ•°ç›¸åŒä¸”æœ€å¤šï¼Œä½ èƒ½æ‰¾åˆ°æ‰€æœ‰è¿™äº›äººå—ï¼Ÿ</p>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">##</span> <span class="err">ä¸»è¦æ€è·¯</span>
<span class="o">#</span> <span class="err">å…ˆåˆ†åˆ«ç»Ÿè®¡ä½œä¸ºå‘é€è€…å’Œæ¥æ”¶è€…çš„å­è¡¨ï¼Œå†è¿›è¡Œåˆå¹¶ç»Ÿè®¡</span>
<span class="o">#</span> <span class="err">æ³¨æ„è¿™é‡Œä½¿ç”¨</span> <span class="k">UNION</span> <span class="k">ALL</span> <span class="err">è¿›è¡Œä¸¤å¼ è¡¨çš„åˆå¹¶</span>
<span class="k">SELECT</span> <span class="k">user</span> <span class="k">AS</span> <span class="n">id</span> <span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="k">count</span><span class="p">)</span>  <span class="k">AS</span> <span class="n">num</span>   <span class="k">FROM</span> 
<span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">accepter_id</span> <span class="k">AS</span> <span class="k">user</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="k">count</span> <span class="k">FROM</span> <span class="n">RequestAccepted</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">accepter_id</span>
    <span class="k">union</span> 
    <span class="k">SELECT</span>  <span class="n">requester_id</span> <span class="k">AS</span> <span class="k">user</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="k">count</span> <span class="k">FROM</span> <span class="n">RequestAccepted</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">requester_id</span>
<span class="p">)</span> <span class="k">c</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">id</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">num</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨</span><span class="k">union</span> <span class="err">ä¸ç»„åˆ</span><span class="k">group</span><span class="err">ï¼Œ</span> <span class="err">è¿›è¡Œäº†ç»Ÿä¸€å»é‡</span>
<span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num</span> <span class="k">from</span> <span class="p">(</span>
    <span class="k">select</span> <span class="n">r</span><span class="p">.</span><span class="n">requester_id</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span> <span class="n">accepter_id</span> <span class="k">as</span> <span class="n">sid</span><span class="p">,</span> <span class="n">accept_date</span> <span class="k">from</span> <span class="n">requestaccepted</span> <span class="n">r</span> <span class="k">group</span> <span class="k">by</span> <span class="n">id</span><span class="p">,</span> <span class="n">sid</span>
    <span class="k">union</span> 
    <span class="p">(</span>   
        <span class="o">#</span> <span class="err">è¿™ä¸ªå­æŸ¥è¯¢å·§å¦™çš„å°†åˆ—è¿›è¡Œäº†è½¬æ¢</span> 
        <span class="k">select</span> <span class="n">t</span><span class="p">.</span><span class="n">accepter_id</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span> <span class="n">requester_id</span> <span class="k">as</span> <span class="n">sid</span><span class="p">,</span> <span class="n">accept_date</span> <span class="k">from</span> <span class="n">requestaccepted</span> <span class="n">t</span> <span class="k">group</span> <span class="k">by</span> <span class="n">id</span><span class="p">,</span> <span class="n">sid</span><span class="p">)</span>
<span class="p">)</span> <span class="n">tmp</span> <span class="k">group</span> <span class="k">by</span> <span class="n">id</span> <span class="k">order</span> <span class="k">by</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">desc</span> <span class="k">limit</span> <span class="mi">1</span>

<span class="o">#</span> <span class="err">æ€è·¯ç›¸åŒ</span>
<span class="k">select</span> <span class="n">id</span><span class="p">,</span> <span class="n">num</span> <span class="k">from</span>
<span class="p">(</span><span class="k">select</span> <span class="n">pid</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span> <span class="k">as</span> <span class="n">num</span> <span class="k">from</span>
    <span class="p">(</span><span class="k">select</span> <span class="n">accepter_id</span> <span class="k">as</span> <span class="n">pid</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">cnt</span> <span class="k">from</span> <span class="n">request_accepted</span> <span class="k">group</span> <span class="k">by</span> <span class="n">accepter_id</span>
    <span class="k">union</span> <span class="k">all</span>
    <span class="k">select</span> <span class="n">requester_id</span> <span class="k">as</span> <span class="n">pid</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">cnt</span> <span class="k">from</span> <span class="n">request_accepted</span> <span class="k">group</span> <span class="k">by</span> <span class="n">requester_id</span><span class="p">)</span> <span class="n">t1</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">pid</span><span class="p">)</span> <span class="n">t2</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">num</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>

<span class="o">#</span> <span class="err">æ€è·¯ç›¸åŒï¼Œä»£ç æ›´åŠ ç®€æ´</span>
<span class="k">select</span> <span class="n">t1</span><span class="p">.</span><span class="n">ids</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num</span>
<span class="k">from</span><span class="p">(</span>
        <span class="k">select</span> <span class="n">requester_id</span> <span class="k">as</span> <span class="n">ids</span> <span class="k">from</span> <span class="n">RequestAccepted</span> 
        <span class="k">union</span> <span class="k">all</span>
        <span class="k">select</span> <span class="n">accepter_id</span> <span class="k">as</span> <span class="n">ids</span> <span class="k">from</span> <span class="n">RequestAccepted</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">t1</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">id</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">num</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">ids</span> <span class="k">as</span> <span class="n">id</span><span class="p">,</span> <span class="n">cnt</span> <span class="k">as</span> <span class="n">num</span>
<span class="k">from</span>
<span class="p">(</span>
<span class="k">select</span> <span class="n">ids</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">cnt</span>
   <span class="k">from</span>
   <span class="p">(</span>
        <span class="k">select</span> <span class="n">requester_id</span> <span class="k">as</span> <span class="n">ids</span> <span class="k">from</span> <span class="n">request_accepted</span>
        <span class="k">union</span> <span class="k">all</span>
        <span class="k">select</span> <span class="n">accepter_id</span> <span class="k">from</span> <span class="n">request_accepted</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">tbl1</span>
   <span class="k">group</span> <span class="k">by</span> <span class="n">ids</span>
   <span class="p">)</span> <span class="k">as</span> <span class="n">tbl2</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">cnt</span> <span class="k">desc</span>
<span class="k">limit</span> <span class="mi">1</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">friend</span><span class="o">-</span><span class="n">requests</span><span class="o">-</span><span class="n">ii</span><span class="o">-</span><span class="n">who</span><span class="o">-</span><span class="n">has</span><span class="o">-</span><span class="n">the</span><span class="o">-</span><span class="n">most</span><span class="o">-</span><span class="n">friends</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">23104</span><span class="o">/</span><span class="n">hao</span><span class="o">-</span><span class="n">you</span><span class="o">-</span><span class="n">shen</span><span class="o">-</span><span class="n">qing</span><span class="o">-</span><span class="n">ii</span><span class="o">-</span><span class="n">shui</span><span class="o">-</span><span class="n">you</span><span class="o">-</span><span class="n">zui</span><span class="o">-</span><span class="n">duo</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">hao</span><span class="o">-</span><span class="n">you</span><span class="o">-</span><span class="n">b</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="607-é”€å”®å‘˜"><a href="https://leetcode.cn/problems/sales-person/description/">607. é”€å”®å‘˜</a></h3>

<p>è¡¨: SalesPerson</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-----------------+---------+
| Column Name     | Type    |
+-----------------+---------+
| sales_id        | int     |
| name            | varchar |
| salary          | int     |
| commission_rate | int     |
| hire_date       | date    |
+-----------------+---------+
</code></pre></div></div>

<p>sales_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºäº†é”€å”®äººå‘˜çš„å§“åå’Œ ID ï¼Œä»¥åŠä»–ä»¬çš„å·¥èµ„ã€ä½£é‡‘ç‡å’Œé›‡ä½£æ—¥æœŸã€‚</p>

<p>è¡¨: Company</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| com_id      | int     |
| name        | varchar |
| city        | varchar |
+-------------+---------+
</code></pre></div></div>

<p>com_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºå…¬å¸çš„åç§°å’Œ ID ï¼Œä»¥åŠå…¬å¸æ‰€åœ¨çš„åŸå¸‚ã€‚</p>

<p>è¡¨: Orders</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------+------+
| Column Name | Type |
+-------------+------+
| order_id    | int  |
| order_date  | date |
| com_id      | int  |
| sales_id    | int  |
| amount      | int  |
+-------------+------+
</code></pre></div></div>

<p>order_id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ—(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
com_id æ˜¯ Company è¡¨ä¸­ com_id çš„å¤–é”®ï¼ˆreference åˆ—ï¼‰ã€‚
sales_id æ˜¯æ¥è‡ªé”€å”®å‘˜è¡¨ sales_id çš„å¤–é”®ï¼ˆreference åˆ—ï¼‰ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€ä¸ªè®¢å•çš„ä¿¡æ¯ã€‚è¿™åŒ…æ‹¬å…¬å¸çš„ ID ã€é”€å”®äººå‘˜çš„ ID ã€è®¢å•æ—¥æœŸå’Œæ”¯ä»˜çš„é‡‘é¢ã€‚</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ²¡æœ‰ä»»ä½•ä¸åä¸º â€œREDâ€ çš„å…¬å¸ç›¸å…³çš„è®¢å•çš„æ‰€æœ‰é”€å”®äººå‘˜çš„å§“åã€‚</p>

<p>ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>ç¤ºä¾‹ 1ï¼š</p>

<p>è¾“å…¥ï¼š
SalesPerson è¡¨:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----------+------+--------+-----------------+------------+
| sales_id | name | salary | commission_rate | hire_date  |
+----------+------+--------+-----------------+------------+
| 1        | John | 100000 | 6               | 4/1/2006   |
| 2        | Amy  | 12000  | 5               | 5/1/2010   |
| 3        | Mark | 65000  | 12              | 12/25/2008 |
| 4        | Pam  | 25000  | 25              | 1/1/2005   |
| 5        | Alex | 5000   | 10              | 2/3/2007   |
+----------+------+--------+-----------------+------------+
</code></pre></div></div>

<p>Company è¡¨:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+--------+--------+----------+
| com_id | name   | city     |
+--------+--------+----------+
| 1      | RED    | Boston   |
| 2      | ORANGE | New York |
| 3      | YELLOW | Boston   |
| 4      | GREEN  | Austin   |
+--------+--------+----------+
</code></pre></div></div>

<p>Orders è¡¨:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----------+------------+--------+----------+--------+
| order_id | order_date | com_id | sales_id | amount |
+----------+------------+--------+----------+--------+
| 1        | 1/1/2014   | 3      | 4        | 10000  |
| 2        | 2/1/2014   | 4      | 5        | 5000   |
| 3        | 3/1/2014   | 1      | 1        | 50000  |
| 4        | 4/1/2014   | 1      | 4        | 25000  |
+----------+------------+--------+----------+--------+
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------+
| name |
+------+
| Amy  |
| Mark |
| Alex |
+------+
</code></pre></div></div>

<p>è§£é‡Šï¼š
æ ¹æ®è¡¨ orders ä¸­çš„è®¢å• â€˜3â€™ å’Œ â€˜4â€™ ï¼Œå®¹æ˜“çœ‹å‡ºåªæœ‰ â€˜Johnâ€™ å’Œ â€˜Pamâ€™ ä¸¤ä¸ªé”€å”®å‘˜æ›¾ç»å‘å…¬å¸ â€˜REDâ€™ é”€å”®è¿‡ã€‚
æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¾“å‡ºè¡¨ salesperson ä¸­æ‰€æœ‰å…¶ä»–äººçš„åå­—ã€‚</p>

<ul>
  <li>æäº¤è§£ç­”:</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">æŒ‰ç…§å…¬å¸å’Œè®¢å•æ‰¾å‡ºç›¸å…³çš„é”€å”®å‘˜</span><span class="n">ID</span>
<span class="o">#</span> <span class="err">æœ€åä½¿ç”¨</span><span class="k">not</span> <span class="k">in</span> <span class="err">æ’é™¤å³å¯</span>

<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">SalesPerson</span> <span class="k">WHERE</span> <span class="n">sales_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span><span class="p">(</span><span class="n">sales_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">sales_id</span> 
    <span class="k">FROM</span>  <span class="n">Orders</span> 
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">Company</span> <span class="k">ON</span> <span class="n">Orders</span><span class="p">.</span><span class="n">com_id</span> <span class="o">=</span>  <span class="n">Company</span><span class="p">.</span><span class="n">com_id</span> 
<span class="k">WHERE</span> <span class="n">Company</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="nv">"RED"</span>
<span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">#</span> <span class="err">ä»£ç æ›´åŠ ç®€æ´ï¼Œå–æ¶ˆäº†å·¦è¿æ¥</span>
<span class="k">SELECT</span>
    <span class="n">name</span>
<span class="k">FROM</span> <span class="n">SalesPerson</span> 
<span class="k">WHERE</span> <span class="n">sales_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">sales_id</span>
    <span class="k">FROM</span> <span class="n">Orders</span>
    <span class="k">WHERE</span> <span class="n">com_id</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">com_id</span> 
        <span class="k">FROM</span> <span class="n">Company</span> 
        <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'RED'</span>
    <span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">s</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span>
    <span class="n">salesperson</span> <span class="n">s</span>
<span class="k">WHERE</span>
    <span class="n">s</span><span class="p">.</span><span class="n">sales_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span>
            <span class="n">o</span><span class="p">.</span><span class="n">sales_id</span>
        <span class="k">FROM</span>
            <span class="n">orders</span> <span class="n">o</span>
                <span class="k">LEFT</span> <span class="k">JOIN</span>
            <span class="n">company</span> <span class="k">c</span> <span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">com_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">com_id</span>
        <span class="k">WHERE</span>
            <span class="k">c</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'RED'</span><span class="p">)</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼šåŠ›æ‰£å®˜æ–¹é¢˜è§£</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">sales</span><span class="o">-</span><span class="n">person</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">2366337</span><span class="o">/</span><span class="n">xiao</span><span class="o">-</span><span class="n">shou</span><span class="o">-</span><span class="n">yuan</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetcode</span><span class="o">-</span><span class="n">solution</span><span class="o">-</span><span class="n">wg7i</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="601ä½“è‚²é¦†çš„äººæµé‡"><a href="https://leetcode.cn/problems/human-traffic-of-stadium/description/">601.ä½“è‚²é¦†çš„äººæµé‡</a></h3>

<p>è¡¨ï¼šStadium</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| visit_date    | date    |
| people        | int     |
+---------------+---------+
</code></pre></div></div>
<p>visit_date æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
æ¯æ—¥äººæµé‡ä¿¡æ¯è¢«è®°å½•åœ¨è¿™ä¸‰åˆ—ä¿¡æ¯ä¸­ï¼šåºå· (id)ã€æ—¥æœŸ (visit_date)ã€ äººæµé‡ (people)
æ¯å¤©åªæœ‰ä¸€è¡Œè®°å½•ï¼Œæ—¥æœŸéšç€ id çš„å¢åŠ è€Œå¢åŠ </p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ‰¾å‡ºæ¯è¡Œçš„äººæ•°å¤§äºæˆ–ç­‰äº 100 ä¸” id è¿ç»­çš„ä¸‰è¡Œæˆ–æ›´å¤šè¡Œè®°å½•ã€‚</p>

<p>è¿”å›æŒ‰ visit_date å‡åºæ’åˆ— çš„ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>ç¤ºä¾‹ 1:</p>

<p>è¾“å…¥ï¼š
Stadium è¡¨:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------+------------+-----------+
| id   | visit_date | people    |
+------+------------+-----------+
| 1    | 2017-01-01 | 10        |
| 2    | 2017-01-02 | 109       |
| 3    | 2017-01-03 | 150       |
| 4    | 2017-01-04 | 99        |
| 5    | 2017-01-05 | 145       |
| 6    | 2017-01-06 | 1455      |
| 7    | 2017-01-07 | 199       |
| 8    | 2017-01-09 | 188       |
+------+------------+-----------+
</code></pre></div></div>
<p>è¾“å‡ºï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------+------------+-----------+
| id   | visit_date | people    |
+------+------------+-----------+
| 5    | 2017-01-05 | 145       |
| 6    | 2017-01-06 | 1455      |
| 7    | 2017-01-07 | 199       |
| 8    | 2017-01-09 | 188       |
+------+------------+-----------+
</code></pre></div></div>
<p>è§£é‡Šï¼š
id ä¸º 5ã€6ã€7ã€8 çš„å››è¡Œ id è¿ç»­ï¼Œå¹¶ä¸”æ¯è¡Œéƒ½æœ‰ &gt;= 100 çš„äººæ•°è®°å½•ã€‚
è¯·æ³¨æ„ï¼Œå³ä½¿ç¬¬ 7 è¡Œå’Œç¬¬ 8 è¡Œçš„ visit_date ä¸æ˜¯è¿ç»­çš„ï¼Œè¾“å‡ºä¹Ÿåº”å½“åŒ…å«ç¬¬ 8 è¡Œï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦è€ƒè™‘ id è¿ç»­çš„è®°å½•ã€‚
ä¸è¾“å‡º id ä¸º 2 å’Œ 3 çš„è¡Œï¼Œå› ä¸ºè‡³å°‘éœ€è¦ä¸‰æ¡ id è¿ç»­çš„è®°å½•ã€‚</p>

<ul>
  <li>æäº¤è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ç›´æ¥ä½¿ç”¨è¿è¡¨æŸ¥è¯¢</span>
<span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">l1</span><span class="p">.</span><span class="o">*</span>
<span class="k">FROM</span>
    <span class="n">Stadium</span> <span class="n">l1</span><span class="p">,</span>
    <span class="n">Stadium</span> <span class="n">l2</span><span class="p">,</span>
    <span class="n">Stadium</span> <span class="n">l3</span>
<span class="k">WHERE</span>
    <span class="n">l1</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span>
    <span class="k">AND</span> <span class="n">l2</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span>
    <span class="k">AND</span> <span class="n">l3</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span>
    <span class="k">AND</span> <span class="p">(</span>
        <span class="p">(</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span> <span class="o">=</span> <span class="n">l2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">l3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> 
        <span class="k">OR</span> <span class="p">(</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span><span class="o">+</span><span class="mi">1</span> <span class="o">=</span> <span class="n">l2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">l3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> 
        <span class="k">OR</span> <span class="p">(</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span><span class="o">-</span><span class="mi">1</span> <span class="o">=</span> <span class="n">l2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">l3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">l1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">2</span> <span class="p">)</span>
    <span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">visit_date</span><span class="p">;</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="k">Write</span> <span class="n">your</span> <span class="n">MySQL</span> <span class="n">query</span> <span class="k">statement</span> <span class="n">below</span>
<span class="o">#</span> <span class="err">ä½¿ç”¨äº†</span><span class="k">group</span> <span class="k">by</span> <span class="err">ç›´æ¥è¿›è¡Œäº†å»é‡</span>
<span class="k">select</span> <span class="n">s1</span><span class="p">.</span><span class="o">*</span>
<span class="k">from</span> <span class="n">stadium</span> <span class="n">s1</span><span class="p">,</span> <span class="n">stadium</span> <span class="n">s2</span><span class="p">,</span> <span class="n">stadium</span> <span class="n">s3</span>
<span class="k">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span> <span class="k">and</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="k">or</span>
    <span class="p">(</span><span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span> <span class="k">and</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="k">or</span>
    <span class="p">(</span><span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span> <span class="k">and</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">id</span><span class="p">))</span> <span class="k">and</span> 
    <span class="n">s1</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="k">and</span> <span class="n">s2</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="k">and</span> <span class="n">s3</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span>
</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">distinct</span> <span class="n">t1</span><span class="p">.</span><span class="o">*</span>
<span class="k">from</span> <span class="n">stadium</span> <span class="n">t1</span><span class="p">,</span> <span class="n">stadium</span> <span class="n">t2</span><span class="p">,</span> <span class="n">stadium</span> <span class="n">t3</span>
<span class="k">where</span> <span class="n">t1</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="k">and</span> <span class="n">t2</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span> <span class="k">and</span> <span class="n">t3</span><span class="p">.</span><span class="n">people</span> <span class="o">&gt;=</span> <span class="mi">100</span>
<span class="k">and</span>
<span class="p">(</span>
	  <span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">and</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">-- t1, t2, t3</span>
    <span class="k">or</span>
    <span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">and</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">-- t2, t1, t3</span>
    <span class="k">or</span>
    <span class="p">(</span><span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span> <span class="o">-</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">-- t3, t2, t1</span>
<span class="p">)</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">t1</span><span class="p">.</span><span class="n">id</span>
<span class="p">;</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">human</span><span class="o">-</span><span class="n">traffic</span><span class="o">-</span><span class="k">of</span><span class="o">-</span><span class="n">stadium</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">50428</span><span class="o">/</span><span class="n">ti</span><span class="o">-</span><span class="n">yu</span><span class="o">-</span><span class="n">guan</span><span class="o">-</span><span class="n">de</span><span class="o">-</span><span class="n">ren</span><span class="o">-</span><span class="n">liu</span><span class="o">-</span><span class="n">liang</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetcode</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>

<h3 id="608-æ ‘èŠ‚ç‚¹"><a href="https://leetcode.cn/problems/tree-node/description/">608. æ ‘èŠ‚ç‚¹</a></h3>

<ul>
  <li><a href="https://blog.csdn.net/helloxiaozhe/article/details/78124138">MySQL çš„CASE WHEN è¯­å¥ä½¿ç”¨è¯´æ˜</a></li>
</ul>

<p>è¡¨ï¼šTree</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| p_id        | int  |
+-------------+------+
</code></pre></div></div>

<p>id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
è¯¥è¡¨çš„æ¯è¡ŒåŒ…å«æ ‘ä¸­èŠ‚ç‚¹çš„ id åŠå…¶çˆ¶èŠ‚ç‚¹çš„ id ä¿¡æ¯ã€‚
ç»™å®šçš„ç»“æ„æ€»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ ‘ã€‚</p>

<p>æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š</p>

<p>â€œLeafâ€ï¼šèŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ã€‚
â€œRootâ€ï¼šèŠ‚ç‚¹æ˜¯æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚
â€œlnnerâ€ï¼šèŠ‚ç‚¹æ—¢ä¸æ˜¯å¶å­èŠ‚ç‚¹ä¹Ÿä¸æ˜¯æ ¹èŠ‚ç‚¹ã€‚
ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ¥æŠ¥å‘Šæ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„ç±»å‹ã€‚</p>

<p>ä»¥ ä»»æ„é¡ºåº è¿”å›ç»“æœè¡¨ã€‚</p>

<p>ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>ç¤ºä¾‹ 1ï¼š</p>

<p>è¾“å…¥ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Tree table:
+----+------+
| id | p_id |
+----+------+
| 1  | null |
| 2  | 1    |
| 3  | 1    |
| 4  | 2    |
| 5  | 2    |
+----+------+
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-------+
| id | type  |
+----+-------+
| 1  | Root  |
| 2  | Inner |
| 3  | Leaf  |
| 4  | Leaf  |
| 5  | Leaf  |
+----+-------+
</code></pre></div></div>

<p>è§£é‡Šï¼š
èŠ‚ç‚¹ 1 æ˜¯æ ¹èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒçš„çˆ¶èŠ‚ç‚¹ä¸ºç©ºï¼Œå¹¶ä¸”å®ƒæœ‰å­èŠ‚ç‚¹ 2 å’Œ 3ã€‚
èŠ‚ç‚¹ 2 æ˜¯ä¸€ä¸ªå†…éƒ¨èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒæœ‰çˆ¶èŠ‚ç‚¹ 1 å’Œå­èŠ‚ç‚¹ 4 å’Œ 5ã€‚
èŠ‚ç‚¹ 3ã€4 å’Œ 5 æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒä»¬æœ‰çˆ¶èŠ‚ç‚¹è€Œæ²¡æœ‰å­èŠ‚ç‚¹ã€‚
ç¤ºä¾‹ 2ï¼š</p>

<p>è¾“å…¥ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Tree table:
+----+------+
| id | p_id |
+----+------+
| 1  | null |
+----+------+
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-------+
| id | type  |
+----+-------+
| 1  | Root  |
+----+-------+
</code></pre></div></div>

<p>è§£é‡Šï¼šå¦‚æœæ ‘ä¸­åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™åªéœ€è¦è¾“å‡ºå…¶æ ¹å±æ€§ã€‚</p>

<ul>
  <li>æäº¤è§£ç­”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">ä¸»è¦æ€è·¯</span>
<span class="o">#</span> <span class="err">ç»Ÿè®¡èŠ‚ç‚¹æ‰€æœ‰çš„å­èŠ‚ç‚¹æ•°ç›®ï¼Œä¸çˆ¶èŠ‚ç‚¹æ•°ç›®</span>
<span class="k">SELECT</span> <span class="n">A</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">IF</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">p_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nv">"Root"</span><span class="p">,</span><span class="n">IF</span><span class="p">(</span><span class="n">s_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span><span class="nv">"Inner"</span><span class="p">,</span><span class="nv">"Leaf"</span><span class="p">)</span> <span class="p">)</span> <span class="k">AS</span>  <span class="k">type</span>  
<span class="k">FROM</span> 
<span class="p">(</span>
 <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">p_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">p_count</span>  <span class="k">FROM</span> <span class="n">TREE</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">id</span>
<span class="p">)</span> <span class="n">A</span> <span class="k">LEFT</span> <span class="k">JOIN</span> 
<span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">p_id</span>  <span class="k">AS</span> <span class="n">id</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">s_count</span> <span class="k">FROM</span> <span class="n">TREE</span> <span class="k">WHERE</span> <span class="n">p_id</span> <span class="o">&gt;=</span><span class="mi">0</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">p_id</span>
<span class="p">)</span> <span class="n">B</span> <span class="k">ON</span> <span class="n">A</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>

</code></pre></div></div>

<ul>
  <li>ä¼˜è´¨è§£ç­”ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">id</span><span class="p">,</span><span class="k">case</span> <span class="k">when</span> <span class="n">p_id</span> <span class="k">is</span> <span class="k">null</span> <span class="k">then</span> <span class="s1">'Root'</span> 
<span class="k">when</span> <span class="n">id</span> <span class="k">not</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="k">distinct</span> <span class="n">p_id</span> <span class="k">from</span> <span class="n">Tree</span> <span class="k">where</span> <span class="n">p_id</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span><span class="p">)</span> <span class="k">then</span> <span class="s1">'Leaf'</span>
<span class="k">else</span> <span class="s1">'Inner'</span> <span class="k">end</span> <span class="k">type</span>
<span class="k">from</span> <span class="n">Tree</span> 


</code></pre></div></div>

<ul>
  <li>å®˜æ–¹é¢˜è§£ï¼š</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
    <span class="n">atree</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">IF</span><span class="p">(</span><span class="k">ISNULL</span><span class="p">(</span><span class="n">atree</span><span class="p">.</span><span class="n">p_id</span><span class="p">),</span>
        <span class="s1">'Root'</span><span class="p">,</span>
        <span class="n">IF</span><span class="p">(</span><span class="n">atree</span><span class="p">.</span><span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">p_id</span> <span class="k">FROM</span> <span class="n">tree</span><span class="p">),</span> <span class="s1">'Inner'</span><span class="p">,</span><span class="s1">'Leaf'</span><span class="p">))</span> <span class="k">Type</span>
<span class="k">FROM</span>
    <span class="n">tree</span> <span class="n">atree</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">atree</span><span class="p">.</span><span class="n">id</span>

<span class="o">#</span><span class="err">ä½œè€…ï¼š</span><span class="n">LeetCode</span>
<span class="o">#</span><span class="err">é“¾æ¥ï¼š</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">leetcode</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">problems</span><span class="o">/</span><span class="n">tree</span><span class="o">-</span><span class="n">node</span><span class="o">/</span><span class="n">solutions</span><span class="o">/</span><span class="mi">23160</span><span class="o">/</span><span class="n">shu</span><span class="o">-</span><span class="n">jie</span><span class="o">-</span><span class="n">dian</span><span class="o">-</span><span class="k">by</span><span class="o">-</span><span class="n">leetcode</span><span class="o">/</span>
<span class="o">#</span><span class="err">æ¥æºï¼šåŠ›æ‰£ï¼ˆ</span><span class="n">LeetCode</span><span class="err">ï¼‰</span>
<span class="o">#</span><span class="err">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span>
</code></pre></div></div>
:ET