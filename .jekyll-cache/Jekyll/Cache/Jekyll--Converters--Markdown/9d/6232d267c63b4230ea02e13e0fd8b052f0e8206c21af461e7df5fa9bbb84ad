I"Â<blockquote>
  <p>2019-5-14 19:54:52</p>
</blockquote>

<h1 id="cc-çš„ä¸€ä¸ªç¬¦å·æ“ä½œé—®é¢˜">C/C++ çš„ä¸€ä¸ªç¬¦å·æ“ä½œé—®é¢˜</h1>

<p>ä»Šå¤©å‘ç°ä¸€ä¸²å¥‡å¼‚çš„ä»£ç ï¼Œå’Œå¸ˆå…„ä»¬ä¸€èµ·è®¨è®ºç ”ç©¶ä¹‹åï¼Œæ±‡æ€»æˆè¿™ç¯‡æ–‡ç« ã€‚</p>

<p>é¦–å…ˆå…ˆäº®å‡ºä»£ç ï¼š</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//a.c</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="k">const</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
    <span class="c1">//æ³¨æ„ä¸‹é¢çš„æ“ä½œ</span>
    
    <span class="n">a</span><span class="o">+=</span><span class="n">a</span><span class="o">-=</span><span class="n">a</span><span class="o">*=</span><span class="n">a</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//gcc å’Œg++ç¼–è¯‘ç»“æœéƒ½æ˜¯0</span>
</code></pre></div></div>
<p>ä¸Šè¿°ä»£ç <code class="language-plaintext highlighter-rouge">g++</code>å’Œ<code class="language-plaintext highlighter-rouge">gcc</code>ç¼–è¯‘ç»“æœéƒ½æ˜¯0;ä½¿ç”¨
<code class="language-plaintext highlighter-rouge">gcc -S a.c -o gcc_a.s</code>å’Œ<code class="language-plaintext highlighter-rouge">g++ -S a.c -o g_a.s</code>å¾—åˆ°å…¶æ±‡ç¼–ä»£ç ç›¸åŒå¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    .file   "a.c"
    .section    .rodata
.LC0:
    .string "%d\n"
    .text
    .globl  main
    .type   main, @function
main:
.LFB2:
    .cfi_startproc
    pushq   %rbp
    .cfi_def_cfa_offset 16
    .cfi_offset 6, -16
    movq    %rsp, %rbp
    .cfi_def_cfa_register 6
    subq    $16, %rsp
    movl    $10, -4(%rbp)
    movl    -4(%rbp), %eax
    imull   -4(%rbp), %eax
    movl    %eax, -4(%rbp)
    movl    -4(%rbp), %eax
    subl    %eax, -4(%rbp)
    movl    -4(%rbp), %eax
    addl    %eax, -4(%rbp)
    movl    -4(%rbp), %eax
    movl    %eax, %esi
    movl    $.LC0, %edi
    movl    $0, %eax
    call    printf
    movl    $0, %eax
    leave
    .cfi_def_cfa 7, 8
    ret
    .cfi_endproc
.LFE2:
    .size   main, .-main
    .ident  "GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609"
    .section    .note.GNU-stack,"",@progbits

</code></pre></div></div>
<p>æ¥ä¸‹æ¥å°±æ˜¯å¯¹è¿™ä¸€ä¸²æ±‡ç¼–ä»£ç çš„è§£è¯»äº†ã€‚</p>

<h2 id="gccæŒ‡ä»¤">GCCæŒ‡ä»¤</h2>
<p><em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="http://gcc.gnu.org/">GCC</a>;<a href="https://gcc.gnu.org/onlinedocs/">GCC online documentation</a>;<a href="https://gcc.gnu.org/onlinedocs/gcc-5.5.0/gcc/#toc-GCC-Command-Options">GCC C++ Command Options</a>;<a href="https://www.runoob.com/w3cnote/gcc-parameter-detail.html">GCCå‚æ•°è¯¦è§£</a></p>

<h3 id="gcc-ç¼–è¯‘æ­¥éª¤">GCC ç¼–è¯‘æ­¥éª¤</h3>
<p><em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="https://blog.csdn.net/czg13548930186/article/details/78331692">gccç¨‹åºçš„ç¼–è¯‘è¿‡ç¨‹å’Œé“¾æ¥åŸç†</a>;</p>

<p>GCCç¼–è¯‘åˆ†ä¸º4æ­¥ï¼›</p>

<p><img src="https://img-blog.csdn.net/20180911135651696?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3pzajExMjY=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="ç¼–è¯‘æµç¨‹å›¾" /></p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">gcc -E</code>:é¢„å¤„ç†é˜¶æ®µ(preprocessing)ï¼Œå¯¹åŒ…å«çš„å¤´æ–‡ä»¶ï¼ˆ#include)å’Œå®å®šä¹‰ï¼ˆ#defineï¼Œ#ifdefç­‰ï¼‰è¿›è¡Œå¤„ç†ã€‚åœ¨ä¸Šè¿°çš„ä»£ç å¤„ç†è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨å°†åŒ…å«çš„å¤´æ–‡ä»¶stdio.hç¼–è¯‘è¿›æ¥ï¼Œå¹¶ä¸”è®©ç”¨æˆ·ä½¿ç”¨é€‰é¡¹â€-Eâ€œ
è¿›è¡ŒæŸ¥çœ‹ï¼Œè¯¥é€‰é¡¹çš„ä½œç”¨æ˜¯è®©gccåœ¨é¢„å¤„ç†ç»“æŸååœæ­¢ç¼–è¯‘è¿‡ç¨‹ã€‚â€.iâ€œæ–‡ä»¶ä¸ºå·²ç»è¿‡é¢„å¤„ç†çš„cç¨‹åºã€‚ä¸€ä¸‹åˆ—å‡ºéƒ¨åˆ†;å¤„ç†æ“ä½œï¼š <code class="language-plaintext highlighter-rouge">gcc -E a.c -o  gcc_a_e.i -std=c99</code></li>
  <li><code class="language-plaintext highlighter-rouge">gcc -S</code>:ç¼–è¯‘æ“ä½œ(compilation)ï¼Œå°†C/C++æˆ–è€…<code class="language-plaintext highlighter-rouge">.i</code>æ–‡ä»¶ç¼–è¯‘æˆä¸ºæ±‡ç¼–ä»£ç ã€‚å¤„ç†æ“ä½œï¼š<code class="language-plaintext highlighter-rouge"> gcc -S gcc_a_e.i -o  gcc_a_e.s -std=c99</code></li>
  <li><code class="language-plaintext highlighter-rouge">gcc -c</code>:æ±‡ç¼–æ“ä½œ(assembly),å°†<code class="language-plaintext highlighter-rouge">.c</code>æˆ–è€…<code class="language-plaintext highlighter-rouge">.s</code>æ–‡ä»¶è½¬åŒ–ä¸ºå¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶<code class="language-plaintext highlighter-rouge">.o</code>æˆ–è€…<code class="language-plaintext highlighter-rouge">.obj</code>;å¤„ç†æ“ä½œï¼š<code class="language-plaintext highlighter-rouge">gcc -c gcc_a_e_s.s -o gcc_a.o</code>;</li>
  <li><code class="language-plaintext highlighter-rouge">gcc -o a a.o</code>ï¼šé“¾æ¥æ“ä½œ(link);é“¾æ¥ä¸åŒçš„<code class="language-plaintext highlighter-rouge">.o</code>æ–‡ä»¶ï¼Œç”Ÿæˆå¯æ‰§è¡Œçš„æ–‡ä»¶ã€‚</li>
</ol>

<p>å¸¸ç”¨é€‰é¡¹è¡¨</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">é€‰é¡¹</th>
      <th style="text-align: left">å«ä¹‰</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-v</code></td>
      <td style="text-align: left">æŸ¥çœ‹gccç¼–è¯‘å™¨çš„ç‰ˆæœ¬ï¼Œæ˜¾ç¤ºgccæ‰§è¡Œæ—¶çš„è¯¦ç»†è¿‡ç¨‹</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-o &lt;file&gt;</code></td>
      <td style="text-align: left">Place the output into <file>;æŒ‡å®šè¾“å‡ºæ–‡ä»¶åä¸ºfileï¼Œè¿™ä¸ªåç§°ä¸èƒ½è·Ÿæºæ–‡ä»¶ååŒå</file></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-E</code></td>
      <td style="text-align: left">Preprocess only; do not compile, assemble or linkï¼›åªé¢„å¤„ç†ï¼Œä¸ä¼šç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-S</code></td>
      <td style="text-align: left">Compile only; do not assemble or linkï¼›åªç¼–è¯‘ï¼Œä¸ä¼šæ±‡ç¼–ã€é“¾æ¥</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-c</code></td>
      <td style="text-align: left">Compile and assemble, but do not linkï¼› ç¼–è¯‘å’Œæ±‡ç¼–ï¼Œä¸ä¼šé“¾æ¥</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-On</code></td>
      <td style="text-align: left">ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹ï¼Œé»˜è®¤ç­‰çº§<code class="language-plaintext highlighter-rouge">-O1</code>,<code class="language-plaintext highlighter-rouge">-O2</code>å‘Šè¯‰GCCé™¤äº†å®Œæˆ<code class="language-plaintext highlighter-rouge">-O1</code>çº§åˆ«çš„ä¼˜åŒ–ä¹‹å¤–ï¼ŒåŒæ—¶è¿˜è¦è¿›è¡Œä¸€äº›é¢å¤–çš„è°ƒæ•´å·¥ä½œï¼Œå¦‚å¤„ç†å™¨æŒ‡ä»¤è°ƒåº¦ç­‰,é€‰é¡¹<code class="language-plaintext highlighter-rouge">-O3</code>åˆ™é™¤äº†å®Œæˆ<code class="language-plaintext highlighter-rouge">-O2</code>çº§åˆ«çš„ä¼˜åŒ–ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬å¾ªç¯å±•å¼€å’Œå…¶ä»–ä¸€äº›ä¸å¤„ç†å™¨ç‰¹æ€§ç›¸å…³çš„ä¼˜åŒ–å·¥ä½œ</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-l</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-lLIBRARY</code> è¿æ¥æ—¶æœç´¢æŒ‡å®šçš„å‡½æ•°åº“LIBRARY</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-I</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">Include</code> æ·»åŠ <code class="language-plaintext highlighter-rouge">include</code>å¤´æ–‡ä»¶</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-Ldir</code></td>
      <td style="text-align: left">åˆ¶å®šç¼–è¯‘çš„æ—¶å€™ï¼Œæœç´¢åº“çš„è·¯å¾„ã€‚æ¯”å¦‚ä½ è‡ªå·±çš„åº“ï¼Œå¯ä»¥ç”¨å®ƒåˆ¶å®šç›®å½•ï¼Œä¸ç„¶ç¼–è¯‘å™¨å°†åªåœ¨æ ‡å‡†åº“çš„ç›®å½•æ‰¾ã€‚è¿™ä¸ªdirå°±æ˜¯ç›®å½•çš„åç§°ã€‚</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-w/Wall</code></td>
      <td style="text-align: left">ä¸ç”Ÿæˆ/ç”Ÿæˆæ‰€æœ‰è­¦å‘Šä¿¡æ¯</td>
    </tr>
  </tbody>
</table>

<h4 id="é“¾æ¥åŸç†">é“¾æ¥åŸç†</h4>

<p>ä½¿ç”¨  <code class="language-plaintext highlighter-rouge">gcc -V -o gcc_a_e gcc_a_e.o</code>æŸ¥çœ‹é“¾æ¥è¯¦ç»†æ“ä½œå¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 5.4.0-6ubuntu1~16.04.11' --with-bugurl=file:///usr/share/doc/gcc-5/README.Bugs --enable-languages=c,ada,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-5 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-libmpx --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-5-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-5-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-5-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.11) 
COMPILER_PATH=/usr/lib/gcc/x86_64-linux-gnu/5/:/usr/lib/gcc/x86_64-linux-gnu/5/:/usr/lib/gcc/x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/5/:/usr/lib/gcc/x86_64-linux-gnu/
LIBRARY_PATH=/usr/lib/gcc/x86_64-linux-gnu/5/:/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/:/usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib/:/lib/x86_64-linux-gnu/:/lib/../lib/:/usr/lib/x86_64-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/x86_64-linux-gnu/5/../../../:/lib/:/usr/lib/
COLLECT_GCC_OPTIONS='-v' '-o' 'gcc_a_e' '-mtune=generic' '-march=x86-64'
 /usr/lib/gcc/x86_64-linux-gnu/5/collect2 -plugin /usr/lib/gcc/x86_64-linux-gnu/5/liblto_plugin.so -plugin-opt=/usr/lib/gcc/x86_64-linux-gnu/5/lto-wrapper -plugin-opt=-fresolution=/tmp/ccXTxtp9.res -plugin-opt=-pass-through=-lgcc -plugin-opt=-pass-through=-lgcc_s -plugin-opt=-pass-through=-lc -plugin-opt=-pass-through=-lgcc -plugin-opt=-pass-through=-lgcc_s --sysroot=/ --build-id --eh-frame-hdr -m elf_x86_64 --hash-style=gnu --as-needed -dynamic-linker /lib64/ld-linux-x86-64.so.2 -z relro -o gcc_a_e /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/crt1.o /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/5/crtbegin.o -L/usr/lib/gcc/x86_64-linux-gnu/5 -L/usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/5/../../../../lib -L/lib/x86_64-linux-gnu -L/lib/../lib -L/usr/lib/x86_64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/5/../../.. gcc_a_e.o -lgcc --as-needed -lgcc_s --no-as-needed -lc -lgcc --as-needed -lgcc_s --no-as-needed /usr/lib/gcc/x86_64-linux-gnu/5/crtend.o /usr/lib/gcc/x86_64-linux-gnu/5/../../../x86_64-linux-gnu/crtn.o

</code></pre></div></div>

<p>æ³¨æ„ï¼š</p>

<ul>
  <li>crt1.oã€crti.oã€crtbegin.oã€crtend.oã€crtn.oæ˜¯gccåŠ å…¥çš„ç³»ç»Ÿæ ‡å‡†å¯åŠ¨æ–‡ä»¶ï¼Œå¯¹äºä¸€èˆ¬åº”ç”¨ç¨‹åºï¼Œè¿™äº›å¯åŠ¨æ˜¯å¿…éœ€çš„ã€‚</li>
  <li>-lcï¼šé“¾æ¥libcåº“æ–‡ä»¶ï¼Œå…¶ä¸­libcåº“æ–‡ä»¶ä¸­å°±å®ç°äº†printfç­‰å‡½æ•°</li>
  <li>gccé»˜è®¤ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“è¿›è¡Œé“¾æ¥ï¼Œç”Ÿæˆçš„ç¨‹åºåœ¨æ‰§è¡Œçš„æ—¶å€™éœ€è¦åŠ è½½æ‰€éœ€è¦çš„åŠ¨æ€åº“æ‰èƒ½è¿è¡Œï¼ŒåŠ¨æ€åº“ä½“ç§¯å°ï¼Œä½†æ˜¯å¿…é¡»ä¾èµ–æ‰€éœ€çš„åŠ¨æ€åº“å¦åˆ™æ— æ³•æ‰§è¡Œã€‚</li>
  <li>æ·»åŠ <code class="language-plaintext highlighter-rouge">-static</code>é€‰é¡¹å¯ä»¥å®ç°ï¼Œé™æ€åº“çš„é“¾æ¥ï¼Œç”Ÿæˆçš„ç¨‹åºåŒ…å«æ‰€éœ€è¦çš„æ‰€æœ‰åº“å¯ä»¥ç›´æ¥è¿è¡Œã€‚ä¸è¿‡ä½“ç§¯è¾ƒå¤§ã€‚æ“ä½œï¼š<code class="language-plaintext highlighter-rouge"> gcc -v -static  -o a_static a.c</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">-nostartfiles</code>:ä¸é“¾æ¥æ ‡å‡†å¯åŠ¨åº“æ–‡ä»¶ï¼Œè€Œæ ‡å‡†åº“æ–‡ä»¶ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">-nostdlib</code>:ä¸é“¾æ¥ç³»ç»Ÿæ ‡å‡†å¯åŠ¨æ–‡ä»¶å’Œæ ‡å‡†åº“æ–‡ä»¶ã€‚</li>
</ul>

<h4 id="ç”Ÿæˆæ±‡ç¼–æŒ‡ä»¤ç»“æœ">ç”Ÿæˆæ±‡ç¼–æŒ‡ä»¤ç»“æœï¼š</h4>

<p><strong><code class="language-plaintext highlighter-rouge">gcc -S -O3 -o a1.s a.c</code></strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//a1.s

    .file   "a.c"
    .section    .rodata.str1.1,"aMS",@progbits,1
.LC0:
    .string "%d\n"
    .section    .text.unlikely,"ax",@progbits
.LCOLDB1:
    .section    .text.startup,"ax",@progbits
.LHOTB1:
    .p2align 4,,15
    .globl  main
    .type   main, @function
main:
.LFB23:
    .cfi_startproc
    subq    $8, %rsp
    .cfi_def_cfa_offset 16
    xorl    %edx, %edx
    movl    $.LC0, %esi
    movl    $1, %edi
    xorl    %eax, %eax
    call    __printf_chk
    xorl    %eax, %eax
    addq    $8, %rsp
    .cfi_def_cfa_offset 8
    ret
    .cfi_endproc
.LFE23:
    .size   main, .-main
    .section    .text.unlikely
.LCOLDE1:
    .section    .text.startup
.LHOTE1:
    .ident  "GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609"
    .section    .note.GNU-stack,"",@progbits

</code></pre></div></div>

<h3 id="intel-x86-åŸºæœ¬æ±‡ç¼–æŒ‡ä»¤">Intel x86 åŸºæœ¬æ±‡ç¼–æŒ‡ä»¤</h3>

<p><em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="https://blog.csdn.net/pro_technician/article/details/78173777">æ·±å…¥æµ…å‡ºGNU X86-64 æ±‡ç¼–</a>;<a href="http://www.cnblogs.com/orlion/p/5765339.html">x86æ±‡ç¼–ç¨‹åºåŸºç¡€(AT&amp;Tè¯­æ³•)</a>ï¼›<a href="http://www.ruanyifeng.com/blog/2018/01/assembly-language-primer.html">æ±‡ç¼–è¯­è¨€å…¥é—¨æ•™ç¨‹</a></p>

<p>åœ¨æ­¤ç®€å•çš„ä»‹ç»x86_64åŸºæœ¬æ±‡ç¼–æŒ‡ä»¤ï¼Œä¸åšè¿‡å¤šä»‹ç»ã€‚</p>

<h4 id="ç¨‹åºåŠ è½½æ—¶ç³»ç»Ÿçš„å†…å­˜åˆ†é…">ç¨‹åºåŠ è½½æ—¶ç³»ç»Ÿçš„å†…å­˜åˆ†é…</h4>

<p>ç¨‹åºå¯åŠ¨è¿‡ç¨‹ï¼š
ç¨‹åºâ€”â€”-&gt; ç¨‹åºåŠ è½½å™¨| â€”â€”â€”-&gt; Flash memory
                     | â€”â€”â€”-&gt; SDRAM 
                     | â€”â€”â€”-&gt; BBRAM</p>

<p><strong>ç³»ç»ŸåŒºå—ç‰¹æ€§</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åç§°</th>
      <th style="text-align: left">ç§ç±»</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_NULL</code></td>
      <td style="text-align: left">æ— æ•ˆçš„åŒºå—</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_PROGBITS</code></td>
      <td style="text-align: left">å¸¦æœ‰æ•°æ®(æœºæ¢°è¯­å’Œåˆå§‹å€¼ç­‰)çš„åŒºå—</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_NOBITS</code></td>
      <td style="text-align: left">ä¸å¸¦æœ‰æ•°æ®</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_RELA</code></td>
      <td style="text-align: left">å¸¦æœ‰å¯å†åˆ†é…çš„æ•°æ®</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_REL</code></td>
      <td style="text-align: left">å¸¦æœ‰å¯å†åˆ†é…çš„æ•°æ®ä¸”ä¸ä¾èµ–ä¸å†…å­˜çš„ä»£ç </td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_SYMTAB</code></td>
      <td style="text-align: left">å¸¦æœ‰ç¬¦å·è¡¨çš„åŒºå—</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th style="text-align: left">åç§°</th>
      <th style="text-align: left">å±æ€§</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_ALLOC</code></td>
      <td style="text-align: left">åº”è¯¥æ”¾åœ¨å†…å­˜ä¸Šçš„åŒºå—</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_WRITE</code></td>
      <td style="text-align: left">åº”è¯¥æ”¾åœ¨å¯è¯»å†™åŒºåŸŸçš„åŒºå—</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_EXECINSTR</code></td>
      <td style="text-align: left">åº”è¯¥æ”¾åœ¨å¯æ‰§è¡ŒåŒºåŸŸçš„åŒºå—</td>
    </tr>
  </tbody>
</table>

<p>å½’ç±»</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">æ–‡ä»¶</th>
      <th style="text-align: left">ç§ç±»</th>
      <th style="text-align: left">å±æ€§</th>
      <th style="text-align: left">è¯´æ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.bbs</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_NOBITS</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_ALLOC + SHF_WRITE</code></td>
      <td style="text-align: left">ä¸»è¦å­˜æ”¾0æˆ–è€…æ— åˆå§‹å€¼çš„å…¨å±€å˜é‡å’Œ0æˆ–è€…æ— åˆå§‹å€¼çš„é™æ€å±€éƒ¨å˜é‡</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.data</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_PROGBITS</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_ALLOC + SHF_WRITE</code></td>
      <td style="text-align: left">ä¸»è¦å­˜æ”¾åˆå§‹å€¼æ˜¯0ä»¥å¤–çš„å…¨å±€å˜é‡å’Œåˆå§‹å€¼ä¸º0ä»¥å¤–çš„é™æ€å±€éƒ¨å˜é‡</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.text</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_PROGBITS</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_ALLOC + SHF_EXECINSTR</code></td>
      <td style="text-align: left">æœºæ¢°è¯­è·Ÿä»£ç </td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.rodata</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHT_PROGBITS</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">SHF_ALLOC</code></td>
      <td style="text-align: left">å­—ç¬¦ä¸²ï¼Œæˆ–è€…å®šæ•°ï¼ˆconstï¼‰</td>
    </tr>
  </tbody>
</table>

<p>linuxå„ä¸ªå­—æ®µå«ä¹‰ï¼š
<em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="https://www.cnblogs.com/lcchuguo/p/5105316.html">Linuxæ®µç®¡ç†</a></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">å­—æ®µåç§°</th>
      <th style="text-align: left">æ„ä¹‰</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.bbs/BSS</code></td>
      <td style="text-align: left">BSSæ˜¯è‹±æ–‡Block Started by Symbolçš„ç®€ç§°ã€‚å±äºé™æ€å†…å­˜åˆ†é…;ç”¨äºå­˜å‚¨æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡æˆ–è€…æ˜¯é»˜è®¤åˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡ï¼Œå®ƒä¸å ç”¨ç¨‹åºæ–‡ä»¶çš„å¤§å°ï¼Œå¯æ˜¯å ç”¨ç¨‹åºæ‰§è¡Œæ—¶çš„å†…å­˜ç©ºé—´ã€‚</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.data/data</code></td>
      <td style="text-align: left">è¯¥æ®µç”¨äºå­˜å‚¨åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œåˆå§‹åŒ–ä¸º0çš„å…¨å±€å˜é‡å‡ºäºç¼–è¯‘ä¼˜åŒ–çš„ç­–ç•¥è¿˜æ˜¯è¢«ä¿å­˜åœ¨BSSæ®µ</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.rodata/rodata</code></td>
      <td style="text-align: left">è¯¥æ®µä¹Ÿå«å¸¸é‡åŒºï¼Œç”¨äºå­˜æ”¾å¸¸é‡æ•°æ®ï¼Œroå°±æ˜¯Read Onlyä¹‹æ„ã€‚1.äº›é©¬ä¸Šæ•°ä¸æŒ‡ä»¤ç¼–è¯‘åœ¨ä¸€èµ·ç›´æ¥æ”¾åœ¨ä»£ç æ®µã€‚2.å¯¹äºå­—ç¬¦ä¸²å¸¸é‡ï¼Œç¼–è¯‘å™¨ä¼šå»æ‰åå¤çš„å¸¸é‡ï¼Œè®©ç¨‹åºçš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ä»…ä»…æœ‰ä¸€ä»½ã€‚3.æœ‰äº›ç³»ç»Ÿä¸­rodataæ®µæ˜¯å¤šä¸ªè¿›ç¨‹å…±äº«çš„ï¼Œç›®çš„æ˜¯ä¸ºäº†æé«˜ç©ºé—´çš„åˆ©ç”¨ç‡ã€‚</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.text/text</code></td>
      <td style="text-align: left">ç”¨äºå­˜æ”¾ç¨‹åºä»£ç çš„ï¼Œç¼–è¯‘æ—¶ç¡®å®š,ä»…ä»…è¯»ã€‚æ›´è¿›ä¸€æ­¥è®²æ˜¯å­˜æ”¾å¤„ç†å™¨çš„æœºå™¨æŒ‡ä»¤ï¼Œå½“å„ä¸ªæºæ–‡ä»¶å•ç‹¬ç¼–è¯‘ä¹‹åç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚ç»è¿æ¥å™¨é“¾æ¥å„ä¸ªç›®æ ‡æ–‡ä»¶å¹¶è§£å†³å„ä¸ªæºæ–‡ä»¶ä¹‹é—´å‡½æ•°çš„å¼•ç”¨ï¼Œä¸æ­¤åŒä¸€æ—¶å€™ï¼Œè¿˜å¾—å°†å…¨éƒ¨ç›®æ ‡æ–‡ä»¶é‡Œçš„.textæ®µåˆåœ¨ä¸€èµ·ï¼Œä½†ä¸æ˜¯ç®€å•çš„å°†å®ƒä»¬â€œå †â€åœ¨ä¸€èµ·å°±å®Œäº‹ï¼Œè¿˜é¡»è¦å¤„ç†å„ä¸ªæ®µä¹‹é—´çš„å‡½æ•°å¼•ç”¨é—®é¢˜ã€‚</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.stack/stack</code></td>
      <td style="text-align: left">æ˜¯ç”±ç³»ç»Ÿè´Ÿè´£ç”³è¯·é‡Šæ”¾ï¼Œå…¶æ“ä½œæ–¹å¼ç±»ä¼¼stackï¼Œç”¨äºå­˜å‚¨åƒæ•°å˜é‡åŠå±€éƒ¨å˜é‡ï¼Œäº‹å®ä¸Šå‡½æ•°çš„è¿è¡Œä¹Ÿæ˜¯stackçš„æ–¹å¼ï¼Œæ‰€ä»¥æ‰æœ‰äº†é€’å½’</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">.heap/heap</code></td>
      <td style="text-align: left">å®ƒç”±ç”¨æˆ·ç”³è¯·å’Œé‡Šæ”¾ã€‚ç”³è¯·æ—¶è‡³å°‘åˆ†é…è™šå­˜ï¼Œå½“çœŸæ­£å­˜å‚¨æ•°æ®æ—¶æ‰åˆ†é…å¯¹åº”çš„å®å­˜ï¼Œé‡Šæ”¾æ—¶ä¹Ÿå¹¶ä¸æ˜¯é©¬ä¸Šé‡Šæ”¾å®å­˜ã€‚è€Œæ˜¯å¯èƒ½è¢«åå¤åˆ©ç”¨ã€‚</td>
    </tr>
  </tbody>
</table>

<p><img src="http://img.blog.csdn.net/20141028122011240?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2R4aW4xMzIy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="64ä½å†…å­˜å¸ƒå±€" /></p>

<h4 id="æ±‡ç¼–ç¨‹åºåŸºæœ¬å…ƒç´ ç»„æˆ">æ±‡ç¼–ç¨‹åºåŸºæœ¬å…ƒç´ ç»„æˆ</h4>

<ul>
  <li><strong>æŒ‡ç¤ºï¼ˆDirectivesï¼‰</strong>ï¼šä»¥ç‚¹å·å¼€å§‹ï¼Œç”¨æ¥æŒ‡ç¤ºå¯¹ç¼–è¯‘å™¨ï¼Œè¿æ¥å™¨ï¼Œè°ƒè¯•å™¨æœ‰ç”¨çš„ç»“æ„ä¿¡æ¯ã€‚æŒ‡ç¤ºæœ¬èº«ä¸æ˜¯æ±‡ç¼–æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼š
    <ul>
      <li><code class="language-plaintext highlighter-rouge">.file</code>ï¼šåªæ˜¯è®°å½•åŸå§‹æºæ–‡ä»¶åã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.data</code>ï¼šè¡¨ç¤ºæ•°æ®æ®µ(section)çš„å¼€å§‹åœ°å€ã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.text</code>ï¼šè¡¨ç¤ºå®é™…ç¨‹åºä»£ç çš„èµ·å§‹ã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.string</code>ï¼šè¡¨ç¤ºæ•°æ®æ®µä¸­çš„å­—ç¬¦ä¸²å¸¸é‡ã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.globl main</code>ï¼šæŒ‡æ˜æ ‡ç­¾mainæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨å…¶å®ƒæ¨¡å—çš„ä»£ç ä¸­è¢«è®¿é—®çš„å…¨å±€ç¬¦å·ã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.section</code> :å®šä¹‰å†…å­˜æ®µ,å£°æ˜æ®µçš„ç±»å‹ï¼Œä¾‹å¦‚<code class="language-plaintext highlighter-rouge">.section .rodata</code>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">.bbs</code></li>
          <li><code class="language-plaintext highlighter-rouge">.rodata</code></li>
          <li><code class="language-plaintext highlighter-rouge">.text</code></li>
          <li><code class="language-plaintext highlighter-rouge">.stack</code></li>
          <li><code class="language-plaintext highlighter-rouge">.heap</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>æ ‡ç­¾ï¼ˆLabelsï¼‰</strong>ï¼šä»¥å†’å·ç»“å°¾ï¼Œç”¨æ¥æŠŠæ ‡ç­¾åå’Œæ ‡ç­¾å‡ºç°çš„ä½ç½®å…³è”èµ·æ¥ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œ ä»¥ç‚¹å·å¼€å§‹çš„æ ‡ç­¾éƒ½æ˜¯ç¼–è¯‘å™¨ç”Ÿæˆçš„ä¸´æ—¶å±€éƒ¨æ ‡ç­¾ï¼Œå…¶å®ƒæ ‡ç­¾åˆ™æ˜¯ç”¨æˆ·å¯è§çš„å‡½æ•°å’Œå…¨å±€å˜é‡åç§°ã€‚ä¾‹å¦‚ï¼š
    <ul>
      <li><code class="language-plaintext highlighter-rouge">.LC0:</code>ï¼šè¡¨ç¤ºç´§æ¥ç€çš„å­—ç¬¦ä¸²çš„åç§°æ˜¯<code class="language-plaintext highlighter-rouge">.LC0.</code>æ ‡ç­¾ã€‚</li>
      <li><code class="language-plaintext highlighter-rouge">.cfi_</code> å¼€å¤´çš„æ±‡ç¼–æŒ‡ç¤ºç¬¦ç”¨æ¥å‘Šè¯‰æ±‡ç¼–å™¨ç”Ÿæˆç›¸åº”çš„ DWARF è°ƒè¯•ä¿¡æ¯(<a href="https://blog.csdn.net/jtli_embeddedcv/article/details/9321253">.cfiæŒ‡ä»¤è§£è¯»</a>;<a href="https://source.winehq.org/source/dlls/dbghelp/cpu_x86_64.c#L739">å®˜æ–¹æ–‡æ¡£</a>)
        <ul>
          <li><code class="language-plaintext highlighter-rouge">.cfi_startproc</code>:å®šä¹‰å‡½æ•°å¼€å§‹</li>
          <li><code class="language-plaintext highlighter-rouge">.cfi_endproc</code>ï¼šå®šä¹‰å‡½æ•°ç»“æŸ</li>
          <li><code class="language-plaintext highlighter-rouge">.cfi_def_cfa_offset</code>:å®šä¹‰æ­¤å¤„è·ç¦»CFA(Canonical Frame Address)æ ‡å‡†æ¡†æ¶åœ°å€â€“<strong>åœ¨å‰ä¸€ä¸ªè°ƒç”¨æ¡†æ¶ä¸­è°ƒç”¨å½“å‰å‡½æ•°æ—¶çš„æ ˆé¡¶æŒ‡é’ˆ</strong></li>
        </ul>
      </li>
      <li><code class="language-plaintext highlighter-rouge">main:</code>ï¼šè¡¨ç¤ºæŒ‡ä»¤ <code class="language-plaintext highlighter-rouge">pushq %rbp</code>æ˜¯mainå‡½æ•°çš„ç¬¬ä¸€ä¸ªæŒ‡ä»¤ã€‚</li>
    </ul>
  </li>
  <li><strong>æŒ‡ä»¤ï¼ˆInstructionsï¼‰</strong>ï¼šå®é™…çš„æ±‡ç¼–ä»£ç  (pushq %rbp), ä¸€èˆ¬éƒ½ä¼šç¼©è¿›ï¼Œä»¥ä¾¿å’ŒæŒ‡ç¤ºåŠæ ‡ç­¾åŒºåˆ†å¼€æ¥ã€‚</li>
</ul>

<h4 id="cpuå¯„å­˜å™¨">CPUå¯„å­˜å™¨</h4>
<p>X86-64ä¸­ï¼Œæ‰€æœ‰å¯„å­˜å™¨éƒ½æ˜¯64ä½ï¼Œç›¸å¯¹32ä½çš„x86æ¥è¯´ï¼Œæ ‡è¯†ç¬¦å‘ç”Ÿäº†å˜åŒ–ï¼Œæ¯”å¦‚ï¼šä»åŸæ¥çš„%ebpå˜æˆäº†%rbpã€‚ä¸ºäº†å‘åå…¼å®¹æ€§ï¼Œ%ebpä¾ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä¸è¿‡æŒ‡å‘äº†%rbpçš„ä½32ä½ã€‚X86-64å¯„å­˜å™¨çš„å˜åŒ–ï¼Œä¸ä»…ä½“ç°åœ¨ä½æ•°ä¸Šï¼Œæ›´åŠ ä½“ç°åœ¨å¯„å­˜å™¨æ•°é‡ä¸Šã€‚æ–°å¢åŠ å¯„å­˜å™¨%r8åˆ°%r15ã€‚åŠ ä¸Šx86çš„åŸæœ‰8ä¸ªï¼Œä¸€å…±16ä¸ªå¯„å­˜å™¨ã€‚å¯„å­˜å™¨é›†æˆåœ¨CPUä¸Šï¼Œå­˜å–é€Ÿåº¦æ¯”å­˜å‚¨å™¨å¿«å¥½å‡ ä¸ªæ•°é‡çº§ï¼Œå¯„å­˜å™¨å¤šäº†ï¼ŒGCCå°±å¯ä»¥æ›´å¤šçš„ä½¿ç”¨å¯„å­˜å™¨ï¼Œæ›¿æ¢ä¹‹å‰çš„å­˜å‚¨å™¨å †æ ˆä½¿ç”¨ï¼Œä»è€Œå¤§å¤§æå‡æ€§èƒ½ã€‚</p>

<p><img src="https://img-blog.csdn.net/20171008191643821" alt="x86_64å¯„å­˜å™¨åœ°å€" /></p>

<p>æ³¨æ„ï¼šéšç€è®¾è®¡çš„è¿›å±•ï¼Œæ–°çš„æŒ‡ä»¤å’Œå¯»å€æ¨¡å¼è¢«æ·»åŠ è¿›æ¥ï¼Œä½¿å¾—å¾ˆå¤šå¯„å­˜å™¨å˜æˆäº†ç­‰åŒçš„ã€‚å°‘æ•°ç•™ä¸‹æ¥çš„æŒ‡ä»¤ï¼Œç‰¹åˆ«æ˜¯å’Œå­—ç¬¦ä¸²å¤„ç†ç›¸å…³çš„ï¼Œè¦æ±‚ä½¿ç”¨<code class="language-plaintext highlighter-rouge">%rsi</code> å’Œ<code class="language-plaintext highlighter-rouge">%rdi</code>ã€‚ä¸¤ä¸ªå¯„å­˜å™¨è¢«ä¿ç•™ä¸‹æ¥åˆ†åˆ«ä½œä¸ºæ ˆæŒ‡é’ˆ (<code class="language-plaintext highlighter-rouge">%rsp</code>) å’ŒåŸºå€æŒ‡é’ˆ (<code class="language-plaintext highlighter-rouge">%rbp</code>)ã€‚æœ€åçš„8ä¸ªå¯„å­˜å™¨æ˜¯ç¼–å·çš„å¹¶ä¸”æ²¡æœ‰ç‰¹æ®Šé™åˆ¶ã€‚</p>

<p>å¤šå¹´æ¥ï¼Œä½“ç³»ç»“æ„ä»8ä½æ‰©å±•åˆ°16ä½ï¼Œ32ä½ï¼Œå› æ­¤æ¯ä¸ªå¯„å­˜å™¨éƒ½æœ‰ä¸€äº›å†…éƒ¨ç»“æ„ï¼š</p>

<p><img src="https://img-blog.csdn.net/20171008192750274" alt="%rax å¯„å­˜å™¨å†…éƒ¨ç»“æ„" /></p>

<p>%raxçš„ä½8ä½æ˜¯8ä½å¯„å­˜å™¨%al,ä»…é çš„8ä½æ˜¯%ahã€‚ä½16ä½æ˜¯%axï¼Œä½32ä½æ˜¯%eaxï¼Œæ•´ä¸ª64ä½æ˜¯%raxã€‚
å¯„å­˜å™¨%r8-%r15ä¹Ÿæœ‰ç›¸åŒç»“æ„ï¼Œä½†å‘½åæ–¹å¼ç¨æœ‰ä¸åŒï¼š</p>

<p><img src="https://img-blog.csdn.net/20171008193142962" alt="%r8-%r15å¯„å­˜å™¨å†…éƒ¨ç»“æ„" /></p>

<p><strong>æ³¨æ„</strong>ï¼šå¤§å¤šæ•°ç¼–è¯‘å™¨äº§å“æ··åˆä½¿ç”¨32å’Œ64ä½æ¨¡å¼ã€‚32ä½å¯„å­˜å™¨ç”¨æ¥åšæ•´æ•°è®¡ç®—ï¼Œå› ä¸ºå¤§å¤šæ•°ç¨‹åºä¸éœ€è¦å¤§äº 2^32 çš„æ•´æ•°å€¼ã€‚64ä½ä¸€èˆ¬ç”¨æ¥ä¿å­˜å†…å­˜åœ°å€(æŒ‡é’ˆ)ï¼Œä½¿å¾—å¯ä»¥å¯»å€åˆ°16EBè™šæ‹Ÿå†…å­˜ã€‚</p>

<h4 id="å¯»å€æ¨¡å¼">å¯»å€æ¨¡å¼</h4>
<p>x86_64ä½¿ç”¨å¤æ‚æŒ‡ä»¤é›†(CISC)(<a href="https://www.cnblogs.com/createyuan/p/4626235.html">riscä¸cisc</a>)æ‰€ä»¥MOVæŒ‡ä»¤æœ‰å¾ˆå¤šä¸åŒçš„å˜ç§ä»¥ä¾¿åœ¨ä¸åŒçš„å­˜å‚¨å•å…ƒä¹‹é—´ç§»åŠ¨ä¸åŒçš„æ•°æ®ç±»å‹ã€‚ä¸å¤§å¤šæ•°æŒ‡ä»¤ç›¸åŒï¼Œæœ‰ç€å†³å®šç§»åŠ¨å¤§å¤šæ•°æ•°æ®çš„å•å­—æ¯å‰ç¼€ï¼š</p>

<p><img src="https://img-blog.csdn.net/20171008200505370" alt="å•å­—æ¯å‰ç¼€" /></p>

<p>ä¸åŒçš„æ•°æ®æœ‰ç€ä¸åŒçš„å¯»å€æ¨¡å¼å’Œå†…å­˜åç§»:</p>

<ul>
  <li>å…¨å±€å€¼(å…¨å±€å˜é‡å’Œå‡½æ•°)çš„å¼•ç”¨ç›´æ¥ä½¿ç”¨åå­—ï¼Œä¾‹å¦‚<code class="language-plaintext highlighter-rouge">x</code>æˆ–è€…<code class="language-plaintext highlighter-rouge">printf</code></li>
  <li>å¸¸æ•°ä½¿ç”¨å¸¦æœ‰<code class="language-plaintext highlighter-rouge">$</code>çš„ç«‹å³æ•°ï¼Œä¾‹å¦‚$56ã€‚</li>
  <li>å¯„å­˜å™¨å€¼çš„å¼•ç”¨ï¼šä½¿ç”¨å¯„å­˜å™¨çš„åç§°ï¼Œä¾‹å¦‚:<code class="language-plaintext highlighter-rouge">%rbx</code></li>
  <li>é—´æ¥å¯»å€ï¼šä½¿ç”¨ä¸å¯„å­˜å™¨ä¸­ä¿å­˜çš„åœ°å€å€¼ç›¸å¯¹åº”çš„å†…å­˜ä¸­çš„å€¼ï¼Œä¾‹å¦‚ï¼š(%rsp)è¡¨ç¤º%rspæŒ‡å‘çš„å†…å­˜ä¸­çš„å€¼ã€‚</li>
  <li>ç›¸å¯¹åŸºå€å¯»å€ï¼šæŠŠä¸€ä¸ªå¸¸æ•°åŠ åˆ°å¯„å­˜å™¨ä¸Šï¼Œä¾‹å¦‚<code class="language-plaintext highlighter-rouge">-16(%rcx)</code>è¡¨ç¤ºæŠŠ<code class="language-plaintext highlighter-rouge">%rcx</code>æŒ‡å‘çš„åœ°å€å‰ç§»16ä¸ªå­—èŠ‚åå¯¹åº”çš„å†…å­˜å€¼ã€‚<code class="language-plaintext highlighter-rouge">-16(%rbx,%rcx8)</code>è¡¨ç¤º<code class="language-plaintext highlighter-rouge">-16+%rbx+%rcx*8</code>å¯¹åº”çš„åœ°å€çš„å†…å­˜å€¼ã€‚</li>
</ul>

<p>ä½¿ç”¨å„ç§å¯»å€æ¨¡å¼åŠ è½½ä¸€ä¸ª64ä½å€¼åˆ°%rax:</p>

<p><img src="https://img-blog.csdn.net/20171008200403991" alt="æ·»åŠ ä¸€ä¸ª64ä½å€¼åˆ°%rax" /></p>

<blockquote>
  <p>æ³¨æ„ï¼š
æ³¨æ„GNUå·¥å…·ä½¿ç”¨ä¼ ç»Ÿçš„AT&amp;Tè¯­æ³•ã€‚ç±»Unixæ“ä½œç³»ç»Ÿä¸Šï¼ŒAT&amp;Tè¯­æ³•è¢«ç”¨åœ¨å„ç§å¤„ç†å™¨ä¸Šã€‚Intelè¯­æ³•åˆ™ä¸€èˆ¬ç”¨åœ¨DOSå’ŒWindowsç³»ç»Ÿä¸Šã€‚ä¸‹é¢æ˜¯AT&amp;Tè¯­æ³•çš„æŒ‡ä»¤ï¼š</p>

  <p>movl %esp, %ebp</p>

  <p>movlæ˜¯æŒ‡ä»¤åç§°ã€‚%åˆ™è¡¨æ˜espå’Œebpæ˜¯å¯„å­˜å™¨.åœ¨AT&amp;Tè¯­æ³•ä¸­, ç¬¬ä¸€ä¸ªæ˜¯æºæ“ä½œæ•°,ç¬¬äºŒä¸ªæ˜¯ç›®çš„æ“ä½œæ•°ã€‚
åœ¨å…¶ä»–åœ°æ–¹ï¼Œä¾‹å¦‚interlæ‰‹å†Œï¼Œä½ ä¼šçœ‹åˆ°æ˜¯æ²¡æœ‰%çš„intelè¯­æ³•,å®ƒçš„æ“ä½œæ•°é¡ºåºåˆšå¥½ç›¸åã€‚ä¸‹é¢æ˜¯Intelè¯­æ³•:</p>

  <p><code class="language-plaintext highlighter-rouge">MOVQ EBP, ESP</code></p>

  <p>å½“åœ¨ç½‘é¡µä¸Šé˜…è¯»æ‰‹å†Œçš„æ—¶å€™ï¼Œä½ å¯ä»¥æ ¹æ®æ˜¯å¦æœ‰%æ¥ç¡®å®šæ˜¯AT&amp;T è¿˜æ˜¯ Intel è¯­æ³•ã€‚</p>
</blockquote>

<h4 id="åŸºæœ¬ç®—æœ¯æŒ‡ä»¤">åŸºæœ¬ç®—æœ¯æŒ‡ä»¤</h4>
<p>ç¼–è¯‘å™¨ä¼šä½¿ç”¨åŸºæœ¬çš„ç®—æœ¯æŒ‡ä»¤ï¼š<code class="language-plaintext highlighter-rouge">add</code>ã€<code class="language-plaintext highlighter-rouge">sub</code>ã€<code class="language-plaintext highlighter-rouge">imul</code>å’Œ<code class="language-plaintext highlighter-rouge">idiv</code>.å…¶ä¸­<code class="language-plaintext highlighter-rouge">ADD</code>å’Œ<code class="language-plaintext highlighter-rouge">SUB</code>æœ‰ä¸¤ä¸ªæ“ä½œæ•°ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">add</code>:åŠ æ“ä½œï¼›ä¾‹ï¼š<code class="language-plaintext highlighter-rouge">ADDQ %rbx, %ras</code>ï¼›æŠŠ%rbxåŠ åˆ°%raxï¼Œç»“æœå­˜åœ¨%raxä¸­ï¼Œä¼šè¦†ç›–ä¹‹å‰çš„å€¼ã€‚å€¼çš„å†…å­˜å¤§å°ä¸º8bit</li>
  <li><code class="language-plaintext highlighter-rouge">sub</code>:å‡æ“ä½œï¼›ä¾‹å¦‚<code class="language-plaintext highlighter-rouge">SUBQ %rbx,%rax</code>;%raxå€¼å­˜å‚¨å‡å»%rbxï¼Œç»“æœå­˜å‚¨åœ¨%raxä¸­ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">imul</code>:ä¹˜æ“ä½œï¼›ä¾‹å¦‚<code class="language-plaintext highlighter-rouge">IMULQ %rbx %rax</code>;å®ƒæŠŠ%raxçš„å€¼ä¹˜ä»¥æ“ä½œæ•°ï¼ŒæŠŠç»“æœçš„ä½64ä½å­˜åœ¨%raxï¼Œé«˜64ä½æ”¾åœ¨%rdx(ä¸¤ä¸ª64ä½å€¼ç›¸ä¹˜çš„ç»“æœæ˜¯128ä½)ã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">idiv</code>:é™¤æ“ä½œï¼šæŠŠ128bitå€¼(ä½64ä½åœ¨ %rax ï¼Œé«˜64ä½åœ¨%rdx)é™¤ä»¥æŒ‡ä»¤ä¸­çš„æ“ä½œæ•°ä¸ºäº†æ­£ç¡®å¤„ç†è´Ÿæ•°,ç”¨CDQO æŒ‡ä»¤æŠŠ%raxç¬¦å·æ‰©å±•åˆ°%rdx)ï¼Œå•†å­˜å‚¨åœ¨%raxï¼Œä½™æ•°åœ¨%rdxã€‚</li>
  <li><code class="language-plaintext highlighter-rouge">AND</code>ï¼šå¸ƒå°”æ“ä½œï¼Œä¸</li>
  <li><code class="language-plaintext highlighter-rouge">OR</code>:å¸ƒå°”æ“ä½œï¼Œæˆ–</li>
  <li><code class="language-plaintext highlighter-rouge">OR</code>ï¼šå¸ƒå°”æ“ä½œï¼Œé</li>
  <li><code class="language-plaintext highlighter-rouge">jmp</code>:è·³è½¬æŒ‡ä»¤ï¼›è·³è½¬åˆ°åˆ¶å®šåœ°ç‚¹ã€‚</li>
  <li>è·³è½¬æ¯”è¾ƒæŒ‡ä»¤ã€‚æ¯”è¾ƒå¹¶è·³è½¬</li>
</ul>

<p><img src="https://img-blog.csdn.net/20171013211645843" alt="æ¯”è¾ƒè·³è½¬æŒ‡ä»¤" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//%raxä»0ç´¯åŠ åˆ°5:

        MOVQ $0, %rax
loop:
        INCQ %rax
        CMPQ $5, %rax
        JLE  loop

</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">inc</code>:ç›®æ ‡æ“ä½œæ•°<code class="language-plaintext highlighter-rouge">+1</code>;ä½¿å¾—ç›®æ ‡æ“ä½œæ•°æ·»åŠ 1.</li>
  <li><code class="language-plaintext highlighter-rouge">dec</code>:ç›®æ ‡æ“ä½œæ•°<code class="language-plaintext highlighter-rouge">-1</code>ï¼›ä½¿å¾—ç›®æ ‡æ“ä½œæ•°å‡1</li>
</ul>

<h4 id="æ ˆ-statck">æ ˆ statck</h4>
<p>æ ˆæ˜¯ä¸€ä¸ªè¾…åŠ©çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦ç”¨æ¥è®°å½•å‡½æ•°çš„è°ƒç”¨å†å²å’Œç›¸å…³çš„å±€éƒ¨å˜é‡(æ²¡æœ‰æ”¾åˆ°å¯„å­˜å™¨çš„)ã€‚ä¸€èˆ¬æ ˆæ˜¯ä»é«˜åœ°å€åˆ°ä½åœ°å€å‘ä¸‹ç”Ÿé•¿çš„ã€‚<code class="language-plaintext highlighter-rouge">%rsp</code>æ˜¯æ ˆæŒ‡é’ˆï¼ŒæŒ‡å‘æ ˆæœ€åº•éƒ¨(å…¶å®æ˜¯å¹³å¸¸æ‰€è¯´çš„æ ˆé¡¶)å…ƒç´ ã€‚æ‰€ä»¥ï¼Œ<code class="language-plaintext highlighter-rouge">push %rax</code>ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œä¼šæŠŠ<code class="language-plaintext highlighter-rouge">%rsp</code>å‡å»8ï¼Œå¹¶æŠŠ%raxå†™åˆ° %rspæŒ‡å‘çš„ä½ç½®ã€‚</p>

<ul>
  <li>push:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SUBQ $8, %rsp #%rspæŒ‡é’ˆæŒ‡å‘åœ°å€å‡å»8ä¸ªå­—èŠ‚
MOVQ %rax, (%rsp) #å°†%raxç§»åŠ¨åˆ°%rspæŒ‡å‘åœ°å€

</code></pre></div></div>
<ul>
  <li>pop:æ“ä½œä¸pushåˆšå¥½ç›¸å</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MOVQ (%rsp), %rax #å°†%rspæŒ‡é’ˆæŒ‡å‘å€¼ï¼Œç§»åŠ¨åˆ°%rax
ADDQ $8, %rsp #%rspæŒ‡é’ˆå€¼å‡8
</code></pre></div></div>

<h4 id="å‡½æ•°è°ƒç”¨">å‡½æ•°è°ƒç”¨</h4>
<p><em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="https://blog.csdn.net/swordmanwk/article/details/41626127">32ä½æ±‡ç¼–è¯­è¨€å­¦ä¹ ç¬”è®°(13)â€“å‡½æ•°çš„è°ƒç”¨</a>;<a href="https://blog.csdn.net/shanyongxu/article/details/47726015">æ•°æ®ä¼ é€æŒ‡ä»¤è¯¦è§£</a></p>

<p>åœ¨å¤§å¤šæ•°æ±‡ç¼–ç¨‹åºä¸­(X86-64ä¸æ˜¯)ï¼Œè°ƒç”¨çº¦å®šæ˜¯ç®€å•çš„æŠŠæ¯ä¸ªå‚æ•°éƒ½å‹æ ˆï¼Œç„¶åè°ƒç”¨å‡½æ•°ã€‚è¢«è°ƒç”¨çš„å‡½æ•°ä»æ ˆä¸­è·å–å‚æ•°ï¼Œå®Œæˆæ“ä½œï¼ŒæŠŠè¿”å›å€¼ä¿å­˜åˆ°å¯„å­˜å™¨ä¸­å¹¶è¿”å›ã€‚è°ƒç”¨æ–¹å†æŠŠå‚æ•°ä»æ ˆpopå‡ºæ¥(å…¶å®X86 32å°±æ˜¯è¿™æ ·çš„)ã€‚</p>

<p>X86-64(System V ABI)ã€‚ åŸºæœ¬æ–¹æ³•ï¼š</p>

<ul>
  <li>æ•´æ•°å‚æ•°(åŒ…å«æŒ‡é’ˆï¼‰ä¾æ¬¡æ”¾åœ¨%rdi, %rsi, %rdx, %rcx, %r8, å’Œ %r9 å¯„å­˜å™¨ä¸­ã€‚</li>
  <li>æµ®ç‚¹å‚æ•°ä¾æ¬¡æ”¾åœ¨å¯„å­˜å™¨%xmm0-%xmm7ä¸­ã€‚</li>
  <li>å¯„å­˜å™¨ä¸å¤Ÿç”¨æ—¶ï¼Œå‚æ•°æ”¾åˆ°æ ˆä¸­ã€‚</li>
  <li>å¯å˜å‚æ•°å“ˆå‡½æ•°(æ¯”å¦‚printf), å¯„å­˜å™¨%eaxéœ€è®°å½•ä¸‹æµ®ç‚¹å‚æ•°çš„ä¸ªæ•°ã€‚</li>
  <li>è¢«è°ƒç”¨çš„å‡½æ•°å¯ä»¥ä½¿ç”¨ä»»ä½•å¯„å­˜å™¨ï¼Œä½†å®ƒå¿…é¡»ä¿è¯%rbx, %rbp, %rsp, and %r12-%r15æ¢å¤åˆ°åŸæ¥çš„å€¼ï¼ˆå¦‚æœå®ƒæ”¹å˜äº†å®ƒä»¬çš„å€¼ï¼‰ã€‚</li>
  <li>è¿”å›å€¼å­˜å‚¨åœ¨ %eaxä¸­.</li>
</ul>

<p><strong>åŸºæœ¬å‡½æ•°æŒ‡ä»¤</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">call</code>: è°ƒç”¨å‡½æ•°æŒ‡ä»¤ï¼›ä¾‹å¦‚ï¼š<code class="language-plaintext highlighter-rouge">call main</code>;è°ƒç”¨<code class="language-plaintext highlighter-rouge">main</code>å‡½æ•°</li>
  <li><code class="language-plaintext highlighter-rouge">ret</code>:ç»ˆæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå°†è¿è¡Œæƒäº¤è¿˜ç»™ä¸Šå±‚å‡½æ•°ã€‚å½“å‰å‡½æ•°çš„å¸§å°†è¢«å›æ”¶</li>
</ul>

<p><img src="https://img-blog.csdn.net/20171015115531621" alt="å‡½æ•°è°ƒç”¨æ“ä½œæ–¹æ³•" /></p>

<p>è°ƒç”¨å‡½æ•°å‰ï¼Œå…ˆè¦æŠŠå‚æ•°æ”¾åˆ°å¯„å­˜å™¨ä¸­ã€‚ç„¶åï¼Œè°ƒç”¨æ–¹è¦æŠŠå¯„å­˜å™¨%r10 å’Œ%r11çš„å€¼ä¿å­˜åˆ°æ ˆä¸­ã€‚ä¹‹åï¼Œæ‰§è¡ŒCALLæŒ‡ä»¤ï¼ŒæŠŠIPæŒ‡é’ˆçš„å€¼ä¿å­˜åˆ°æ ˆä¸­ï¼Œå¹¶è·³åˆ°å‡½æ•°çš„èµ·å§‹åœ°å€æ‰§è¡Œã€‚ä»å‡½æ•°è¿”å›åï¼Œæ¢å¤%r10 å’Œ%r11ï¼Œå¹¶ä»%eaxè·å–è¿”å›å€¼ã€‚ä¸‹é¢è¿›è¡Œä¸€ä¸ªå‡½æ•°ä¸¾ä¾‹ï¼š</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nt</span> <span class="nf">func</span><span class="p">(</span> <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="mi">5</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>å¯¹ä¸‹é¢çš„å¤æ‚å‡½æ•°æœ‰ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.globl func #å®šäºå…¨å±€å‡½æ•°
func:
    ##################### preamble of function sets up stack
#int a, int b, int c
    pushq %rbp          # save the base pointer
    movq  %rsp, %rbp    # set new base pointer to esp

    pushq %rdi          # save first argument (a) on the stack
    pushq %rsi          # save second argument (b) on the stack
    pushq %rdx          # save third argument (c) on the stack

    subq  $16, %rsp     # allocate two more local variables

    pushq %rbx          # save callee-saved registers
    pushq %r12
    pushq %r13
    pushq %r14
    pushq %r15

    ######################## body of function starts here

    movq  -8(%rbp),  %rbx  #a # load each arg into a scratch register
    movq  -16(%rbp), %rcx  #b
    movq  -24(%rbp), %rdx  #c

    addq  %rdx, %rcx   #b=b+c    # add the args together 
    addq  %rcx, %rbx   #a=a+b
    movq  %rbx, -32(%rbp)   # store the result into local 0 (x)

    movq  -32(%rbp), %rbx #a=x  # load local 0 (x) into a scratch register.
    imulq  $5, %rbx   #a*=x     # multiply it by 5
    movl  %rbx, -40(%ebp) #y=a   # store the result in local 1 (y)

    movl  -20(%ebp), %eax   # move local 1 (y) into the result register

    #################### epilogue of function restores the stack

    popq %r15          # restore callee-saved registers
    popq %r14
    popq %r13
    popq %r12
    popq %rbx

    movq %rbp, %rsp    # reset stack to base pointer.
    popq %rbp          # restore the old base pointer

    ret                # return to caller

</code></pre></div></div>

<p><strong>main ç®€å•ä»£ç åˆ†æ</strong></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//test2.cpp</span>

<span class="kt">long</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">long</span> <span class="n">y</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"value: %d"</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    .file   "test2.cpp" #æ–‡ä»¶å test2.cpp
    .globl  x   #å…¨å±€å˜é‡ x
    .bss        #é™æ€å­˜å‚¨åŒºåŸŸ
    .align 8    #å†…å­˜å¯¹é½ï¼Œæ’å…¥8ä½ï¼Œä¸€ä¸ªå­—èŠ‚
    .type   x, @object
    .size   x, 8 #x 8å­—èŠ‚
x:
    .zero   8 
    .globl  y #è®¾ç½®å…¨å±€å˜é‡  y
    .data   
    .align 8
    .type   y, @object
    .size   y, 8
y:
    .quad   10
    .section    .rodata
.LC0:
    .string "value: %d"
    .text
    .globl  main
    .type   main, @function
main:
.LFB2:
    .cfi_startproc   #ä¸»å‡½æ•°å¼€å§‹
    pushq   %rbp     
    .cfi_def_cfa_offset 16 #
    .cfi_offset 6, -16
    movq    %rsp, %rbp    #è®¾ç½®æ ˆæŒ‡é’ˆ
    .cfi_def_cfa_register 6
    movq    y(%rip), %rax #å°†å€¼10ç§»åŠ¨åˆ°%rax
    movq    %rax, x(%rip) #å°†%raxç§»åŠ¨åˆ°æ ˆä¸­ï¼Œå¹¶åˆ†é…8ä¸ªå­—èŠ‚
    movq    y(%rip), %rax #å°†yå€¼å¤åˆ¶åˆ°%raxå¯„å­˜å™¨
    movq    %rax, %rsi #å°†å‚æ•°å‹å…¥%rsi
    movl    $.LC0, %edi 
    movl    $0, %eax # è®°å½•æµ®ç‚¹å‚æ•°ä¸ªæ•°
    call    printf #ä½¿ç”¨printfå‡½æ•°
    movl    $0, %eax # è¿”å›å€¼0
    popq    %rbp  #æŒ‡é’ˆå‡ºç«™
    .cfi_def_cfa 7, 8
    ret
    .cfi_endproc
.LFE2:
    .size   main, .-main
    .ident  "GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609"
    .section    .note.GNU-stack,"",@progbits

</code></pre></div></div>

<h3 id="æ— ä¼˜åŒ–æ±‡ç¼–ä»£ç åˆ†æ">æ— ä¼˜åŒ–æ±‡ç¼–ä»£ç åˆ†æ</h3>

<p>æœ‰äº†å‰é¢çš„åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹æœ€å¼€å§‹çš„<code class="language-plaintext highlighter-rouge">a.s</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    .file   "a.c"  #æŒ‡æ˜æºæ–‡ä»¶å
    .section    .rodata #å®šä¹‰é™æ€æ•°æ®ï¼Œåªè¯»
.LC0: #å®šä¹‰æ ‡ç­¾LC0
    .string "%d\n" #å®šä¹‰string 
    .text #å®šä¹‰ä»£ç æ®µ
    .globl  main #å®šä¹‰å…¨å±€æ ‡ç­¾main
    .type   main, @function #å®šä¹‰æ ‡ç­¾main ä¸ºä¸€ä¸ªå‡½æ•°
main:
.LFB2: #å®šä¹‰æ ‡ç­¾LFB2
    .cfi_startproc #å®šä¹‰å‡½æ•°å¼€å§‹
    pushq   %rbp #æ ˆçš„åŸºåº•åœ°å€
    .cfi_def_cfa_offset 16 #CFAåç§»16ä¸ªå­—èŠ‚
    .cfi_offset 6, -16 #å¯„å­˜å™¨å…ˆå‰å€¼ä¿å­˜åœ¨CFA 16å­—èŠ‚åç§»å¤„
    movq    %rsp, %rbp #æ ˆé¡¶æŒ‡é’ˆæŒ‡å‘æ ˆåº•
    .cfi_def_cfa_register 6 #å®šä¹‰æ–°çš„æ ‡å‡†åœ°å€ä¸º6
    subq    $16, %rsp #æ ˆæŒ‡é’ˆå‘ä¸‹åˆ†é…16ä¸ªå­—èŠ‚
    movl    $10, -4(%rbp) #å°†10ç§»åŠ¨åˆ°æ ˆåº•å››ä¸ªå­—èŠ‚å¤„
    movl    -4(%rbp), %eax #å°†10 å¤åˆ¶åˆ°%eax-&gt; int a=10
    imull   -4(%rbp), %eax #10*10-&gt; a*=a; a=100ï¼›(%eax)=100;
    movl    %eax, -4(%rbp) #-4(%rbp)=100;
    movl    -4(%rbp), %eax # å¤åˆ¶-4(%rbp)çš„å€¼åˆ°%eax;å³(%eax)=100;
    subl    %eax, -4(%rbp) # -4(%rbp)=-4(%rbp)å‡(%eax);å³100-100=0ï¼›-4(%rbp)=0ï¼›
    movl    -4(%rbp), %eax # å¤åˆ¶-4(%rbp)åˆ°%eax,å³(%eax)=0
    addl    %eax, -4(%rbp) # -4(%rbp)=%eax+(-4(%rbp));å³-4(%rbp)=0ï¼›
    movl    -4(%rbp), %eax # å°†-4(%rbp)å¤åˆ¶åˆ°%eax;%eax=0;
    movl    %eax, %esi     #%eaxå¤åˆ¶åˆ°%esi,ç»“æœå­˜å‚¨åœ¨%esiä¸­
    movl    $.LC0, %edi   #è½½å…¥LC0æ ‡ç­¾ï¼Œåˆ°%edi
    movl    $0, %eax      #å°†ç«‹å³æ•°0å¤åˆ¶åˆ°%eax
    call    printf      #è°ƒç”¨æ‰“å°å‡½æ•°
    movl    $0, %eax   #å¤åˆ¶0åˆ°%eax;return 0ï¼›
    leave #è¿”å›mainå‡½æ•°
    .cfi_def_cfa 7, 8  #å®šä¹‰æ–°çš„å¸§è®¡ç®—è§„åˆ™
    ret #ç»“æŸå½“å‰å‡½æ•°
    .cfi_endproc #å‡½æ•°ç»“æŸ
.LFE2:
    .size   main, .-main
    .ident  "GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609"
    .section    .note.GNU-stack,"",@progbits

</code></pre></div></div>

<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºå¼<code class="language-plaintext highlighter-rouge">a+=a-=a*=a;</code>çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">a*=a</code>:a=100</li>
  <li><code class="language-plaintext highlighter-rouge">a-=a</code>:a=0;</li>
  <li><code class="language-plaintext highlighter-rouge">a+=a</code>:a=0;</li>
</ul>

<p>åˆ†æå¼€å¯<code class="language-plaintext highlighter-rouge">-O3</code>ä¼˜åŒ–åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//a1.s

    .file   "a.c"
    .section    .rodata.str1.1,"aMS",@progbits,1 
.LC0:
    .string "%d\n"  #å£°æ˜ string æ”¾åœ¨.text åŒºåŸŸ 
    .section    .text.unlikely,"ax",@progbits 
.LCOLDB1:
    .section    .text.startup,"ax",@progbits
.LHOTB1:
    .p2align 4,,15
    .globl  main
    .type   main, @function
main:
.LFB23:
    .cfi_startproc
    subq    $8, %rsp #è®¾ç½®æ ˆé¡¶æŒ‡é’ˆå€¼ä¸º8
    .cfi_def_cfa_offset 16 #è®¾ç½®æ¡†æ¶åç§»
    xorl    %edx, %edx #å¼‚æˆ–è¿ç®—ä¸º0
    movl    $.LC0, %esi #å°†å­—ç¬¦ä¸²å‚æ•°ï¼Œæ·»åŠ åˆ°%esiå¯„å­˜å™¨
    movl    $1, %edi #(%edi)å¯„å­˜å™¨èµ‹å€¼ä¸º1
    xorl    %eax, %eax #ç»§ç»­è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°†ç»“æœå‚æ•°æ”¾åˆ°eaxå¯„å­˜å™¨
    call    __printf_chk #è¾“å‡ºå‡½æ•°
    xorl    %eax, %eax #å¼‚æˆ–è¿ç®—ä¸º0
    addq    $8, %rsp #å°†8å‹å…¥%rsp
    .cfi_def_cfa_offset 8
    ret    #è¿”å›
    .cfi_endproc #å‡½æ•°ç»“æŸ
.LFE23:
    .size   main, .-main
    .section    .text.unlikely
.LCOLDE1:
    .section    .text.startup
.LHOTE1:
    .ident  "GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609"
    .section    .note.GNU-stack,"",@progbits

</code></pre></div></div>

<table>
  <tbody>
    <tr>
      <td>é€šè¿‡ä¸Šé¢æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¼–è¯‘å™¨ç›´æ¥è¿›è¡Œäº†ä¸€æ¬¡äº¦æˆ–è¿ç®—a=(a!</td>
      <td>a)=0;è¿·ä¹‹ç¼–è¯‘ä¼˜åŒ–ã€‚</td>
    </tr>
  </tbody>
</table>

<p>ä¸‹é¢æ˜¯ä¸Šé¢è®¡ç®—å¼çš„javaä»£ç </p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//a.java</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">a</span><span class="o">{</span>
      <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span><span class="n">agrs</span><span class="o">)</span>
      <span class="o">{</span>
          <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="o">;</span>
          <span class="n">a</span><span class="o">+=</span><span class="n">a</span><span class="o">-=</span><span class="n">a</span><span class="o">*=</span><span class="n">a</span><span class="o">;</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"a value is:"</span><span class="o">+</span><span class="n">a</span><span class="o">);</span>
      <span class="o">}</span>

<span class="o">}</span>

<span class="c1">//ç¼–è¯‘æŒ‡ä»¤ï¼šjavac a.java</span>

<span class="c1">//æ‰§è¡Œï¼šjava a</span>

<span class="c1">//ç»“æœï¼ša value is:-80</span>

</code></pre></div></div>
<p>å¯ä»¥çœ‹å‡ºåŒæ ·çš„å¼å­ï¼Œå’ŒC++è®¡ç®—ç»“æœå®Œå…¨ä¸åŒ
<em>å‚è€ƒé“¾æ¥ï¼š</em> <a href="https://blog.csdn.net/wangfantastic/article/details/79736860">Javaåæ±‡ç¼–åŠJVMæŒ‡ä»¤é›†</a>;<a href="https://blog.csdn.net/ljheee/article/details/82218156">æŸ¥çœ‹Javaçš„æ±‡ç¼–æŒ‡ä»¤</a></p>

<p>æŒ‡ä»¤ç”Ÿæˆæ±‡ç¼–ä»£ç <code class="language-plaintext highlighter-rouge"> javap -c a.class</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Compiled from "a.java"
public class a {
  public a();
    Code:
       0: aload_0 
       1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: bipush        10 //å°†10å‹å…¥æ ˆ
       2: istore_1 //å°†intç±»å‹å€¼å­˜å…¥å±€éƒ¨å˜é‡1
       3: iload_1  //è¯»å–å±€éƒ¨å˜é‡1 æ³¨æ„è¿™é‡Œè¯»å–äº†å››ä¸ªå±€éƒ¨å˜é‡ï¼Œæ¯ä¸ªéƒ½ä¸º10
       4: iload_1   //è¯»å–å±€éƒ¨å˜é‡1
       5: iload_1   //è¯»å–å±€éƒ¨å˜é‡1
       6: iload_1   //è¯»å–å±€éƒ¨å˜é‡1
       7: imul    //æ‰§è¡Œä¹˜æ³• 10*10=100
       8: dup     //å¤åˆ¶ä¸€ä¸ªæ ˆé¡¶å†…å®¹ 100
       9: istore_1 //å­˜å…¥å±€éƒ¨å˜é‡1 100
      10: isub    //æ‰§è¡Œå‡æ³•-&gt; 10-100=-90
      11: dup   //å¤åˆ¶æ ˆé¡¶å…ƒç´  -90
      12: istore_1 //å­˜å‚¨å…ƒç´  -90
      13: iadd //åŠ æ³•ï¼š -90+10=-80ï¼›æ³¨æ„10ä¸€ç›´åœ¨æ ˆä¸­æ²¡æœ‰å–å‡º
      14: istore_1 //å°†-80å­˜å…¥å±€éƒ¨å˜é‡1
      15: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
      18: new           #3                  // class java/lang/StringBuilder
      21: dup //å¤åˆ¶æ ˆé¡¶å†…å®¹ -80
      22: invokespecial #4                  // Method java/lang/StringBuilder."&lt;init&gt;":()V 
      25: ldc           #5                  // String a value is:
      27: invokevirtual #6                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: iload_1  //åŠ è½½å±€éƒ¨å˜é‡1 -80
      31: invokevirtual #7                  // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      34: invokevirtual #8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      37: invokevirtual #9                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      40: return
}

</code></pre></div></div>
<p>ä»ä¸Šé¢æ±‡ç¼–ä»£ç å¯ä»¥çœ‹å‡ºï¼›Javaæ‰§è¡Œæ˜¯ç›´æ¥å°†å››ä¸ªåˆå§‹åŒ–ä¸´æ—¶çš„å˜é‡ï¼Œæ¯ä¸ªç»™äºˆåˆå§‹å€¼10ï¼›ä¾æ¬¡è¿›è¡Œ<code class="language-plaintext highlighter-rouge">*</code>ã€<code class="language-plaintext highlighter-rouge">-</code>ã€<code class="language-plaintext highlighter-rouge">+</code>è¿ç®—ï¼›æ¯æ¬¡çš„å€¼å˜åŒ–ä¸ºï¼š100ï¼Œ-90ï¼Œ-80ï¼›å› æ­¤æœ€ç»ˆç»“æœæ˜¯-80ï¼›æ‰€ä»¥c++å’Œjavaçš„ä¸åŒï¼Œæ˜¯ç”±äºå…¶å†…éƒ¨çš„ç¼–è¯‘å™¨è¯­æ³•è§£ææ–¹å¼æ‰€å†³å®šçš„ã€‚ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒJavaçœŸçš„æ¯”è¾ƒè€—æ€§èƒ½ã€‚</p>

:ET